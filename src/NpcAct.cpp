


NPCHAR *ActNpc000(NPCHAR *a1);
NPCHAR *ActNpc001_Explode(NPCHAR *a1);
signed int ActNpc002_CloudL(NPCHAR *a1); 
signed int ActNpc003_CloudS(int a1);
_DWORD *ActNpc004_Puff(NPCHAR *a1);
int ActNpc005_Hanger(int a1);
NPCHAR *ActNpc006_CloudGen(NPCHAR *a1);
int ActNpc007_Powerup(NPCHAR *a1); 
int ActNpc008_Climber(int a1);
NPCHAR *ActNpc009_Kagome(NPCHAR *a1);
NPCHAR *ActNpc011_Wing(NPCHAR *a4); 
NPCHAR *ActNpc012_WingCorpse(NPCHAR *a1); 
int ActNpc013_Bullet(NPCHAR *a1); 
int ActNpc014_BulletSlow(NPCHAR *a1); 
tagRECT *ActNpc010_Unused_(NPCHAR *a1);
NPCHAR *ActNpc015_Boss1(NPCHAR *a1); 
NPCHAR *ActNpc016_Boss1Eye(NPCHAR *a1);
NPCHAR *ActNpc017_Boss1BigEye(NPCHAR *a1);
NPCHAR *ActNpc018_BulletLong(NPCHAR *a1);
signed int ActNpc019_BGM(NPCHAR *a1); 
signed int ActNpc020_Asteroid_L(NPCHAR *a1); 
signed int ActNpc021_Asteroid_S(int a1);
int ActNpc022_ScrollSpdSet(NPCHAR *a1); 
LONG *ActNpc023_Asteroid_SGravity(NPCHAR *a1);
int ActNpc024_Hanger_Wave(int nHeight);
NPCHAR *ActNpc025_Hanger_Shoot(NPCHAR *a1);
NPCHAR *ActNpc026_RockHugger(NPCHAR *a1);
LONG *ActNpc027_RHAsteroidL(NPCHAR *a1);
int ActNpc028_RHAsteroidS(int a1);
NPCHAR *ActNpc029_Bullet2_(NPCHAR *a1);
int ActNpc030_Elka(int nHeight);
int ActNpc031_Sodi(int a1);
int ActNpc032_Boss2(int a1);
NPCHAR *ActNpc033_Boss2RocketSpawner(NPCHAR *o); 
int ActNpc034_B2ExplosionSpawner_(NPCHAR *a1); 
int ActNpc035_B2Rocket(NPCHAR *a1); 
int ActNpc036_Boss2Eye(NPCHAR *a1); 
int ActNpc037_Stars_(NPCHAR *a1); 
NPCHAR *ActNpc038_StarGen(NPCHAR *a1);
_DWORD *ActNpc039_Elka2(NPCHAR *a1); 
signed int ActNpc040_GuxtFort(int a1);
NPCHAR *ActNpc041_CatEye(NPCHAR *a1);
int ActNpc042_Slider(int a1);
NPCHAR *ActNpc043_Cycloid(NPCHAR *a1);
int ActNpc044_Chester(int a1);
LONG ActNpc045_Bonus(NPCHAR *a1);
NPCHAR *ActNpc046_BonusGen(NPCHAR *a1);
signed int ActNpc047_CloudXL(int a1);
NPCHAR *ActNpc048_Gimmick(NPCHAR *a1);
int ActNpc049_Boss3(int a1);
NPCHAR *ActNpc050_62_PowerupHelper(NPCHAR *a1);
LONG *ActNpc051_B3Eye1_(NPCHAR *a1);
int ActNpc052_B3Eye2_(int a1);
int ActNpc053_B3Eye3_(int a1);
NPCHAR *ActNpc054_B3BulletBlocker_(NPCHAR *a1);
int ActNpc055_B3Target__(NPCHAR *a1); 
NPCHAR *ActNpc056_Checkpoint(NPCHAR *a1);
int ActNpc057_Boss3TurretSpawner(NPCHAR *a1); 
int ActNpc058_B3Turret(int nHeight);
NPCHAR *ActNpc059_PowerupSpinnerShield(NPCHAR *a1);
NPCHAR *ActNpc060_PowerupBox(NPCHAR *o); 
LONG *ActNpc061_PowerupStatic(NPCHAR *a1);
int ActNpc063_BulletWhite(NPCHAR *a1); 
int *ActNpc064_PowerupSpinner(NPCHAR *a1); 
int ActNpc065_ClimberShoot(int nHeight);
int ActNpc066_Tri(int nHeight);
NPCHAR *ActNpc067_GuxtTank(NPCHAR *o); 
int ActNpc068_MedusaEye(NPCHAR *a1); 
_DWORD *ActNpc069_GuxtMine(int nHeight);
int ActNpc070_BlendyGen(NPCHAR *a1); 
int *ActNpc071_Blendy(NPCHAR *a1); 
int ActNpc072_Cycloid2(int a1);
int ActNpc073_Cycloid2Gen(int a1);
int ActNpc074_PowerupHidden(int a1);
NPCHAR *ActNpc075_PowerupAsteroid(NPCHAR *a1);
int ActNpc076_Boss4(int a1);
int ActNpc077(int a1);
int ActNpc078(int nHeight);
int ActNpc079(int a1);
signed int ActNpc080(int a1);
int ActNpc081_SpaceAmeba(int a1);
int *ActNpc082(int nHeight);
int ActNpc083_B4Bullet(int a1);
LONG *ActNpc084_Square(NPCHAR *a1);
signed int ActNpc085_CloudDarkL(int a1);
signed int ActNpc086_CloudDarkS(int a1);
int *ActNpc087_CloudDarkGen(int a1);
NPCHAR *ActNpc088_MissilePot(NPCHAR *o); 
NPCHAR *ActNpc089(NPCHAR *a1);
LONG *ActNpc090_Missile(NPCHAR *a1);
int ActNpc091(int a1);
NPCHAR *ActNpc092_BGRock(NPCHAR *a1);
_DWORD *ActNpc093_ClearRockCloudGen(_DWORD *a1);
signed int ActNpc094_SandStamper(NPCHAR *a1); 
NPCHAR *ActNpc095(NPCHAR *a1);
signed int ActNpc096_Stamp(int a1);
int ActNpc097_Brick(int a1);
int ActNpc098_BulletSquare(NPCHAR *a1); 
NPCHAR *ActNpc099_BulletSquareGen(NPCHAR *o); 
LONG *ActNpc100_Boss5(NPCHAR *o); 
LONG *ActNpc101(NPCHAR *a1);
NPCHAR *ActNpc102_B5Bullet(NPCHAR *a1);
LONG *ActNpc103(NPCHAR *a1);
signed int ActNpc104_B5Laser(NPCHAR *a1); 
int ActNpc105_B5LaserTrail(int a1);
NPCHAR *ActNpc106_AzaBonusSpawner_(NPCHAR *a1); 
NPCHAR *ActNpc107(NPCHAR *a1);
void *ActNpc108_Boss6(NPCHAR *a1); 
LONG *ActNpc109(NPCHAR *nHeight);
_DWORD *ActNpc110(NPCHAR *nHeight);
int ActNpc111_B6Laser(int a1);
int ActNpc112(NPCHAR *a1); 
int ActNpc113(int a1);
signed int ActNpc114_B6Ball(int a1);
int ActNpc115_B6Caret(int a1);
_DWORD *ActNpc116_CreditText(_DWORD *a1);
int ActNpc117_CreditReplace(NPCHAR *a1); 
BOOL ActNpc118_CreditLoadImg(NPCHAR *a1); 
NPCHAR *ActNpc119_CPhoto(NPCHAR *a1);
LONG *ActNpc120_CreditGimmick(NPCHAR *a1);
RECT *ActNpc121_BonusHidden(NPCHAR *o); 

char KagomeCount; 
char byte_44C265; 
int dword_44C268; 
char byte_44C26C; 
int bonusAzaX; 
int asteroidsKilled; 
int bonusAzaY; 


NPCHAR *ActNpc000(NPCHAR *a1)
{
  char *v1; 
  NPCHAR *result; 
  char v3; 
  int v4; 

  v1 = (char *)&a1->rect;
  *(_DWORD *)v1 = 0;
  *((_DWORD *)v1 + 1) = 0;
  *((_DWORD *)v1 + 2) = 16;
  *((_DWORD *)v1 + 3) = 16;
  if ( a1->shock / 2 % 2 )
  {
    a1->rect.top += 16;
    a1->rect.bottom += 16;
  }
  AlignStageScroll((NPCHAR *)&v3);
  result = a1;
  if ( a1->y > v4 + 0x2000 )
    a1->cond = 0;
  return result;
}


NPCHAR *ActNpc001_Explode(NPCHAR *a1)
{
  int v1; 
  NPCHAR *result; 
  tagRECT *v3; 
  tagRECT *v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 
  int v23; 
  int v24; 
  int v25; 
  int v26; 
  int v27; 
  int v28; 
  int v29; 
  int v30; 
  int v31; 
  int v32; 

  v5 = 0;
  v6 = 0;
  v7 = 32;
  v8 = 32;
  v9 = 32;
  v10 = 0;
  v11 = 64;
  v12 = 32;
  v13 = 64;
  v14 = 0;
  v15 = 96;
  v16 = 32;
  v17 = 96;
  v18 = 0;
  v19 = 128;
  v20 = 32;
  v21 = 128;
  v22 = 0;
  v23 = 160;
  v24 = 32;
  v25 = 160;
  v26 = 0;
  v27 = 192;
  v28 = 32;
  v29 = 192;
  v30 = 0;
  v31 = 224;
  v32 = 32;
  v1 = a1->count1++;
  if ( v1 >= 4 )
    a1->y += 4096;
  else
    a1->y += 1024;
  if ( ++a1->count3 > 2 )
  {
    a1->count3 = 0;
    ++a1->count2;
  }
  if ( a1->count2 <= 6 )
  {
    v3 = (tagRECT *)(&v5 + 4 * a1->count2);
    v4 = &a1->rect;
    v4->left = v3->left;
    v4->top = v3->top;
    v4->right = v3->right;
    result = (NPCHAR *)v3->bottom;
    v4->bottom = (LONG)result;
  }
  else
  {
    result = a1;
    a1->cond = 0;
  }
  return result;
}


signed int ActNpc002_CloudL(NPCHAR *a1)
{
  char *v1; 
  signed int result; 

  a1->y += 2048;
  if ( a1->y > 180224 )
    a1->cond = 0;
  v1 = (char *)&a1->rect;
  *(_DWORD *)v1 = 0;
  *((_DWORD *)v1 + 1) = 0;
  result = 48;
  *((_DWORD *)v1 + 2) = 48;
  *((_DWORD *)v1 + 3) = 24;
  return result;
}


signed int ActNpc003_CloudS(int a1)
{
  int v1; 
  signed int result; 

  *(_DWORD *)(a1 + 8) += 512;
  if ( *(_DWORD *)(a1 + 8) > 180224 )
    *(_DWORD *)a1 = 0;
  v1 = a1 + 104;
  *(_DWORD *)v1 = 0;
  *(_DWORD *)(v1 + 4) = 24;
  result = 16;
  *(_DWORD *)(v1 + 8) = 16;
  *(_DWORD *)(v1 + 12) = 32;
  return result;
}


_DWORD *ActNpc004_Puff(NPCHAR *a1)
{
  _DWORD *result; 
  int *v2; 
  int v3; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 

  v3 = 0;
  v4 = 56;
  v5 = 8;
  v6 = 64;
  v7 = 8;
  v8 = 56;
  v9 = 16;
  v10 = 64;
  v11 = 16;
  v12 = 56;
  v13 = 24;
  v14 = 64;
  v15 = 24;
  v16 = 56;
  v17 = 32;
  v18 = 64;
  v19 = 32;
  v20 = 56;
  v21 = 40;
  v22 = 64;
  a1->y += 0x2000;
  if ( a1->y > 180224 )
    a1->cond = 0;
  result = (_DWORD *)(a1->count3 + 1);
  a1->count3 = (int)result;
  if ( a1->count3 > 1 )
  {
    a1->count3 = 0;
    result = a1;
    ++a1->count2;
  }
  if ( a1->count2 <= 4 )
  {
    v2 = &v3 + 4 * a1->count2;
    result = &a1->rect.left;
    *result = *v2;
    result[1] = v2[1];
    result[2] = v2[2];
    result[3] = v2[3];
  }
  else
  {
    a1->cond = 0;
  }
  return result;
}


int ActNpc005_Hanger(int a1)
{
  int result; 
  int *v2; 
  int v3; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 
  int v23; 
  int v24; 
  int v25; 
  int v26; 
  int v27; 

  v4 = 0;
  v5 = 0;
  v6 = 24;
  v7 = 24;
  v8 = 24;
  v9 = 0;
  v10 = 48;
  v11 = 24;
  v12 = 48;
  v13 = 0;
  v14 = 72;
  v15 = 24;
  v16 = 72;
  v17 = 0;
  v18 = 96;
  v19 = 24;
  v20 = 96;
  v21 = 0;
  v22 = 120;
  v23 = 24;
  v24 = 120;
  v25 = 0;
  v26 = 144;
  v27 = 24;
  if ( *(_DWORD *)(a1 + 60) > 994 )
  {
    switch ( *(_DWORD *)(a1 + 44) )
    {
      case 0:
        *(_DWORD *)(a1 + 44) = 10;
        *(_DWORD *)(a1 + 8) = 163840;
        *(_DWORD *)(a1 + 16) = -6144;
        PlaySound(26);
        goto LABEL_5;
      case 0xA:
LABEL_5:
        *(_DWORD *)(a1 + 16) += 113;
        if ( ++*(_DWORD *)(a1 + 56) > 2 )
        {
          *(_DWORD *)(a1 + 56) = 0;
          ++*(_DWORD *)(a1 + 52);
        }
        if ( *(_DWORD *)(a1 + 52) > 2 )
          *(_DWORD *)(a1 + 52) = 0;
        if ( *(_DWORD *)(a1 + 16) > 0 )
          goto LABEL_10;
        break;
      case 0x14:
LABEL_10:
        *(_DWORD *)(a1 + 44) = 30;
        *(_DWORD *)(a1 + 68) |= 0x43u;
        *(_DWORD *)(a1 + 64) = 1;
        goto LABEL_11;
      case 0x1E:
LABEL_11:
        if ( (signed int)ShipX >= *(_DWORD *)(a1 + 4) )
          *(_DWORD *)(a1 + 12) += 32;
        else
          *(_DWORD *)(a1 + 12) -= 32;
        if ( *(_DWORD *)(a1 + 12) < -1024 )
          *(_DWORD *)(a1 + 12) = -1024;
        if ( *(_DWORD *)(a1 + 12) > 1024 )
          *(_DWORD *)(a1 + 12) = 1024;
        *(_DWORD *)(a1 + 16) += 64;
        if ( ++*(_DWORD *)(a1 + 56) > 1 )
        {
          *(_DWORD *)(a1 + 56) = 0;
          ++*(_DWORD *)(a1 + 52);
        }
        if ( *(_DWORD *)(a1 + 52) > 5 )
          *(_DWORD *)(a1 + 52) = 3;
        if ( *(_DWORD *)a1 & 0x10 )
        {
          *(_DWORD *)a1 &= 0xFFFFFFEF;
          *(_DWORD *)(a1 + 12) = 1024;
        }
        if ( *(_DWORD *)a1 & 0x20 )
        {
          *(_DWORD *)a1 &= 0xFFFFFFDF;
          *(_DWORD *)(a1 + 12) = -1024;
        }
        if ( *(_DWORD *)a1 & 0x40 )
        {
          *(_DWORD *)a1 &= 0xFFFFFFBF;
          *(_DWORD *)(a1 + 16) = 1024;
        }
        if ( *(_DWORD *)a1 & 0x80 )
        {
          *(_DWORD *)a1 &= 0xFFFFFF7F;
          *(_DWORD *)(a1 + 16) = -1024;
        }
        if ( *(_DWORD *)(a1 + 8) > 180224 )
          *(_DWORD *)a1 = 0;
        break;
      default:
        break;
    }
    *(_DWORD *)(a1 + 4) += *(_DWORD *)(a1 + 12);
    *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
    v2 = &v4 + 4 * *(_DWORD *)(a1 + 52);
    v3 = a1 + 104;
    *(_DWORD *)v3 = *v2;
    *(_DWORD *)(v3 + 4) = v2[1];
    *(_DWORD *)(v3 + 8) = v2[2];
    *(_DWORD *)(v3 + 12) = v2[3];
    if ( *(_DWORD *)(a1 + 60) <= 997 )
    {
      if ( *(_DWORD *)(a1 + 44) >= 20 )
      {
        *(_DWORD *)(a1 + 104) += 72;
        *(_DWORD *)(a1 + 112) += 72;
      }
      else
      {
        *(_DWORD *)(a1 + 108) += 24;
        *(_DWORD *)(a1 + 116) += 24;
      }
    }
    result = *(_DWORD *)(a1 + 72) / 2 % 2;
    if ( result )
    {
      *(_DWORD *)(a1 + 108) += 24;
      *(_DWORD *)(a1 + 116) += 24;
      *(_DWORD *)(a1 + 12) *= 2;
      result = a1;
      *(_DWORD *)(a1 + 16) = -1024;
    }
  }
  else
  {
    PlaySound(11);
    AddScore(*(_DWORD *)(a1 + 76));
    CreateEntity(1, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), 0);
    result = CreateCaret(0, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 76));
    *(_DWORD *)a1 = 0;
  }
  return result;
}


NPCHAR *ActNpc006_CloudGen(NPCHAR *a1)
{
  NPCHAR *result; 
  int x; 

  ++a1->count1;
  result = a1;
  if ( a1->count1 > 15 )
  {
    a1->count1 = 0;
    result = (NPCHAR *)(a1->state + 1);
    a1->state = (int)result;
    if ( a1->state > 9 )
    {
      result = a1;
      a1->state = 0;
    }
  }
  if ( !a1->count1 )
  {
    x = (unsigned __int16)GetRandom(120) << 10;
    result = a1;
    switch ( a1->state )
    {
      case 0:
        result = (NPCHAR *)CreateEntity(2, x, -16384, 0);
        break;
      case 1:
        result = (NPCHAR *)CreateEntity(2, x, -16384, 0);
        break;
      case 2:
        result = (NPCHAR *)CreateEntity(3, x, -16384, 0);
        break;
      case 3:
        result = (NPCHAR *)CreateEntity(2, x, -16384, 0);
        break;
      case 4:
        result = (NPCHAR *)CreateEntity(3, x, -16384, 0);
        break;
      case 7:
        result = (NPCHAR *)CreateEntity(2, x, -16384, 0);
        break;
      default:
        return result;
    }
  }
  return result;
}


int ActNpc007_Powerup(NPCHAR *a1)
{
  int *v1; 
  char *v2; 
  int result; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 

  v5 = 240;
  v6 = 48;
  v7 = 256;
  v8 = 64;
  v9 = 240;
  v10 = 64;
  v11 = 256;
  v12 = 80;
  v13 = 240;
  v14 = 80;
  v15 = 256;
  v16 = 96;
  v4 = a1->state;
  if ( v4 )
  {
    if ( v4 != 10 )
      goto LABEL_11;
  }
  else
  {
    a1->state = 10;
    a1->ym = -512;
    PlaySound(26);
    CreateEntity(50, 0, 0, (int)a1);
  }
  a1->ym += 36;
  if ( ++a1->count3 > 2 )
  {
    a1->count3 = 0;
    ++a1->count2;
  }
  if ( a1->count2 > 2 )
    a1->count2 = 0;
  if ( a1->y > 180224 )
    a1->cond = 0;
LABEL_11:
  if ( a1->score )
  {
    if ( ++a1->count1 == 16 )
    {
      a1->count1 = 0;
      --a1->score;
    }
  }
  a1->x += a1->xm;
  a1->y += a1->ym;
  v1 = &v5 + 4 * a1->count2;
  v2 = (char *)&a1->rect;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  *((_DWORD *)v2 + 2) = v1[2];
  result = v1[3];
  *((_DWORD *)v2 + 3) = result;
  return result;
}


int ActNpc008_Climber(int a1)
{
  int *v1; 
  int v2; 
  int result; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 

  v4 = 0;
  v5 = 48;
  v6 = 16;
  v7 = 64;
  v8 = 16;
  v9 = 48;
  v10 = 32;
  v11 = 64;
  v12 = 32;
  v13 = 48;
  v14 = 48;
  v15 = 64;
  switch ( *(_DWORD *)(a1 + 44) )
  {
    case 0:
      *(_DWORD *)(a1 + 8) = 180224;
      *(_DWORD *)(a1 + 16) = -1024;
      PlaySound(26);
      *(_DWORD *)(a1 + 44) = 10;
      *(_DWORD *)(a1 + 52) = 2;
      goto LABEL_3;
    case 0xA:
LABEL_3:
      *(_DWORD *)(a1 + 16) += 32;
      if ( *(_DWORD *)(a1 + 16) <= -512 )
        break;
      *(_DWORD *)(a1 + 44) = 20;
      *(_DWORD *)(a1 + 52) = 0;
      goto LABEL_5;
    case 0x14:
LABEL_5:
      *(_DWORD *)(a1 + 16) += 32;
      if ( *(_DWORD *)(a1 + 16) <= 512 )
        break;
      *(_DWORD *)(a1 + 44) = 30;
      *(_DWORD *)(a1 + 52) = 1;
      goto LABEL_7;
    case 0x1E:
LABEL_7:
      *(_DWORD *)(a1 + 16) += 32;
      if ( *(_DWORD *)(a1 + 16) > 1024 )
      {
        *(_DWORD *)(a1 + 44) = 10;
        *(_DWORD *)(a1 + 16) = -2048;
        *(_DWORD *)(a1 + 52) = 2;
      }
      break;
    default:
      break;
  }
  *(_DWORD *)(a1 + 4) += *(_DWORD *)(a1 + 12);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  v1 = &v4 + 4 * *(_DWORD *)(a1 + 52);
  v2 = a1 + 104;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
  result = *(_DWORD *)(a1 + 72) / 2 % 2;
  if ( result )
  {
    *(_DWORD *)(a1 + 108) += 16;
    *(_DWORD *)(a1 + 116) += 16;
    result = a1;
    *(_DWORD *)(a1 + 16) = -1024;
  }
  if ( *(_DWORD *)(a1 + 8) < -16384 )
    *(_DWORD *)a1 = 0;
  return result;
}


NPCHAR *ActNpc009_Kagome(NPCHAR *a1)
{
  unsigned __int8 v1; 
  char *v2; 
  NPCHAR *result; 

  switch ( a1->state )
  {
    case 0:
      if ( (unsigned __int8)KagomeCount % 2 )
        a1->life = 8;
      else
        a1->life = 4;
      a1->child = 16 * ((unsigned __int8)KagomeCount++ % 16);
      a1->rot1 = 2048;
      a1->state = 10;
      goto LABEL_6;
    case 0xA:
LABEL_6:
      if ( a1->type2 )
        a1->rot1 -= 16;
      else
        a1->rot1 -= 8;
      if ( a1->rot1 > 672 )
        break;
      a1->state = 20;
      a1->count1 = 0;
      goto LABEL_11;
    case 0x14:
LABEL_11:
      if ( ++a1->count1 < 150 )
        break;
      a1->state = 30;
      goto LABEL_13;
    case 0x1E:
LABEL_13:
      a1->rot1 += 8;
      if ( a1->rot1 >= 2560 )
        a1->cond = 0;
      break;
    default:
      break;
  }
  a1->child += 2;
  a1->child %= 256;
  v1 = a1->child;
  a1->x = a1->rot1 * GetCos(a1->child) / 16 + 61440;
  a1->y = a1->rot1 * GetSin(v1) / 16 + 122880;
  v2 = (char *)&a1->rect;
  *(_DWORD *)v2 = 48;
  *((_DWORD *)v2 + 1) = 48;
  *((_DWORD *)v2 + 2) = 64;
  *((_DWORD *)v2 + 3) = 64;
  a1->rect.left += 16 * ((a1->life - 2) / 2);
  a1->rect.right += 16 * ((a1->life - 2) / 2);
  result = (NPCHAR *)(a1->shock / 2 % 2);
  if ( result )
  {
    a1->rect.top += 16;
    result = a1;
    a1->rect.bottom += 16;
  }
  return result;
}



NPCHAR *ActNpc011_Wing(NPCHAR *a4)
{
  NPCHAR *v1; 
  NPCHAR *result; 
  int v3; 
  int state; 
  char v5; 

  state = a4->state;
  if ( state )
  {
    if ( state != 10 )
      goto LABEL_24;
  }
  else
  {
    CreateEntity(12, -1, 0, (int)a4);
    CreateEntity(12, 1, 0, (int)a4);
    a4->state = 10;
    a4->y = 172032;
    if ( a4->type2 )
      a4->ym = -512;
    else
      a4->ym = -256;
    a4->xm = 0;
  }
  if ( ++a4->count1 == 143 )
  {
    CreateCaret(1, a4->x, a4->y, (int)a4);
    PlaySound(30);
  }
  if ( a4->count1 > 162 && !(a4->count1 % 6) )
  {
    v3 = ++a4->child % 3;
    if ( v3 )
    {
      if ( v3 == 1 )
      {
        v5 = 62;
      }
      else if ( v3 == 2 )
      {
        v5 = 66;
      }
    }
    else
    {
      v5 = 64;
    }
    if ( ShipY < a4->y )
      v5 += -128;
    CreateEntity(13, a4->x, a4->y, (unsigned __int8)v5);
    PlaySound(7);
  }
  if ( a4->count1 > 187 )
    a4->count1 = 0;
LABEL_24:
  if ( !(a4->count1 % 6) )
    CreateEntity(29, a4->x, a4->y + 0x2000, 0);
  a4->x += a4->xm;
  a4->y += a4->ym;
  v1 = (NPCHAR *)((char *)a4 + 0x68);
  v1->cond = 0;
  v1->x = 32;
  v1->y = 40;
  v1->xm = 48;
  if ( a4->shock / 2 % 2 )
  {
    a4->rect.top += 16;
    a4->rect.bottom += 16;
  }
  result = a4;
  if ( a4->y < -8192 )
    a4->cond = 0;
  return result;
}


NPCHAR *ActNpc012_WingCorpse(NPCHAR *a1)
{
  NPCHAR *result; 
  int v2; 

  v2 = a1->state;
  if ( !v2 )
  {
    a1->child = a1->x;
    a1->state = 10;
    goto LABEL_5;
  }
  if ( v2 == 10 )
  {
LABEL_5:
    if ( a1->child >= 0 )
      a1->x = *(_DWORD *)(a1->type2 + 4) + 11264;
    else
      a1->x = *(_DWORD *)(a1->type2 + 4) - 11264;
    a1->y = *(_DWORD *)(a1->type2 + 8);
  }
  result = (NPCHAR *)(*(_DWORD *)a1->type2 & 1);
  if ( !result || *(_DWORD *)(a1->type2 + 40) != 11 )
  {
    result = a1;
    a1->cond = 0;
  }
  return result;
}


int ActNpc013_Bullet(NPCHAR *a1)
{
  int *v1; 
  char *v2; 
  int result; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 

  v5 = 144;
  v6 = 32;
  v7 = 160;
  v8 = 48;
  v9 = 160;
  v10 = 32;
  v11 = 176;
  v12 = 48;
  v13 = 176;
  v14 = 32;
  v15 = 192;
  v16 = 48;
  v17 = 192;
  v18 = 32;
  v19 = 208;
  v20 = 48;
  v4 = a1->state;
  if ( !v4 )
  {
    a1->xm = 2 * GetCos(a1->type2);
    a1->ym = 2 * GetSin(a1->type2);
    a1->state = 10;
    goto LABEL_5;
  }
  if ( v4 == 10 )
  {
LABEL_5:
    a1->x += a1->xm;
    a1->y += a1->ym;
  }
  if ( ++a1->count3 > 1 )
  {
    a1->count3 = 0;
    ++a1->count2;
  }
  if ( a1->count2 > 3 )
    a1->count2 = 0;
  if ( a1->x < -65536 || a1->x > 188416 || a1->y < -65536 || a1->y > 229376 )
    a1->cond = 0;
  v1 = &v5 + 4 * a1->count2;
  v2 = (char *)&a1->rect;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  result = v1[2];
  *((_DWORD *)v2 + 2) = result;
  *((_DWORD *)v2 + 3) = v1[3];
  return result;
}


int ActNpc014_BulletSlow(NPCHAR *a1)
{
  int *v1; 
  char *v2; 
  int result; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 

  v5 = 144;
  v6 = 32;
  v7 = 160;
  v8 = 48;
  v9 = 160;
  v10 = 32;
  v11 = 176;
  v12 = 48;
  v13 = 176;
  v14 = 32;
  v15 = 192;
  v16 = 48;
  v17 = 192;
  v18 = 32;
  v19 = 208;
  v20 = 48;
  v4 = a1->state;
  if ( !v4 )
  {
    a1->xm = GetCos(a1->type2);
    a1->ym = GetSin(a1->type2);
    a1->state = 10;
    goto LABEL_5;
  }
  if ( v4 == 10 )
  {
LABEL_5:
    a1->x += a1->xm;
    a1->y += a1->ym;
  }
  if ( ++a1->count3 > 0 )
  {
    a1->count3 = 0;
    ++a1->count2;
  }
  if ( a1->count2 > 3 )
    a1->count2 = 0;
  if ( a1->x < -65536 || a1->x > 188416 || a1->y < -65536 || a1->y > 229376 )
    a1->cond = 0;
  v1 = &v5 + 4 * a1->count2;
  v2 = (char *)&a1->rect;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  result = v1[2];
  *((_DWORD *)v2 + 2) = result;
  *((_DWORD *)v2 + 3) = v1[3];
  return result;
}


tagRECT *ActNpc010_Unused_(NPCHAR *a1)
{
  tagRECT *result; 

  if ( !a1->state )
  {
    a1->flag |= 0x10u;
    a1->state = 10;
  }
  if ( ++a1->count3 > 2 )
  {
    a1->count3 = 0;
    ++a1->count2;
  }
  if ( a1->count2 <= 4 )
  {
    result = &a1->rect;
    a1->rect = *(RECT *)&Npc10Rect[16 * a1->count2];
  }
  else
  {
    result = (tagRECT *)a1;
    a1->cond = 0;
  }
  return result;
}


NPCHAR *ActNpc015_Boss1(NPCHAR *a1)
{
  NPCHAR *result; 
  int v2; 
  int v3; 
  __int16 v4; 
  int v5; 
  __int16 v6; 
  char v7; 
  char *v8; 
  signed int i; 

  if ( a1->state < 100 && a1->life < 872 )
  {
    a1->state = 100;
    SetShipInvincibility();
    a1->flag &= 0xFFFFFFFE;
  }
  switch ( a1->state )
  {
    case 0:
      a1->state = 10;
      a1->y = 196608;
      a1->ym = -256;
      a1->xm = 0;
      CreateEntity(16, a1->x - 23552, a1->y + 2048, (int)a1);
      CreateEntity(16, a1->x + 23552, a1->y + 2048, (int)a1);
      CreateEntity(16, a1->x - 39936, a1->y - 1024, (int)a1);
      CreateEntity(16, a1->x + 39936, a1->y - 1024, (int)a1);
      return (NPCHAR *)CreateEntity(17, 0, 0, (int)a1);
    case 0xA:
      if ( a1->y > 61440 )
        goto LABEL_42;
      a1->state = 20;
      goto LABEL_8;
    case 0x14:
LABEL_8:
      if ( ++a1->ym < 0 )
        goto LABEL_42;
      a1->ym = 0;
      a1->state = 30;
      a1->count1 = -10;
      PlaySound(38);
      goto LABEL_10;
    case 0x1E:
LABEL_10:
      if ( ++a1->count1 < 50 )
        goto LABEL_42;
      a1->state = 40;
      a1->count1 = -50;
      goto LABEL_12;
    case 0x28:
LABEL_12:
      if ( a1->x <= 0x8000 )
        a1->state = 41;
      else
        a1->xm -= 16;
      if ( a1->y >= 0x8000 )
        a1->ym -= 8;
      else
        a1->ym += 8;
      goto LABEL_42;
    case 0x29:
      if ( a1->x >= 90112 )
        a1->state = 40;
      else
        a1->xm += 16;
      if ( a1->y >= 0x8000 )
        a1->ym -= 8;
      else
        a1->ym += 8;
      goto LABEL_42;
    case 0x64:
      a1->state = 110;
      a1->count1 = 0;
      a1->xm = 0;
      a1->ym = 0;
      PlayLoopSound(32);
      goto LABEL_27;
    case 0x6E:
LABEL_27:
      v2 = a1->count1++;
      if ( v2 < 60 )
        goto LABEL_42;
      if ( a1->x >= 61440 )
        a1->xm = -256;
      else
        a1->xm = 256;
      a1->ym = 341;
      a1->state = 120;
      a1->count1 = -2;
      PlaySound(12);
      if ( !(ShipCond & 2) )
      {
        AddScore(a1->score);
        CreateCaret(0, a1->x, a1->y - 0x2000, a1->score);
      }
      for ( i = 0; i < 20; ++i )
      {
        v3 = a1->y + (((unsigned __int16)GetRandom(16) - 4) << 10);
        v4 = GetRandom(96);
        CreateEntity(1, a1->x + (((unsigned __int16)v4 - 48) << 10), v3, 0);
      }
      goto LABEL_36;
    case 0x78:
LABEL_36:
      if ( ++a1->count1 > 5 )
      {
        a1->count1 = (unsigned __int16)GetRandom(4);
        v5 = a1->y + (((unsigned __int16)GetRandom(16) - 4) << 10);
        v6 = GetRandom(96);
        CreateEntity(1, a1->x + (((unsigned __int16)v6 - 48) << 10), v5, 0);
      }
      if ( a1->y < 139264 )
        goto LABEL_42;
      a1->state = 130;
      CreateEntity(6, 0, 0, 0);
      goto LABEL_40;
    case 0x82:
LABEL_40:
      if ( a1->y <= 188416 )
        goto LABEL_42;
      a1->cond = 0;
      CheckStageClear(1);
      result = (NPCHAR *)StopLoopSound(32);
      break;
    default:
LABEL_42:
      if ( a1->state >= 40 && a1->state < 100 )
      {
        if ( ++a1->count1 > 319 )
          a1->count1 = 0;
        if ( a1->flag & 1 )
        {
          if ( ++a1->child == 149 )
          {
            CreateEntity(18, a1->x, a1->y, 0);
            CreateEntity(18, a1->x, a1->y, 1);
            CreateEntity(18, a1->x, a1->y, 2);
          }
          else if ( a1->child == 150 )
          {
            CreateEntity(18, a1->x - a1->xm, a1->y, 0);
            CreateEntity(18, a1->x - a1->xm, a1->y, 1);
            CreateEntity(18, a1->x - a1->xm, a1->y, 2);
          }
          switch ( a1->child )
          {
            case 0x1E:
              CreateCaret(1, a1->x, a1->y, (int)a1);
              PlaySound(30);
              break;
            case 0x32:
              v7 = GetArktan(a1->x - (_DWORD)ShipX, a1->y - ShipY, 64);
              CreateEntity(13, a1->x, a1->y, (unsigned __int8)v7);
              CreateEntity(13, a1->x, a1->y, (unsigned __int8)v7 - 16);
              CreateEntity(13, a1->x, a1->y, (unsigned __int8)v7 + 16);
              PlaySound(7);
              break;
            case 0x94:
              PlaySound(9);
              break;
            case 0x82:
              CreateCaret(4, a1->x, a1->y, (int)a1);
              PlaySound(31);
              break;
            case 0x96:
              a1->child = 0;
              break;
          }
        }
      }
      if ( a1->xm > 256 )
        a1->xm = 256;
      if ( a1->xm < -256 )
        a1->xm = -256;
      if ( a1->ym > 341 )
        a1->ym = 341;
      if ( a1->ym < -341 )
        a1->ym = -341;
      a1->x += a1->xm;
      a1->y += a1->ym;
      v8 = (char *)&a1->rect;
      *(_DWORD *)v8 = 48;
      *((_DWORD *)v8 + 1) = 0;
      *((_DWORD *)v8 + 2) = 184;
      *((_DWORD *)v8 + 3) = 32;
      result = (NPCHAR *)(a1->shock / 2 % 2);
      if ( result )
      {
        a1->rect.top += 32;
        result = a1;
        a1->rect.bottom += 32;
      }
      break;
  }
  return result;
}


NPCHAR *ActNpc016_Boss1Eye(NPCHAR *a1)
{
  int v1; 
  int *v2; 
  char *v3; 
  NPCHAR *result; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  NPCHAR *v17; 
  unsigned __int8 v18; 

  v5 = 0;
  v6 = 64;
  v7 = 16;
  v8 = 80;
  v9 = 32;
  v10 = 64;
  v11 = 48;
  v12 = 80;
  v13 = 64;
  v14 = 64;
  v15 = 80;
  v16 = 80;
  v17 = (NPCHAR *)a1->type2;
  switch ( a1->state )
  {
    case 0:
      a1->child = a1->x - v17->x;
      a1->rot1 = a1->y - v17->y;
      a1->count4 = byte_44C265;
      byte_44C265 = (byte_44C265 + 1) % 4;
      a1->state = 10;
      a1->flag |= 0xAu;
      goto LABEL_3;
    case 0xA:
LABEL_3:
      a1->x = a1->child + v17->x;
      a1->y = a1->rot1 + v17->y;
      if ( v17->state != 30 && v17->count1 != 20 )
        goto LABEL_20;
      a1->state = 20;
      a1->count2 = 1;
      a1->flag &= 0xFFFFFFF7;
      a1->flag |= 1u;
      CreateCaret(1, a1->x, a1->y, (int)a1);
      goto LABEL_6;
    case 0x14:
LABEL_6:
      v18 = GetArktan(a1->x - (_DWORD)ShipX, a1->y - ShipY, 64);
      a1->x = a1->child + v17->x + 4 * GetCos(v18);
      a1->y = a1->rot1 + v17->y + 4 * GetSin(v18);
      if ( v17->state >= 40 && v17->state < 100 && v17->count1 / 39 == a1->count4 )
      {
        if ( v17->count1 % 39 )
        {
          if ( v17->count1 % 39 == 20 )
          {
            v18 = GetArktan(a1->x - (_DWORD)ShipX, a1->y - ShipY, 64);
            CreateEntity(13, a1->x, a1->y, v18);
            PlaySound(7);
          }
        }
        else
        {
          CreateCaret(1, a1->x, a1->y, (int)a1);
          PlaySound(30);
        }
      }
      if ( v17->state != 110 || v17->count1 / 10 != a1->count4 )
      {
        if ( a1->life > 64 )
          goto LABEL_20;
      }
      else
      {
        a1->score = 4;
      }
      ++v17->rot1;
      a1->state = 100;
      a1->count2 = 2;
      a1->shock = 0;
      a1->flag &= 0xFFFFFFFE;
      AddScore(a1->score);
      CreateCaret(0, a1->x, a1->y - 24576, a1->score);
      CreateEntity(1, a1->x, a1->y, 0);
      PlaySound(11);
LABEL_18:
      a1->x = a1->child + v17->x;
      a1->y = a1->rot1 + v17->y;
      v1 = a1->count1++ % 6;
      if ( !v1 )
        CreateEntity(29, a1->x, a1->y + 0x2000, 0);
LABEL_20:
      v2 = &v5 + 4 * a1->count2;
      v3 = (char *)&a1->rect;
      *(_DWORD *)v3 = *v2;
      *((_DWORD *)v3 + 1) = v2[1];
      *((_DWORD *)v3 + 2) = v2[2];
      *((_DWORD *)v3 + 3) = v2[3];
      if ( a1->shock / 2 % 2 )
      {
        a1->rect.left += 16;
        a1->rect.right += 16;
      }
      result = v17;
      if ( !(v17->cond & 1) || v17->type != 15 )
      {
        result = a1;
        a1->cond = 0;
      }
      return result;
    case 0x64:
      goto LABEL_18;
    default:
      goto LABEL_20;
  }
}



NPCHAR *ActNpc017_Boss1BigEye(NPCHAR *a1)
{
  int v1; 
  __int16 v2; 
  int *v3; 
  char *v4; 
  NPCHAR *result; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  NPCHAR *v18; 

  v6 = 96;
  v7 = 80;
  v8 = 120;
  v9 = 128;
  v10 = 0;
  v11 = 0;
  v12 = 0;
  v13 = 0;
  v14 = 80;
  v15 = 64;
  v16 = 96;
  v17 = 80;
  v18 = (NPCHAR *)a1->type2;
  switch ( a1->state )
  {
    case 0:
      a1->state = 10;
      a1->flag |= 0xAu;
      goto LABEL_3;
    case 0xA:
LABEL_3:
      if ( v18->state < 40 )
        break;
      a1->state = 20;
      a1->flag &= 0xFFFFFFF7;
      a1->flag |= 1u;
      goto LABEL_5;
    case 0x14:
LABEL_5:
      if ( a1->life > 52 && v18->rot1 < 4 )
        break;
      a1->state = 30;
      a1->count1 = 0;
      a1->flag &= 0xFFFFFFFE;
      goto LABEL_8;
    case 0x1E:
LABEL_8:
      if ( !(a1->count1 % 10) )
      {
        v1 = a1->y + (((unsigned __int16)GetRandom(48) - 32) << 10);
        v2 = GetRandom(32);
        CreateEntity(1, a1->x + (((unsigned __int16)v2 - 16) << 10), v1, 0);
        PlaySound(26);
      }
      if ( ++a1->count1 < 50 )
        break;
      a1->state = 40;
      a1->count2 = 1;
      a1->shock = 0;
      CreateEntity(1, a1->x + 4096, a1->y - 0x4000, 0);
      CreateEntity(1, a1->x - 0x2000, a1->y, 0);
      CreateEntity(1, a1->x + 12288, a1->y + 0x2000, 0);
      PlaySound(11);
      v18->flag |= 3u;
      ClearReplaceNpChar(6, 0);
      goto LABEL_12;
    case 0x28:
LABEL_12:
      if ( v18->state != 120 )
        break;
      a1->state = 100;
      a1->count2 = 2;
      a1->xoff = 0x2000;
      a1->yoff = 4096;
      goto LABEL_14;
    case 0x64:
LABEL_14:
      if ( v18->state != 120 || v18->count1 != -1 )
        break;
      a1->state = 110;
      a1->life = 100;
      a1->flag |= 1u;
      a1->destroyHitVoice = 4;
      a1->w = 6144;
      a1->h = 0x2000;
      goto LABEL_18;
    case 0x6E:
LABEL_18:
      if ( a1->life <= 52 )
      {
        a1->state = 120;
        CreateEntity(7, a1->x, a1->y, 2);
        a1->flag &= 0xFFFFFFFE;
        PlaySound(11);
        CreateEntity(1, a1->x, a1->y, 0);
      }
      break;
    default:
      break;
  }
  a1->x = v18->x;
  a1->y = v18->y - 6144;
  v3 = &v6 + 4 * a1->count2;
  v4 = (char *)&a1->rect;
  *(_DWORD *)v4 = *v3;
  *((_DWORD *)v4 + 1) = v3[1];
  result = (NPCHAR *)v3[2];
  *((_DWORD *)v4 + 2) = result;
  *((_DWORD *)v4 + 3) = v3[3];
  if ( a1->state == 20 )
  {
    result = (NPCHAR *)(a1->shock / 2 % 2);
    if ( result )
    {
      a1->rect.left += 24;
      result = a1;
      a1->rect.right += 24;
    }
  }
  if ( !(v18->cond & 1) || (result = v18, v18->type != 15) )
    a1->cond = 0;
  return result;
}


NPCHAR *ActNpc018_BulletLong(NPCHAR *a1)
{
  int *v1; 
  char *v2; 
  NPCHAR *result; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 

  v5 = 0;
  v6 = 96;
  v7 = 16;
  v8 = 112;
  v9 = 32;
  v10 = 96;
  v11 = 48;
  v12 = 112;
  v13 = 64;
  v14 = 96;
  v15 = 80;
  v16 = 112;
  if ( !a1->type2 )
  {
    a1->count2 = 2;
    a1->y += 4096;
    goto LABEL_16;
  }
  v4 = a1->state;
  if ( v4 )
  {
    if ( v4 != 10 )
    {
      if ( v4 != 20 )
        goto LABEL_16;
LABEL_13:
      a1->y += 4096;
      goto LABEL_16;
    }
LABEL_11:
    if ( ++a1->count1 == 1 )
      goto LABEL_16;
    a1->state = 20;
    a1->count2 = 2;
    a1->y += 4096;
    goto LABEL_13;
  }
  if ( a1->type2 == 1 )
    a1->x -= 0x2000;
  else
    a1->x += 0x2000;
  a1->y += 4096;
  if ( ++a1->count1 >= 5 )
  {
    a1->state = 10;
    a1->count1 = 0;
    a1->count2 = 1;
    goto LABEL_11;
  }
LABEL_16:
  if ( a1->y > 172032 )
    a1->cond = 0;
  v1 = &v5 + 4 * a1->count2;
  v2 = (char *)&a1->rect;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  result = (NPCHAR *)v1[2];
  *((_DWORD *)v2 + 2) = result;
  *((_DWORD *)v2 + 3) = v1[3];
  if ( a1->type2 == 2 )
  {
    result = a1;
    if ( a1->count2 < 2 )
    {
      a1->rect.left += 16;
      result = a1;
      a1->rect.right += 16;
    }
  }
  return result;
}


signed int ActNpc019_BGM(NPCHAR *a1)
{
  signed int result; 

  result = ChangeMusic(a1->type2);
  a1->cond = 0;
  return result;
}


signed int ActNpc020_Asteroid_L(NPCHAR *a1)
{
  signed int result; 
  char *v2; 
  char *v3; 
  int v4; 

  if ( a1->life < 82 )
  {
    CreateEntity(23, a1->x - 4096, a1->y - 4096, 0);
    CreateEntity(23, a1->x + 4096, a1->y - 4096, 1);
    CreateEntity(23, a1->x - 4096, a1->y + 4096, 2);
    CreateEntity(23, a1->x + 4096, a1->y + 4096, 3);
    PlaySound(12);
    CreateEntity(1, a1->x, a1->y, 0);
    a1->cond = 0;
    ++asteroidsKilled;
    result = a1->x;
    bonusAzaX = a1->x;
    bonusAzaY = a1->y - 0x2000;
    return result;
  }
  v4 = a1->state;
  if ( !v4 )
  {
    a1->state = 1;
    a1->y -= 0x2000;
    a1->ym = 1024;
LABEL_7:
    a1->y += a1->ym;
    if ( a1->y > 180224 )
      a1->cond = 0;
    goto LABEL_9;
  }
  if ( v4 == 1 )
    goto LABEL_7;
LABEL_9:
  if ( a1->shock / 2 % 2 )
  {
    v2 = (char *)&a1->rect;
    *(_DWORD *)v2 = 32;
    *((_DWORD *)v2 + 1) = 160;
    result = 64;
    *((_DWORD *)v2 + 2) = 64;
    *((_DWORD *)v2 + 3) = 192;
  }
  else
  {
    v3 = (char *)&a1->rect;
    *(_DWORD *)v3 = 0;
    *((_DWORD *)v3 + 1) = 160;
    result = 32;
    *((_DWORD *)v3 + 2) = 32;
    *((_DWORD *)v3 + 3) = 192;
  }
  return result;
}





signed int ActNpc021_Asteroid_S(int a1)
{
  int v1; 
  signed int result; 
  int v3; 
  int v4; 

  v4 = *(_DWORD *)(a1 + 44);
  if ( v4 )
  {
    if ( v4 != 1 )
      goto LABEL_7;
  }
  else
  {
    *(_DWORD *)(a1 + 44) = 1;
    *(_DWORD *)(a1 + 16) = 1024;
  }
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  if ( *(_DWORD *)(a1 + 8) > 180224 )
    *(_DWORD *)a1 = 0;
LABEL_7:
  if ( *(_DWORD *)(a1 + 72) / 2 % 2 )
  {
    v1 = a1 + 104;
    *(_DWORD *)v1 = 64;
    *(_DWORD *)(v1 + 4) = 176;
    result = 80;
    *(_DWORD *)(v1 + 8) = 80;
    *(_DWORD *)(v1 + 12) = 192;
  }
  else
  {
    v3 = a1 + 104;
    *(_DWORD *)v3 = 64;
    *(_DWORD *)(v3 + 4) = 160;
    result = 80;
    *(_DWORD *)(v3 + 8) = 80;
    *(_DWORD *)(v3 + 12) = 176;
  }
  return result;
}


int ActNpc022_ScrollSpdSet(NPCHAR *a1)
{
  int result; 

  result = SetScrollSpeed(-1024 * a1->type2 / 100);
  a1->cond = 0;
  return result;
}


LONG *ActNpc023_Asteroid_SGravity(NPCHAR *a1)
{
  char *v1; 
  LONG *result; 
  char *v3; 
  int v4; 

  v4 = a1->state;
  if ( v4 )
  {
    if ( v4 != 1 )
      goto LABEL_11;
  }
  else
  {
    a1->state = 1;
    switch ( a1->type2 )
    {
      case 0:
        a1->ym = -614;
        a1->xm = -113;
        break;
      case 1:
        a1->ym = -921;
        a1->xm = 102;
        break;
      case 2:
        a1->ym = -512;
        a1->xm = -341;
        break;
      case 3:
        a1->ym = -819;
        a1->xm = 256;
        break;
      default:
        break;
    }
  }
  a1->ym += 32;
  a1->x += a1->xm;
  a1->y += a1->ym;
  if ( a1->y > 180224 )
    a1->cond = 0;
LABEL_11:
  if ( a1->shock / 2 % 2 )
  {
    v1 = (char *)&a1->rect;
    *(_DWORD *)v1 = 64;
    *((_DWORD *)v1 + 1) = 176;
    *((_DWORD *)v1 + 2) = 80;
    result = (LONG *)192;
    *((_DWORD *)v1 + 3) = 192;
  }
  else
  {
    v3 = (char *)&unk_43B4C0 + 16 * a1->count2;
    result = &a1->rect.left;
    *result = *(_DWORD *)v3;
    result[1] = *((_DWORD *)v3 + 1);
    result[2] = *((_DWORD *)v3 + 2);
    result[3] = *((_DWORD *)v3 + 3);
  }
  return result;
}


int ActNpc024_Hanger_Wave(int nHeight)
{
  int *v1; 
  int v2; 
  int result; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  unsigned __int8 v17; 

  v5 = 72;
  v6 = 0;
  v7 = 96;
  v8 = 24;
  v9 = 96;
  v10 = 0;
  v11 = 120;
  v12 = 24;
  v13 = 120;
  v14 = 0;
  v15 = 144;
  v16 = 24;
  v4 = *(_DWORD *)(nHeight + 44);
  if ( v4 )
  {
    if ( v4 != 10 )
      goto LABEL_20;
  }
  else
  {
    *(_DWORD *)(nHeight + 44) = 10;
    *(_DWORD *)(nHeight + 8) = -4096;
    *(_DWORD *)(nHeight + 16) = 1024;
    *(_DWORD *)(nHeight + 84) = *(_DWORD *)(nHeight + 4);
    if ( *(_DWORD *)(nHeight + 4) >= 61440 )
      *(_DWORD *)(nHeight + 12) = -2048;
    else
      *(_DWORD *)(nHeight + 12) = 2048;
  }
  if ( ++*(_DWORD *)(nHeight + 48) == 20 )
    *(_DWORD *)(nHeight + 68) |= 3u;
  if ( ++*(_DWORD *)(nHeight + 56) > 2 )
  {
    *(_DWORD *)(nHeight + 56) = 0;
    ++*(_DWORD *)(nHeight + 52);
  }
  if ( *(_DWORD *)(nHeight + 52) > 2 )
    *(_DWORD *)(nHeight + 52) = 0;
  if ( *(_DWORD *)(nHeight + 84) >= *(_DWORD *)(nHeight + 4) )
    *(_DWORD *)(nHeight + 12) += 85;
  else
    *(_DWORD *)(nHeight + 12) -= 85;
  if ( *(_DWORD *)(nHeight + 12) < -2048 )
    *(_DWORD *)(nHeight + 12) = -2048;
  if ( *(_DWORD *)(nHeight + 12) > 2048 )
    *(_DWORD *)(nHeight + 12) = 2048;
LABEL_20:
  if ( *(_DWORD *)(nHeight + 80) )
  {
    if ( ++*(_DWORD *)(nHeight + 88) == 12 )
    {
      CreateCaret(1, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), nHeight);
      PlaySound(30);
    }
    if ( *(_DWORD *)(nHeight + 88) == 31 )
    {
      v17 = GetArktan(*(_DWORD *)(nHeight + 4) - (_DWORD)ShipX, *(_DWORD *)(nHeight + 8) - ShipY, 64);
      CreateEntity(13, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), v17);
      PlaySound(7);
    }
  }
  if ( *(_DWORD *)(nHeight + 8) > 176128 )
    *(_DWORD *)nHeight = 0;
  *(_DWORD *)(nHeight + 4) += *(_DWORD *)(nHeight + 12);
  *(_DWORD *)(nHeight + 8) += *(_DWORD *)(nHeight + 16);
  v1 = &v5 + 4 * *(_DWORD *)(nHeight + 52);
  v2 = nHeight + 104;
  *(_DWORD *)v2 = *v1;
  *(_DWORD *)(v2 + 4) = v1[1];
  *(_DWORD *)(v2 + 8) = v1[2];
  *(_DWORD *)(v2 + 12) = v1[3];
  if ( *(_DWORD *)(nHeight + 60) < 4 )
  {
    *(_DWORD *)(nHeight + 104) += 72;
    *(_DWORD *)(nHeight + 112) += 72;
  }
  result = *(_DWORD *)(nHeight + 72) / 2 % 2;
  if ( result )
  {
    *(_DWORD *)(nHeight + 108) += 24;
    result = nHeight;
    *(_DWORD *)(nHeight + 116) += 24;
  }
  return result;
}


NPCHAR *ActNpc025_Hanger_Shoot(NPCHAR *a1)
{
  int *v1; 
  char *v2; 
  NPCHAR *result; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 
  int v23; 
  int v24; 
  int v25; 
  int v26; 
  int v27; 
  unsigned __int8 v28; 

  v4 = 0;
  v5 = 0;
  v6 = 24;
  v7 = 24;
  v8 = 24;
  v9 = 0;
  v10 = 48;
  v11 = 24;
  v12 = 48;
  v13 = 0;
  v14 = 72;
  v15 = 24;
  v16 = 72;
  v17 = 0;
  v18 = 96;
  v19 = 24;
  v20 = 96;
  v21 = 0;
  v22 = 120;
  v23 = 24;
  v24 = 120;
  v25 = 0;
  v26 = 144;
  v27 = 24;
  switch ( a1->state )
  {
    case 0:
      a1->state = 10;
      a1->y = 163840;
      a1->ym = -6144;
      if ( a1->type2 )
      {
        a1->life = 1;
        a1->score = 0;
      }
      PlaySound(26);
      goto LABEL_5;
    case 0xA:
LABEL_5:
      a1->ym += 113;
      if ( ++a1->count3 > 2 )
      {
        a1->count3 = 0;
        ++a1->count2;
      }
      if ( a1->count2 > 2 )
        a1->count2 = 0;
      if ( a1->ym > 0 )
        goto LABEL_10;
      break;
    case 0x14:
LABEL_10:
      a1->state = 30;
      a1->count1 = 0;
      a1->flag |= 3u;
      a1->damage = 1;
      CreateCaret(1, a1->x, a1->y, (int)a1);
      PlaySound(30);
      goto LABEL_11;
    case 0x1E:
LABEL_11:
      if ( (signed int)ShipX >= a1->x )
        a1->xm += 64;
      else
        a1->xm -= 64;
      if ( a1->xm < -1024 )
        a1->xm = -1024;
      if ( a1->xm > 1024 )
        a1->xm = 1024;
      a1->ym += 42;
      if ( a1->ym > 1536 )
        a1->ym = 1536;
      if ( ++a1->count1 == 5 )
      {
        v28 = GetArktan(a1->x - (_DWORD)ShipX, a1->y - ShipY, 64);
        CreateEntity(13, a1->x, a1->y, v28);
        PlaySound(7);
      }
      if ( ++a1->count3 > 1 )
      {
        a1->count3 = 0;
        ++a1->count2;
      }
      if ( a1->count2 > 5 )
        a1->count2 = 3;
      if ( a1->y > 180224 )
        a1->cond = 0;
      break;
    default:
      break;
  }
  a1->x += a1->xm;
  a1->y += a1->ym;
  v1 = &v4 + 4 * a1->count2;
  v2 = (char *)&a1->rect;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  *((_DWORD *)v2 + 2) = v1[2];
  *((_DWORD *)v2 + 3) = v1[3];
  if ( a1->life < 4 )
  {
    if ( a1->state >= 20 )
    {
      a1->rect.left += 72;
      a1->rect.right += 72;
    }
    else
    {
      a1->rect.top += 24;
      a1->rect.bottom += 24;
    }
  }
  result = (NPCHAR *)(a1->shock / 2 % 2);
  if ( result )
  {
    a1->rect.top += 24;
    result = a1;
    a1->rect.bottom += 24;
    a1->ym = -1024;
  }
  return result;
}


NPCHAR *ActNpc026_RockHugger(NPCHAR *a1)
{
  NPCHAR *result; 
  int *v2; 
  char *v3; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  NPCHAR *v21; 

  v5 = 80;
  v6 = 0;
  v7 = 104;
  v8 = 24;
  v9 = 104;
  v10 = 0;
  v11 = 128;
  v12 = 24;
  v13 = 128;
  v14 = 0;
  v15 = 152;
  v16 = 24;
  v17 = 0;
  v18 = 0;
  v19 = 0;
  v20 = 0;
  v21 = (NPCHAR *)a1->child;
  if ( a1->life > 96 )
  {
    switch ( a1->state )
    {
      case 0:
        a1->state = 10;
        a1->ym = -1024;
        a1->y = 200704;
        PlaySound(26);
        v4 = a1->type2;
        if ( v4 )
        {
          if ( v4 != 1 )
          {
            if ( v4 == 2 )
              a1->state = 30;
            break;
          }
          a1->child = (int)CreateEntity(28, a1->x, a1->y - 10240, 0);
          result = a1;
          if ( a1->child )
          {
            a1->y -= 0x4000;
            break;
          }
          a1->cond = 0;
        }
        else
        {
          a1->child = (int)CreateEntity(27, a1->x, a1->y - 0x4000, 0);
          if ( a1->child )
            break;
          result = a1;
          a1->cond = 0;
        }
        return result;
      case 0xA:
        a1->ym += 32;
        a1->y += a1->ym;
        if ( a1->ym > 512 )
          a1->state = 20;
        break;
      case 0x14:
        a1->ym -= 42;
        if ( a1->type2 )
        {
          if ( a1->ym < -1024 )
            a1->ym = -1024;
        }
        else if ( a1->ym < -512 )
        {
          a1->ym = -512;
        }
        a1->y += a1->ym;
        a1->x += a1->xm;
        break;
      case 0x1E:
        a1->ym -= 42;
        if ( (signed int)ShipX >= a1->x )
          a1->xm += 64;
        else
          a1->xm -= 64;
        if ( a1->xm < -1024 )
          a1->xm = -1024;
        if ( a1->xm > 1024 )
          a1->xm = 1024;
        a1->y += a1->ym;
        a1->x += a1->xm;
        if ( a1->ym < -512 )
        {
          a1->state = 40;
          a1->count2 = 2;
          a1->y += 3072;
          a1->xm = 0;
        }
        break;
      case 0x28:
        a1->ym -= 42;
        a1->y += a1->ym;
        a1->x += a1->xm;
        break;
      default:
        break;
    }
    if ( (a1->state == 10 || a1->state == 20) && v21 )
    {
      if ( v21->state < 100 )
      {
        if ( a1->y >= 0x4000 )
        {
          if ( a1->type2 )
            v21->y = a1->y - 10240;
          else
            v21->y = a1->y - 0x4000;
        }
        else
        {
          v21->state = 1;
          a1->state = 30;
          a1->count2 = 1;
          a1->score = 1;
          a1->ym = 1024;
        }
      }
      else
      {
        a1->state = 30;
        a1->count2 = 1;
        a1->score = 1;
        a1->ym = 1024;
      }
    }
    if ( !(++a1->count1 % 6) )
      CreateEntity(29, a1->x, a1->y + 0x2000, 0);
    if ( a1->state >= 30 && a1->count1 % 6 == 3 )
      CreateEntity(29, a1->x, a1->y + 4096, 0);
    if ( a1->y < -12288 )
      a1->cond = 0;
    v2 = &v5 + 4 * a1->count2;
    v3 = (char *)&a1->rect;
    *(_DWORD *)v3 = *v2;
    *((_DWORD *)v3 + 1) = v2[1];
    *((_DWORD *)v3 + 2) = v2[2];
    *((_DWORD *)v3 + 3) = v2[3];
    result = (NPCHAR *)(a1->shock / 2 % 2);
    if ( result )
    {
      a1->rect.top += 24;
      result = a1;
      a1->rect.bottom += 24;
    }
  }
  else
  {
    AddScore(a1->score);
    CreateCaret(0, a1->x, a1->y - 0x4000, a1->score);
    CreateEntity(1, a1->x, a1->y - 4096, 0);
    PlaySound(11);
    result = a1;
    if ( a1->state == 20 || a1->state == 10 )
    {
      if ( v21 )
      {
        v21->state = 1;
        result = v21;
        v21->ym = 0;
      }
    }
    a1->cond = 0;
  }
  return result;
}


LONG *ActNpc027_RHAsteroidL(NPCHAR *a1)
{
  LONG *result; 
  int v2; 
  char *v3; 
  char *v4; 
  int v5; 

  if ( a1->state >= 100 || a1->life >= 82 )
  {
    v5 = a1->state;
    if ( v5 == 1 )
    {
      a1->ym += 32;
      a1->y += a1->ym;
      if ( a1->y > 196608 )
        a1->cond = 0;
    }
    else if ( v5 == 100 )
    {
      v2 = a1->count1++;
      if ( v2 > 10 )
        a1->cond = 0;
    }
    if ( a1->shock / 2 % 2 )
    {
      v3 = (char *)&a1->rect;
      *(_DWORD *)v3 = 32;
      *((_DWORD *)v3 + 1) = 160;
      *((_DWORD *)v3 + 2) = 64;
      result = (LONG *)192;
      *((_DWORD *)v3 + 3) = 192;
    }
    else
    {
      v4 = (char *)&unk_43B4F0 + 16 * a1->count2;
      result = &a1->rect.left;
      *result = *(_DWORD *)v4;
      result[1] = *((_DWORD *)v4 + 1);
      result[2] = *((_DWORD *)v4 + 2);
      result[3] = *((_DWORD *)v4 + 3);
    }
  }
  else
  {
    CreateEntity(23, a1->x - 6144, a1->y - 6144, 0);
    CreateEntity(23, a1->x + 6144, a1->y - 6144, 1);
    CreateEntity(23, a1->x - 6144, a1->y + 6144, 2);
    CreateEntity(23, a1->x + 6144, a1->y + 6144, 3);
    PlaySound(12);
    CreateEntity(1, a1->x, a1->y, 0);
    a1->state = 100;
    a1->count2 = 2;
    a1->shock = 0;
    a1->flag &= 0xFFFFFFFC;
    ++asteroidsKilled;
    result = (LONG *)a1->x;
    bonusAzaX = a1->x;
    bonusAzaY = a1->y - 0x2000;
  }
  return result;
}





int ActNpc028_RHAsteroidS(int a1)
{
  int result; 
  signed int v2; 
  int v3; 
  char *v4; 
  int v5; 

  if ( *(_DWORD *)(a1 + 44) >= 100 || *(_DWORD *)(a1 + 60) >= 94 )
  {
    v5 = *(_DWORD *)(a1 + 44);
    if ( v5 == 1 )
    {
      *(_DWORD *)(a1 + 16) += 32;
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      if ( *(_DWORD *)(a1 + 8) > 196608 )
        *(_DWORD *)a1 = 0;
    }
    else if ( v5 == 100 )
    {
      v2 = (*(_DWORD *)(a1 + 48))++;
      if ( v2 > 10 )
        *(_DWORD *)a1 = 0;
    }
    if ( *(_DWORD *)(a1 + 72) / 2 % 2 )
    {
      v3 = a1 + 104;
      *(_DWORD *)v3 = 64;
      *(_DWORD *)(v3 + 4) = 176;
      *(_DWORD *)(v3 + 8) = 80;
      result = 192;
      *(_DWORD *)(v3 + 12) = 192;
    }
    else
    {
      v4 = (char *)&unk_43B520 + 16 * *(_DWORD *)(a1 + 52);
      result = a1 + 104;
      *(_DWORD *)result = *(_DWORD *)v4;
      *(_DWORD *)(result + 4) = *((_DWORD *)v4 + 1);
      *(_DWORD *)(result + 8) = *((_DWORD *)v4 + 2);
      *(_DWORD *)(result + 12) = *((_DWORD *)v4 + 3);
    }
  }
  else
  {
    PlaySound(14);
    CreateEntity(1, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), 0);
    *(_DWORD *)(a1 + 44) = 100;
    *(_DWORD *)(a1 + 52) = 2;
    *(_DWORD *)(a1 + 72) = 0;
    result = a1;
    *(_DWORD *)(a1 + 68) &= 0xFFFFFFFC;
  }
  return result;
}


NPCHAR *ActNpc029_Bullet2_(NPCHAR *a1)
{
  NPCHAR *result; 
  int *v2; 
  char *v3; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 

  v4 = 176;
  v5 = 48;
  v6 = 184;
  v7 = 56;
  v8 = 184;
  v9 = 48;
  v10 = 192;
  v11 = 56;
  v12 = 192;
  v13 = 48;
  v14 = 200;
  v15 = 56;
  v16 = 200;
  v17 = 48;
  v18 = 208;
  v19 = 56;
  if ( a1->type2 )
    a1->y -= 2048;
  else
    a1->y += 2048;
  if ( a1->y > 172032 )
    a1->cond = 0;
  if ( ++a1->count3 > 1 )
  {
    a1->count3 = 0;
    ++a1->count2;
  }
  if ( a1->count2 <= 3 )
  {
    v2 = &v4 + 4 * a1->count2;
    v3 = (char *)&a1->rect;
    *(_DWORD *)v3 = *v2;
    *((_DWORD *)v3 + 1) = v2[1];
    *((_DWORD *)v3 + 2) = v2[2];
    result = (NPCHAR *)v2[3];
    *((_DWORD *)v3 + 3) = result;
  }
  else
  {
    result = a1;
    a1->cond = 0;
  }
  return result;
}


int ActNpc030_Elka(int nHeight)
{
  int v1; 
  int result; 
  __int64 v3; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 
  int v23; 
  int v24; 
  int v25; 
  int v26; 
  int v27; 
  int v28; 
  int v29; 
  unsigned __int8 v30; 

  v6 = 152;
  v7 = 0;
  v8 = 184;
  v9 = 32;
  v10 = 184;
  v11 = 0;
  v12 = 216;
  v13 = 32;
  v14 = 216;
  v15 = 0;
  v16 = 248;
  v17 = 32;
  v18 = 152;
  v19 = 32;
  v20 = 184;
  v21 = 64;
  v22 = 184;
  v23 = 32;
  v24 = 216;
  v25 = 64;
  v26 = 216;
  v27 = 32;
  v28 = 248;
  v29 = 64;
  switch ( *(_DWORD *)(nHeight + 44) )
  {
    case 0:
      *(_DWORD *)(nHeight + 44) = 10;
      *(_DWORD *)(nHeight + 8) = -16384;
      *(_DWORD *)(nHeight + 16) = 1024;
      *(_DWORD *)(nHeight + 84) = *(_DWORD *)(nHeight + 60) - 18;
      goto LABEL_3;
    case 0xA:
LABEL_3:
      *(_DWORD *)(nHeight + 8) += *(_DWORD *)(nHeight + 16);
      if ( *(_DWORD *)(nHeight + 8) > 139264 )
        *(_DWORD *)(nHeight + 16) -= 42;
      if ( *(_DWORD *)(nHeight + 16) < 0 )
      {
        *(_DWORD *)(nHeight + 16) = 0;
        if ( *(_DWORD *)(nHeight + 4) <= 61440 )
        {
          *(_DWORD *)(nHeight + 44) = 25;
          *(_DWORD *)(nHeight + 12) = 512;
        }
        else
        {
          *(_DWORD *)(nHeight + 44) = 20;
          *(_DWORD *)(nHeight + 12) = -512;
        }
      }
      break;
    case 0x14:
      *(_DWORD *)(nHeight + 4) += *(_DWORD *)(nHeight + 12);
      if ( *(_DWORD *)(nHeight + 4) < 0x4000 )
        *(_DWORD *)(nHeight + 12) += 42;
      if ( *(_DWORD *)(nHeight + 12) > 0 )
      {
        *(_DWORD *)(nHeight + 12) = 0;
        *(_DWORD *)(nHeight + 44) = 30;
        *(_DWORD *)(nHeight + 16) = -1024;
      }
      break;
    case 0x19:
      *(_DWORD *)(nHeight + 4) += *(_DWORD *)(nHeight + 12);
      if ( *(_DWORD *)(nHeight + 4) > 106496 )
        *(_DWORD *)(nHeight + 12) -= 42;
      if ( *(_DWORD *)(nHeight + 12) < 0 )
      {
        *(_DWORD *)(nHeight + 12) = 0;
        *(_DWORD *)(nHeight + 44) = 30;
        *(_DWORD *)(nHeight + 16) = -1024;
      }
      break;
    case 0x1E:
      *(_DWORD *)(nHeight + 8) += *(_DWORD *)(nHeight + 16);
      if ( *(_DWORD *)(nHeight + 8) < 24576 )
        *(_DWORD *)(nHeight + 16) += 42;
      if ( *(_DWORD *)(nHeight + 16) > 0 )
      {
        *(_DWORD *)(nHeight + 16) = 0;
        if ( *(_DWORD *)(nHeight + 4) <= 61440 )
        {
          *(_DWORD *)(nHeight + 44) = 40;
          *(_DWORD *)(nHeight + 12) = 512;
        }
        else
        {
          *(_DWORD *)(nHeight + 44) = 40;
          *(_DWORD *)(nHeight + 12) = -512;
        }
      }
      break;
    case 0x28:
      *(_DWORD *)(nHeight + 4) += *(_DWORD *)(nHeight + 12);
      if ( *(_DWORD *)(nHeight + 4) < -16384 || *(_DWORD *)(nHeight + 4) > 139264 )
        *(_DWORD *)nHeight = 0;
      break;
    default:
      break;
  }
  v5 = *(_DWORD *)(nHeight + 88);
  if ( v5 )
  {
    if ( v5 == 1 && ++*(_DWORD *)(nHeight + 48) > 16 )
    {
      *(_DWORD *)(nHeight + 88) = 0;
      *(_DWORD *)(nHeight + 84) = *(_DWORD *)(nHeight + 60) - 18;
      v30 = GetArktan(*(_DWORD *)(nHeight + 4) - (_DWORD)ShipX, *(_DWORD *)(nHeight + 8) - ShipY, 64);
      CreateEntity(13, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), v30);
      PlaySound(7);
    }
  }
  else if ( *(_DWORD *)(nHeight + 60) < *(_DWORD *)(nHeight + 84) )
  {
    *(_DWORD *)(nHeight + 48) = 0;
    *(_DWORD *)(nHeight + 88) = 1;
    CreateCaret(1, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), nHeight);
    PlaySound(30);
  }
  if ( *(_DWORD *)(nHeight + 72) / 2 % 2 )
  {
    v1 = nHeight + 104;
    *(_DWORD *)v1 = v26;
    *(_DWORD *)(v1 + 4) = v27;
    result = v28;
    *(_DWORD *)(v1 + 8) = v28;
    *(_DWORD *)(v1 + 12) = v29;
  }
  else if ( *(_DWORD *)(nHeight + 88) == 1 )
  {
    result = nHeight + 104;
    *(_DWORD *)result = v6;
    *(_DWORD *)(result + 4) = v7;
    *(_DWORD *)(result + 8) = v8;
    *(_DWORD *)(result + 12) = v9;
  }
  else
  {
    v3 = *(_DWORD *)(nHeight + 60) - *(_DWORD *)(nHeight + 84);
    LODWORD(v3) = &v6 + 4 * (4 - (((BYTE4(v3) & 3) + (signed int)v3) >> 2));
    v4 = nHeight + 104;
    *(_DWORD *)v4 = *(_DWORD *)v3;
    *(_DWORD *)(v4 + 4) = *(_DWORD *)(v3 + 4);
    *(_DWORD *)(v4 + 8) = *(_DWORD *)(v3 + 8);
    result = *(_DWORD *)(v3 + 12);
    *(_DWORD *)(v4 + 12) = result;
  }
  return result;
}


int ActNpc031_Sodi(int a1)
{
  int result; 
  int *v2; 
  int v3; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  unsigned __int8 v12; 

  v4 = 0;
  v5 = 112;
  v6 = 24;
  v7 = 136;
  v8 = 24;
  v9 = 112;
  v10 = 48;
  v11 = 136;
  result = a1;
  switch ( *(_DWORD *)(a1 + 44) )
  {
    case 0:
      *(_DWORD *)(a1 + 44) = 10;
      *(_DWORD *)(a1 + 16) = 1024;
      goto LABEL_3;
    case 0xA:
LABEL_3:
      if ( ++*(_DWORD *)(a1 + 48) > 60 || *(_DWORD *)(a1 + 72) )
      {
        *(_DWORD *)(a1 + 44) = 20;
        *(_DWORD *)(a1 + 48) = 0;
      }
      goto LABEL_14;
    case 0x14:
      *(_DWORD *)(a1 + 16) -= 64;
      if ( *(_DWORD *)(a1 + 16) <= 0 )
      {
        *(_DWORD *)(a1 + 44) = 30;
        *(_DWORD *)(a1 + 16) = 0;
        CreateCaret(1, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), a1);
        PlaySound(30);
      }
      goto LABEL_14;
    case 0x1E:
      ++*(_DWORD *)(a1 + 48);
      result = a1;
      if ( *(_DWORD *)(a1 + 48) == 16 )
      {
        *(_DWORD *)(a1 + 44) = 40;
        *(_DWORD *)(a1 + 16) = -2048;
        *(_DWORD *)(a1 + 68) &= 0xFFFFFFBF;
        *(_DWORD *)(a1 + 52) = 1;
        v12 = GetArktan(*(_DWORD *)(a1 + 4) - (_DWORD)ShipX, *(_DWORD *)(a1 + 8) - ShipY, 64);
        CreateEntity(13, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), v12);
        result = PlaySound(7);
      }
      goto LABEL_12;
    case 0x28:
LABEL_12:
      if ( *(_DWORD *)(a1 + 8) >= -16384 )
        goto LABEL_14;
      *(_DWORD *)a1 = 0;
      break;
    default:
LABEL_14:
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      v2 = &v4 + 4 * *(_DWORD *)(a1 + 52);
      v3 = a1 + 104;
      *(_DWORD *)v3 = *v2;
      *(_DWORD *)(v3 + 4) = v2[1];
      *(_DWORD *)(v3 + 8) = v2[2];
      *(_DWORD *)(v3 + 12) = v2[3];
      result = *(_DWORD *)(a1 + 72) / 2 % 2;
      if ( result )
      {
        *(_DWORD *)(a1 + 108) += 24;
        result = *(_DWORD *)(a1 + 116) + 24;
        *(_DWORD *)(a1 + 116) = result;
      }
      break;
  }
  return result;
}


int ActNpc032_Boss2(int a1)
{
  signed int v1; 
  int v2; 
  __int16 v3; 
  int v4; 
  __int16 v5; 
  int result; 
  int v7; 
  int v8; 
  signed int i; 
  signed int v10; 
  signed int v11; 

  if ( *(_DWORD *)(a1 + 44) < 100 && *(_DWORD *)(a1 + 92) == 3 )
  {
    *(_DWORD *)(a1 + 44) = 100;
    *(_DWORD *)(a1 + 68) &= 0xFFFFFFFD;
    SetShipInvincibility();
  }
  switch ( *(_DWORD *)(a1 + 44) )
  {
    case 0:
      *(_DWORD *)(a1 + 44) = 10;
      *(_DWORD *)(a1 + 16) = 512;
      *(_DWORD *)(a1 + 8) = -65536;
      CreateEntity(36, 0, 0, a1);
      CreateEntity(36, 0, 0, a1);
      CreateEntity(34, 0, 0, a1);
      CreateEntity(33, 0, 0, a1);
      CreateEntity(33, 0, 0, a1);
      goto LABEL_6;
    case 0xA:
LABEL_6:
      if ( *(_DWORD *)(a1 + 8) > 0x10000 )
      {
        *(_DWORD *)(a1 + 16) -= 2;
        if ( *(_DWORD *)(a1 + 16) < 0 )
        {
          *(_DWORD *)(a1 + 16) = 0;
          *(_DWORD *)(a1 + 44) = 11;
        }
      }
      goto LABEL_50;
    case 0xB:
      if ( ++*(_DWORD *)(a1 + 48) > 40 )
      {
        *(_DWORD *)(a1 + 44) = 20;
        *(_DWORD *)(a1 + 16) = -512;
      }
      goto LABEL_50;
    case 0x14:
      v10 = 0;
      if ( ShipY >= 81920 )
      {
        if ( *(_DWORD *)(a1 + 8) < 40960 )
          v10 = 1;
      }
      else if ( *(_DWORD *)(a1 + 8) < 81920 )
      {
        v10 = 1;
      }
      if ( v10 )
      {
        *(_DWORD *)(a1 + 16) += 4;
        if ( *(_DWORD *)(a1 + 16) > 0 )
        {
          *(_DWORD *)(a1 + 16) = 0;
          *(_DWORD *)(a1 + 44) = 21;
        }
      }
      goto LABEL_50;
    case 0x15:
      if ( ++*(_DWORD *)(a1 + 48) > 40 )
      {
        *(_DWORD *)(a1 + 48) = 0;
        *(_DWORD *)(a1 + 44) = 30;
        *(_DWORD *)(a1 + 16) = 512;
      }
      goto LABEL_50;
    case 0x1E:
      v11 = 0;
      if ( ShipY >= 81920 )
      {
        if ( *(_DWORD *)(a1 + 8) > 73728 )
          v11 = 1;
      }
      else if ( *(_DWORD *)(a1 + 8) > 118784 )
      {
        v11 = 1;
      }
      if ( v11 )
      {
        *(_DWORD *)(a1 + 16) -= 4;
        if ( *(_DWORD *)(a1 + 16) < 0 )
        {
          *(_DWORD *)(a1 + 16) = 0;
          *(_DWORD *)(a1 + 44) = 31;
        }
      }
      goto LABEL_50;
    case 0x1F:
      if ( ++*(_DWORD *)(a1 + 48) > 40 )
      {
        *(_DWORD *)(a1 + 48) = 0;
        *(_DWORD *)(a1 + 44) = 20;
        *(_DWORD *)(a1 + 16) = -512;
      }
      goto LABEL_50;
    case 0x64:
      *(_DWORD *)(a1 + 44) = 110;
      *(_DWORD *)(a1 + 48) = 0;
      *(_DWORD *)(a1 + 12) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      PlayLoopSound(32);
      goto LABEL_40;
    case 0x6E:
LABEL_40:
      v1 = (*(_DWORD *)(a1 + 48))++;
      if ( v1 < 60 )
        goto LABEL_50;
      *(_DWORD *)(a1 + 12) = 0;
      *(_DWORD *)(a1 + 16) = 341;
      *(_DWORD *)(a1 + 44) = 120;
      *(_DWORD *)(a1 + 48) = -2;
      PlaySound(12);
      if ( !(ShipCond & 2) )
      {
        AddScore(*(_DWORD *)(a1 + 76));
        CreateCaret(0, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8) - 0x2000, *(_DWORD *)(a1 + 76));
        SetShipInvincibility();
      }
      for ( i = 0; i < 15; ++i )
      {
        v2 = *(_DWORD *)(a1 + 8) + (((unsigned __int16)GetRandom(48) - 20) << 10);
        v3 = GetRandom(48);
        CreateEntity(1, *(_DWORD *)(a1 + 4) + (((unsigned __int16)v3 - 24) << 10), v2, 0);
      }
      goto LABEL_46;
    case 0x78:
LABEL_46:
      if ( ++*(_DWORD *)(a1 + 48) > 5 )
      {
        *(_DWORD *)(a1 + 48) = (unsigned __int16)GetRandom(4);
        v4 = *(_DWORD *)(a1 + 8) + (((unsigned __int16)GetRandom(64) - 32) << 10);
        v5 = GetRandom(64);
        CreateEntity(1, *(_DWORD *)(a1 + 4) + (((unsigned __int16)v5 - 32) << 10), v4, 0);
      }
      if ( *(_DWORD *)(a1 + 8) <= 221184 )
        goto LABEL_50;
      *(_DWORD *)a1 = 0;
      CheckStageClear(2);
      result = StopLoopSound(32);
      break;
    default:
LABEL_50:
      if ( *(_DWORD *)(a1 + 92) > 0 && *(_DWORD *)(a1 + 44) >= 20 && *(_DWORD *)(a1 + 44) < 40 )
      {
        v8 = *(_DWORD *)(a1 + 84);
        if ( v8 )
        {
          if ( v8 == 1 )
          {
            *(_DWORD *)(a1 + 12) += 2;
            if ( *(_DWORD *)(a1 + 12) > 256 )
              *(_DWORD *)(a1 + 12) = 256;
            if ( *(_DWORD *)(a1 + 4) > 90112 )
              *(_DWORD *)(a1 + 84) = 0;
          }
        }
        else
        {
          *(_DWORD *)(a1 + 12) -= 2;
          if ( *(_DWORD *)(a1 + 12) < -256 )
            *(_DWORD *)(a1 + 12) = -256;
          if ( *(_DWORD *)(a1 + 4) < 0x8000 )
            *(_DWORD *)(a1 + 84) = 1;
        }
      }
      *(_DWORD *)(a1 + 4) += *(_DWORD *)(a1 + 12);
      *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
      v7 = a1 + 104;
      *(_DWORD *)v7 = 80;
      *(_DWORD *)(v7 + 4) = 48;
      *(_DWORD *)(v7 + 8) = 136;
      *(_DWORD *)(v7 + 12) = 96;
      result = *(_DWORD *)(a1 + 72) / 2 % 2;
      if ( result )
      {
        *(_DWORD *)(a1 + 108) += 48;
        result = a1;
        *(_DWORD *)(a1 + 116) += 48;
      }
      break;
  }
  return result;
}


NPCHAR *ActNpc033_Boss2RocketSpawner(NPCHAR *o)
{
  char *v1; 
  char *v2; 
  NPCHAR *result; 
  int v4; 
  HBITMAP hBitmap; 
  NPCHAR *v6; 

  v6 = (NPCHAR *)o->type2;
  v4 = o->state;
  if ( v4 )
  {
    if ( v4 != 10 )
      goto LABEL_9;
  }
  else
  {
    o->child = dword_44C268;
    dword_44C268 = (dword_44C268 + 1) % 2;
    if ( o->child )
      o->rot1 = -100;
    o->state = 10;
  }
  if ( v6->state >= 40 )
    o->state = 20;
LABEL_9:
  if ( o->child )
  {
    o->x = v6->x + 0x8000;
    v2 = (char *)&o->rect;
    *(_DWORD *)v2 = 40;
    *((_DWORD *)v2 + 1) = 0;
    *((_DWORD *)v2 + 2) = 80;
    *((_DWORD *)v2 + 3) = 104;
  }
  else
  {
    o->x = v6->x - 0x8000;
    v1 = (char *)&o->rect;
    *(_DWORD *)v1 = 0;
    *((_DWORD *)v1 + 1) = 0;
    *((_DWORD *)v1 + 2) = 40;
    *((_DWORD *)v1 + 3) = 104;
  }
  o->y = v6->y + 0x2000;
  if ( v6->state < 100 )
    ++o->rot1;
  if ( o->rot1 >= 200 )
  {
    o->rot1 = 0;
    if ( o->child )
      hBitmap = (HBITMAP)(o->x + 1024);
    else
      hBitmap = (HBITMAP)o->x;
    if ( ShipY <= o->y )
    {
      CreateEntity(35, (int)hBitmap, o->y - 3072, 3);
      CreateEntity(35, (int)hBitmap, o->y - 3072, 4);
      CreateEntity(35, (int)hBitmap, o->y - 3072, 5);
    }
    else
    {
      CreateEntity(35, (int)hBitmap, o->y - 3072, 0);
      CreateEntity(35, (int)hBitmap, o->y - 3072, 1);
      CreateEntity(35, (int)hBitmap, o->y - 3072, 2);
    }
    CreateCaret(1, (int)hBitmap, o->y - 3072, (int)o);
    PlaySound(36);
  }
  result = v6;
  if ( !(v6->cond & 1) || v6->type != 32 )
  {
    result = o;
    o->cond = 0;
  }
  return result;
}



int ActNpc034_B2ExplosionSpawner_(NPCHAR *a1)
{
  int v1; 
  __int16 v2; 
  int *v3; 
  char *v4; 
  int result; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  NPCHAR *v18; 

  v6 = 80;
  v7 = 96;
  v8 = 120;
  v9 = 144;
  v10 = 120;
  v11 = 96;
  v12 = 160;
  v13 = 144;
  v14 = 0;
  v15 = 0;
  v16 = 0;
  v17 = 0;
  v18 = (NPCHAR *)a1->type2;
  switch ( a1->state )
  {
    case 0:
      if ( v18->state >= 20 )
      {
        a1->flag &= 0xFFFFFFF7;
        a1->flag |= 1u;
        a1->state = 20;
        a1->count2 = 1;
        PlaySound(38);
      }
      goto LABEL_4;
    case 0x14:
LABEL_4:
      if ( a1->life < 872 )
      {
        a1->state = 30;
        a1->count1 = 0;
        a1->flag &= 0xFFFFFFFC;
      }
      break;
    case 0x1E:
      if ( !(a1->count1 % 10) )
      {
        v1 = a1->y + (((unsigned __int16)GetRandom(48) - 32) << 10);
        v2 = GetRandom(32);
        CreateEntity(1, a1->x + (((unsigned __int16)v2 - 16) << 10), v1, 0);
        PlaySound(26);
      }
      if ( ++a1->count1 > 50 )
      {
        a1->state = 40;
        a1->count2 = 2;
        a1->shock = 0;
        CreateEntity(1, a1->x + 4096, a1->y - 0x4000, 0);
        CreateEntity(1, a1->x - 0x2000, a1->y, 0);
        CreateEntity(1, a1->x + 12288, a1->y + 0x2000, 0);
        PlaySound(11);
        v18->count4 = 1;
        ClearReplaceNpChar(6, 0);
      }
      goto LABEL_11;
    case 0x28:
LABEL_11:
      if ( v18->state == 120 )
      {
        a1->state = 100;
        a1->count2 = 2;
        a1->xoff = 0x2000;
        a1->yoff = 4096;
      }
      break;
    default:
      break;
  }
  a1->x = v18->x;
  a1->y = v18->y - 6144;
  v3 = &v6 + 4 * a1->count2;
  v4 = (char *)&a1->rect;
  *(_DWORD *)v4 = *v3;
  *((_DWORD *)v4 + 1) = v3[1];
  *((_DWORD *)v4 + 2) = v3[2];
  *((_DWORD *)v4 + 3) = v3[3];
  if ( a1->shock / 2 % 2 )
  {
    a1->rect.left += 40;
    a1->rect.right += 40;
  }
  result = v18->cond & 1;
  if ( !result || v18->type != 32 )
    a1->cond = 0;
  return result;
}


int ActNpc035_B2Rocket(NPCHAR *a1)
{
  int *v1; 
  char *v2; 
  int result; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 
  int v23; 
  int v24; 
  int v25; 
  int v26; 
  int v27; 

  v4 = 152;
  v5 = 64;
  v6 = 168;
  v7 = 80;
  v8 = 168;
  v9 = 64;
  v10 = 184;
  v11 = 80;
  v12 = 184;
  v13 = 64;
  v14 = 200;
  v15 = 80;
  v16 = 200;
  v17 = 64;
  v18 = 216;
  v19 = 80;
  v20 = 216;
  v21 = 64;
  v22 = 232;
  v23 = 80;
  v24 = 232;
  v25 = 64;
  v26 = 248;
  v27 = 80;
  switch ( a1->state )
  {
    case 0:
      a1->state = 10;
      switch ( a1->type2 )
      {
        case 0:
        case 1:
        case 2:
          a1->ym = -2048;
          break;
        case 3:
        case 4:
        case 5:
          a1->count2 = 3;
          a1->ym = 2048;
          break;
        default:
          goto LABEL_5;
      }
      goto LABEL_5;
    case 0xA:
LABEL_5:
      if ( a1->y < 0 || a1->y >= 163840 )
      {
        a1->state = 20;
        switch ( a1->type2 )
        {
          case 0:
            a1->count2 = 3;
            a1->ym = 1024;
            break;
          case 1:
            a1->count2 = 4;
            a1->ym = 716;
            a1->xm = -1024;
            break;
          case 2:
            a1->count2 = 5;
            a1->ym = 716;
            a1->xm = 1024;
            break;
          case 3:
            a1->count2 = 0;
            a1->ym = -1024;
            break;
          case 4:
            a1->count2 = 1;
            a1->ym = -716;
            a1->xm = -1024;
            break;
          case 5:
            a1->count2 = 2;
            a1->ym = -716;
            a1->xm = 1024;
            break;
          default:
            break;
        }
        if ( !a1->type2 || a1->type2 == 3 )
        {
          CreateCaret(1, a1->x, a1->y, (int)a1);
          PlaySound(12);
        }
      }
      break;
    case 0x14:
      if ( ++a1->count1 > 30 )
      {
        a1->count1 = 0;
        a1->state = 30;
        switch ( a1->type2 )
        {
          case 0:
          case 1:
          case 2:
            a1->count2 = 3;
            a1->ym = 1024;
            break;
          case 3:
          case 4:
          case 5:
            a1->count2 = 0;
            a1->ym = -1024;
            break;
          default:
            break;
        }
        a1->xm = 0;
      }
      break;
    case 0x1E:
      if ( !(++a1->count1 % 3) )
      {
        switch ( a1->type2 )
        {
          case 0:
          case 1:
          case 2:
            CreateEntity(29, a1->x, a1->y - 0x2000, 1);
            break;
          case 3:
          case 4:
          case 5:
            CreateEntity(29, a1->x, a1->y + 0x2000, 0);
            break;
          default:
            goto LABEL_28;
        }
      }
      break;
    default:
      break;
  }
LABEL_28:
  switch ( a1->type2 )
  {
    case 0:
    case 1:
    case 2:
      if ( a1->y > 180224 )
        a1->cond = 0;
      break;
    case 3:
    case 4:
    case 5:
      if ( a1->y < -16384 )
        a1->cond = 0;
      break;
    default:
      break;
  }
  if ( a1->x < -1024 || a1->x > 123904 )
    a1->cond = 0;
  a1->x += a1->xm;
  a1->y += a1->ym;
  v1 = &v4 + 4 * a1->count2;
  v2 = (char *)&a1->rect;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  *((_DWORD *)v2 + 2) = v1[2];
  result = v1[3];
  *((_DWORD *)v2 + 3) = result;
  if ( a1->state != 30 )
  {
    result = a1->count3++ / 2 % 2;
    if ( result )
    {
      a1->rect.top += 16;
      result = a1->rect.bottom + 16;
      a1->rect.bottom = result;
    }
  }
  return result;
}


int ActNpc036_Boss2Eye(NPCHAR *a1)
{
  int *v1; 
  char *v2; 
  int result; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  NPCHAR *v13; 
  unsigned __int8 v14; 

  v5 = 136;
  v6 = 48;
  v7 = 152;
  v8 = 64;
  v9 = 0;
  v10 = 0;
  v11 = 0;
  v12 = 0;
  v13 = (NPCHAR *)a1->type2;
  if ( a1->state >= 30 && a1->state < 40 && a1->life < 918 )
  {
    a1->state = 100;
    a1->count2 = 1;
    a1->shock = 0;
    a1->flag &= 0xFFFFFFFC;
    CreateEntity(1, a1->x, a1->y, 0);
    PlaySound(12);
    ++v13->count4;
  }
  switch ( a1->state )
  {
    case 0:
      a1->child = byte_44C26C;
      byte_44C26C = (byte_44C26C + 1) % 2;
      if ( a1->child )
        a1->count1 = -50;
      else
        a1->count1 = -100;
      a1->state = 10;
      goto LABEL_10;
    case 0xA:
LABEL_10:
      if ( v13->state >= 20 )
        a1->state = 20;
      break;
    case 0x14:
      if ( ++a1->count1 >= 80 )
      {
        a1->count1 = 0;
        a1->state = 21;
        CreateCaret(1, a1->x, a1->y, (int)a1);
        PlaySound(30);
      }
      if ( v13->count4 )
        a1->state = 29;
      break;
    case 0x15:
      if ( ++a1->count1 >= 20 )
      {
        v14 = GetArktan(a1->x - (_DWORD)ShipX, a1->y - ShipY, 64);
        CreateEntity(13, a1->x, a1->y, v14);
        PlaySound(7);
        a1->count1 = 0;
        a1->state = 20;
      }
      if ( v13->count4 )
        a1->state = 29;
      break;
    case 0x1D:
      a1->state = 30;
      a1->count1 = 0;
      a1->flag |= 3u;
      if ( a1->child )
        a1->count1 = 25;
      goto LABEL_25;
    case 0x1E:
LABEL_25:
      if ( ++a1->count1 >= 30 )
      {
        a1->count1 = 0;
        a1->state = 31;
        CreateCaret(1, a1->x, a1->y, (int)a1);
        PlaySound(30);
      }
      break;
    case 0x1F:
      if ( ++a1->count1 >= 20 )
      {
        v14 = GetArktan(a1->x - (_DWORD)ShipX, a1->y - ShipY, 64);
        if ( v13->count4 >= 2 )
        {
          v14 += 8;
          CreateEntity(13, a1->x, a1->y, v14);
          v14 -= 16;
          CreateEntity(13, a1->x, a1->y, v14);
        }
        else
        {
          CreateEntity(13, a1->x, a1->y, v14);
        }
        PlaySound(7);
        if ( ++a1->rot1 < 4 )
        {
          a1->count1 = 0;
        }
        else
        {
          a1->rot1 = 0;
          if ( v13->count4 >= 2 )
            a1->count1 = -100;
          else
            a1->count1 = -200;
        }
        a1->state = 30;
      }
      break;
    case 0x64:
      if ( v13->state != 120 )
        break;
      a1->state = 110;
      a1->life = 100;
      a1->flag |= 1u;
      a1->destroyHitVoice = 4;
      a1->w = 6144;
      a1->h = 6144;
      goto LABEL_42;
    case 0x6E:
LABEL_42:
      if ( a1->life <= 52 )
      {
        a1->state = 120;
        CreateEntity(7, a1->x, a1->y, 2);
        a1->flag &= 0xFFFFFFFE;
        PlaySound(11);
        CreateEntity(1, a1->x, a1->y, 0);
      }
      break;
    default:
      break;
  }
  v4 = a1->child;
  if ( v4 )
  {
    if ( v4 == 1 )
    {
      a1->x = v13->x + 3072;
      a1->y = v13->y - 11264;
    }
  }
  else
  {
    a1->x = v13->x - 2048;
    a1->y = v13->y + 6144;
  }
  v1 = &v5 + 4 * a1->count2;
  v2 = (char *)&a1->rect;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  *((_DWORD *)v2 + 2) = v1[2];
  *((_DWORD *)v2 + 3) = v1[3];
  result = a1->shock / 2 % 2;
  if ( result )
  {
    a1->rect.top += 16;
    result = a1->rect.bottom + 16;
    a1->rect.bottom = result;
  }
  return result;
}



int ActNpc037_Stars_(NPCHAR *a1)
{
  int *v1; 
  char *v2; 
  int result; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 

  v4 = 0;
  v5 = 64;
  v6 = 16;
  v7 = 80;
  v8 = 16;
  v9 = 64;
  v10 = 32;
  v11 = 80;
  v12 = 32;
  v13 = 64;
  v14 = 48;
  v15 = 80;
  a1->y += 256;
  if ( a1->y > 180224 )
    a1->cond = 0;
  v1 = &v4 + 4 * a1->type2;
  v2 = (char *)&a1->rect;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  result = v1[2];
  *((_DWORD *)v2 + 2) = result;
  *((_DWORD *)v2 + 3) = v1[3];
  return result;
}


NPCHAR *ActNpc038_StarGen(NPCHAR *a1)
{
  NPCHAR *result; 
  __int16 v2; 
  signed int type2; 

  ++a1->count1;
  result = a1;
  if ( a1->count1 > 30 )
  {
    a1->count1 = 0;
    result = (NPCHAR *)(a1->state + 1);
    a1->state = (int)result;
    if ( a1->state > 9 )
    {
      result = a1;
      a1->state = 0;
    }
  }
  if ( !a1->count1 )
  {
    result = (NPCHAR *)a1->state;
    switch ( a1->state )
    {
      case 0:
        type2 = 1;
        break;
      case 1:
        type2 = 2;
        break;
      case 2:
        type2 = 0;
        break;
      case 3:
        type2 = 1;
        break;
      case 4:
        type2 = 0;
        break;
      case 7:
        type2 = 2;
        break;
      default:
        type2 = 4;
        break;
    }
    if ( type2 != 4 )
    {
      v2 = GetRandom(120);
      result = (NPCHAR *)CreateEntity(37, (unsigned __int16)v2 << 10, -16384, type2);
    }
  }
  return result;
}


_DWORD *ActNpc039_Elka2(NPCHAR *a1)
{
  _DWORD *result; 
  char *v2; 
  char *v3; 
  int *v4; 
  char *v5; 
  int v6; 
  signed int i; 
  int x; 
  int y; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 
  int v23; 
  int v24; 
  int v25; 
  int v26; 
  int v27; 
  int v28; 
  int v29; 
  int v30; 
  int v31; 
  int v32; 
  int v33; 

  v10 = 0;
  v11 = 0;
  v12 = 32;
  v13 = 32;
  v14 = 32;
  v15 = 0;
  v16 = 64;
  v17 = 32;
  v18 = 64;
  v19 = 0;
  v20 = 96;
  v21 = 32;
  v22 = 96;
  v23 = 0;
  v24 = 128;
  v25 = 32;
  v26 = 128;
  v27 = 0;
  v28 = 160;
  v29 = 32;
  v30 = 160;
  v31 = 0;
  v32 = 192;
  v33 = 32;
  if ( a1->state < 100 && a1->life <= 50 )
  {
    a1->state = 100;
    a1->count1 = 0;
    a1->shock = 0;
    a1->flag &= 0xFFFFFFFE;
    a1->flag |= 2u;
    CreateCaret(4, a1->x, a1->y, (int)a1);
    PlaySound(30);
  }
  v6 = a1->state;
  if ( !v6 )
  {
    a1->state = 10;
    a1->child = a1->life - 24;
    a1->flag |= 3u;
    a1->y -= 0x2000;
LABEL_9:
    if ( a1->shock )
    {
      y = a1->y;
      SubStageXOScroll(0, &y);
      if ( y >= ShipY )
        a1->y += 256;
      else
        a1->y -= 256;
    }
    goto LABEL_19;
  }
  if ( v6 == 10 )
    goto LABEL_9;
  if ( v6 == 100 && ++a1->count1 >= 14 )
  {
    x = a1->x;
    y = a1->y;
    SubStageXOScroll(&x, &y);
    for ( i = 0; i < 8; ++i )
      CreateEntity(14, x, y, (unsigned __int8)(32 * i));
    PlaySound(13);
    CreateEntity(1, x, y, 0);
    AddScore(a1->score);
    result = (_DWORD *)CreateCaret(0, x, y, a1->score);
    a1->cond = 0;
    return result;
  }
LABEL_19:
  if ( a1->state < 100 )
  {
    if ( a1->shock / 2 % 2 )
    {
      v3 = (char *)&a1->rect;
      *(_DWORD *)v3 = v30;
      *((_DWORD *)v3 + 1) = v31;
      *((_DWORD *)v3 + 2) = v32;
      *((_DWORD *)v3 + 3) = v33;
    }
    else
    {
      v4 = &v10 + 4 * ((100 - a1->life) / 10);
      v5 = (char *)&a1->rect;
      *(_DWORD *)v5 = *v4;
      *((_DWORD *)v5 + 1) = v4[1];
      *((_DWORD *)v5 + 2) = v4[2];
      *((_DWORD *)v5 + 3) = v4[3];
    }
  }
  else
  {
    v2 = (char *)&a1->rect;
    *(_DWORD *)v2 = v10;
    *((_DWORD *)v2 + 1) = v11;
    *((_DWORD *)v2 + 2) = v12;
    *((_DWORD *)v2 + 3) = v13;
  }
  y = a1->y;
  result = SubStageXOScroll(0, &y);
  if ( y >= 180224 )
  {
    result = a1;
    a1->cond = 0;
  }
  return result;
}


signed int ActNpc040_GuxtFort(int a1)
{
  int v1; 
  signed int result; 
  char *v3; 
  int v4; 
  int v5; 
  int x; 
  int y; 

  x = *(_DWORD *)(a1 + 4);
  y = *(_DWORD *)(a1 + 8);
  SubStageXOScroll(&x, &y);
  v5 = *(_DWORD *)(a1 + 44);
  if ( v5 )
  {
    if ( v5 != 10 )
    {
      if ( v5 == 11 )
      {
        if ( !(++*(_DWORD *)(a1 + 48) % 7) )
        {
          CreateEntity(13, x, y, *(_BYTE *)(a1 + 84));
          PlaySound(7);
        }
        if ( *(_DWORD *)(a1 + 48) == 21 )
        {
          *(_DWORD *)(a1 + 48) = -150;
          *(_DWORD *)(a1 + 44) = 10;
        }
      }
      goto LABEL_15;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 44) = 10;
    *(_DWORD *)(a1 + 68) |= 1u;
  }
  if ( ++*(_DWORD *)(a1 + 48) == 50 )
  {
    CreateCaret(1, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), a1);
    PlaySound(30);
  }
  if ( *(_DWORD *)(a1 + 48) == 66 )
  {
    *(_DWORD *)(a1 + 48) = 0;
    *(_DWORD *)(a1 + 44) = 11;
    *(_DWORD *)(a1 + 84) = (unsigned __int8)GetArktan(x - (_DWORD)ShipX, y - ShipY, 64);
  }
LABEL_15:
  if ( ++*(_DWORD *)(a1 + 56) > 4 )
  {
    *(_DWORD *)(a1 + 56) = 0;
    if ( ++*(_DWORD *)(a1 + 52) > 2 )
      *(_DWORD *)(a1 + 52) = 0;
  }
  if ( *(_DWORD *)(a1 + 72) / 2 % 2 )
  {
    v1 = a1 + 104;
    *(_DWORD *)v1 = 128;
    *(_DWORD *)(v1 + 4) = 96;
    result = 144;
    *(_DWORD *)(v1 + 8) = 144;
    *(_DWORD *)(v1 + 12) = 112;
  }
  else
  {
    v3 = (char *)&unk_43B5B0 + 16 * *(_DWORD *)(a1 + 52);
    v4 = a1 + 104;
    *(_DWORD *)v4 = *(_DWORD *)v3;
    *(_DWORD *)(v4 + 4) = *((_DWORD *)v3 + 1);
    *(_DWORD *)(v4 + 8) = *((_DWORD *)v3 + 2);
    result = *((_DWORD *)v3 + 3);
    *(_DWORD *)(v4 + 12) = result;
  }
  if ( y > 180224 )
    *(_DWORD *)a1 = 0;
  return result;
}


NPCHAR *ActNpc041_CatEye(NPCHAR *a1)
{
  char v1; 
  char *v2; 
  int *v3; 
  char *v4; 
  NPCHAR *result; 
  int x; 
  int y; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 
  int v23; 
  int v24; 
  int v25; 
  int v26; 
  int v27; 
  char v28; 
  int v29; 

  v8 = 0;
  v9 = 80;
  v10 = 16;
  v11 = 96;
  v12 = 16;
  v13 = 80;
  v14 = 32;
  v15 = 96;
  v16 = 32;
  v17 = 80;
  v18 = 48;
  v19 = 96;
  v20 = 48;
  v21 = 80;
  v22 = 64;
  v23 = 96;
  v24 = 64;
  v25 = 80;
  v26 = 80;
  v27 = 96;
  x = a1->x;
  y = a1->y;
  SubStageXOScroll(&x, &y);
  switch ( a1->state )
  {
    case 0:
      a1->state = 10;
      a1->count1 = 50 * a1->type2;
      goto LABEL_3;
    case 0xA:
LABEL_3:
      if ( !--a1->count1 )
      {
        a1->state = 20;
        PlaySound(38);
      }
      break;
    case 0x14:
      if ( ++a1->count3 > 2 )
      {
        a1->count3 = 0;
        ++a1->count2;
      }
      if ( a1->count2 == 3 )
      {
        a1->state = 30;
        a1->count1 = 0;
        CreateCaret(1, a1->x, a1->y, (int)a1);
        PlaySound(30);
        a1->flag |= 1u;
      }
      break;
    case 0x1E:
      if ( ++a1->count1 > 14 )
      {
        a1->state = 40;
        v1 = GetArktan(x - (_DWORD)ShipX, y - ShipY, 64);
        CreateEntity(14, x, y, (unsigned __int8)v1);
        PlaySound(7);
      }
      break;
    default:
      break;
  }
  if ( a1->shock / 2 % 2 )
  {
    v2 = (char *)&a1->rect;
    *(_DWORD *)v2 = v24;
    *((_DWORD *)v2 + 1) = v25;
    *((_DWORD *)v2 + 2) = v26;
    *((_DWORD *)v2 + 3) = v27;
  }
  else
  {
    v3 = &v8 + 4 * a1->count2;
    v4 = (char *)&a1->rect;
    *(_DWORD *)v4 = *v3;
    *((_DWORD *)v4 + 1) = v3[1];
    *((_DWORD *)v4 + 2) = v3[2];
    *((_DWORD *)v4 + 3) = v3[3];
  }
  AlignStageScroll((NPCHAR *)&v28);
  result = a1;
  if ( a1->y > v29 + 0x2000 )
    a1->cond = 0;
  return result;
}


int ActNpc042_Slider(int a1)
{
  int result; 
  int *v2; 
  int v3; 
  int x; 
  int y; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  unsigned __int8 v18; 

  v6 = 0;
  v7 = 32;
  v8 = 32;
  v9 = 48;
  v10 = 32;
  v11 = 32;
  v12 = 64;
  v13 = 48;
  v14 = 64;
  v15 = 32;
  v16 = 96;
  v17 = 48;
  x = *(_DWORD *)(a1 + 4);
  y = *(_DWORD *)(a1 + 8);
  SubStageXOScroll(&x, &y);
  v3 = *(_DWORD *)(a1 + 44);
  if ( v3 )
  {
    if ( v3 != 10 )
    {
      if ( v3 == 20 )
      {
        *(_DWORD *)(a1 + 12) = 0;
        if ( ++*(_DWORD *)(a1 + 48) == 20 )
        {
          CreateCaret(1, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), a1);
          PlaySound(30);
        }
        if ( *(_DWORD *)(a1 + 48) == 30 )
        {
          *(_DWORD *)(a1 + 48) = 0;
          v18 = 64;
          if ( ShipY < y )
            v18 += -128;
          CreateEntity(13, x, y, v18);
          PlaySound(7);
        }
      }
      goto LABEL_15;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 44) = 10;
    *(_DWORD *)(a1 + 68) |= 0x40u;
  }
  *(_DWORD *)(a1 + 12) = 0;
  *(_DWORD *)(a1 + 52) = 0;
  if ( ShipY - y < 81920 )
  {
    *(_DWORD *)(a1 + 44) = 20;
    *(_DWORD *)(a1 + 48) = 0;
    *(_DWORD *)(a1 + 52) = 1;
    *(_DWORD *)(a1 + 68) |= 3u;
    PlaySound(38);
  }
LABEL_15:
  if ( x < (signed int)(ShipX - 256) )
    *(_DWORD *)(a1 + 12) = 256;
  if ( x > (signed int)(ShipX + 256) )
    *(_DWORD *)(a1 + 12) = -256;
  *(_DWORD *)(a1 + 4) += *(_DWORD *)(a1 + 12);
  if ( y > 180224 )
    *(_DWORD *)a1 = 0;
  if ( *(_DWORD *)(a1 + 72) / 2 % 2 )
  {
    result = a1 + 104;
    *(_DWORD *)result = v14;
    *(_DWORD *)(result + 4) = v15;
    *(_DWORD *)(result + 8) = v16;
    *(_DWORD *)(result + 12) = v17;
  }
  else
  {
    v2 = &v6 + 4 * *(_DWORD *)(a1 + 52);
    result = a1 + 104;
    *(_DWORD *)result = *v2;
    *(_DWORD *)(result + 4) = v2[1];
    *(_DWORD *)(result + 8) = v2[2];
    *(_DWORD *)(result + 12) = v2[3];
  }
  return result;
}


NPCHAR *ActNpc043_Cycloid(NPCHAR *a1)
{
  NPCHAR *result; 
  int *v2; 
  char *v3; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 
  int v23; 
  int v24; 
  int v25; 
  int v26; 
  int v27; 
  int v28; 
  int v29; 
  int v30; 
  int v31; 
  int v32; 
  int v33; 
  int v34; 
  int v35; 

  v4 = 112;
  v5 = 48;
  v6 = 128;
  v7 = 64;
  v8 = 128;
  v9 = 48;
  v10 = 144;
  v11 = 64;
  v12 = 144;
  v13 = 48;
  v14 = 160;
  v15 = 64;
  v16 = 160;
  v17 = 48;
  v18 = 176;
  v19 = 64;
  v20 = 176;
  v21 = 48;
  v22 = 192;
  v23 = 64;
  v24 = 192;
  v25 = 48;
  v26 = 208;
  v27 = 64;
  v28 = 208;
  v29 = 48;
  v30 = 224;
  v31 = 64;
  v32 = 224;
  v33 = 48;
  v34 = 240;
  v35 = 64;
  if ( a1->type2 )
  {
    result = a1;
    switch ( a1->state )
    {
      case 0:
        a1->state = 10;
        a1->flag &= 0xFFFFFFBF;
        a1->count2 = 0;
        a1->xm = 0;
        a1->ym = -2048;
        a1->y = 180224;
        PlaySound(26);
        goto LABEL_27;
      case 0xA:
LABEL_27:
        if ( a1->y <= 30720 )
        {
          a1->state = 20;
          if ( a1->x <= 61440 )
          {
            a1->count2 = 1;
            a1->xm = 1433;
            a1->ym = -1433;
          }
          else
          {
            a1->count2 = 7;
            a1->xm = -1433;
            a1->ym = -1433;
          }
        }
        break;
      case 0x14:
        if ( a1->y <= 0x2000 )
        {
          a1->state = 30;
          a1->count1 = 0;
          if ( a1->x <= 61440 )
          {
            a1->count2 = 2;
            a1->xm = 2048;
            a1->ym = 0;
            a1->child = (61440 - a1->x) / 1024;
          }
          else
          {
            a1->count2 = 6;
            a1->xm = -2048;
            a1->ym = 0;
            a1->child = (a1->x - 61440) / 1024;
          }
        }
        break;
      case 0x1E:
        if ( ++a1->count1 > a1->child )
        {
          a1->state = 40;
          if ( a1->xm >= 0 )
          {
            a1->count2 = 3;
            a1->ym = 1433;
          }
          else
          {
            a1->count2 = 5;
            a1->ym = 1433;
          }
        }
        break;
      case 0x28:
        if ( a1->y >= 22528 )
        {
          a1->state = 50;
          a1->xm = 0;
          a1->ym = 2048;
          a1->count2 = 4;
        }
        break;
      case 0x32:
        if ( a1->y <= 180224 )
          break;
        a1->cond = 0;
        return result;
      default:
        break;
    }
  }
  else
  {
    result = (NPCHAR *)a1->state;
    switch ( result )
    {
      case 0u:
        a1->state = 10;
        a1->flag &= 0xFFFFFFBF;
        a1->count2 = 4;
        a1->xm = 0;
        a1->ym = 2048;
        PlaySound(26);
        goto LABEL_4;
      case 0xAu:
LABEL_4:
        if ( a1->y >= 133120 )
        {
          a1->state = 20;
          if ( a1->x <= 61440 )
          {
            a1->count2 = 3;
            a1->xm = 1433;
            a1->ym = 1433;
          }
          else
          {
            a1->count2 = 5;
            a1->xm = -1433;
            a1->ym = 1433;
          }
        }
        break;
      case 0x14u:
        if ( a1->y >= 155648 )
        {
          a1->state = 30;
          a1->count1 = 0;
          if ( a1->x <= 61440 )
          {
            a1->count2 = 2;
            a1->xm = 2048;
            a1->ym = 0;
            a1->child = (61440 - a1->x) / 1024;
          }
          else
          {
            a1->count2 = 6;
            a1->xm = -2048;
            a1->ym = 0;
            a1->child = (a1->x - 61440) / 1024;
          }
        }
        break;
      case 0x1Eu:
        if ( ++a1->count1 > a1->child )
        {
          a1->state = 40;
          if ( a1->xm >= 0 )
          {
            a1->count2 = 1;
            a1->ym = -1433;
          }
          else
          {
            a1->count2 = 7;
            a1->ym = -1433;
          }
        }
        break;
      case 0x28u:
        if ( a1->y <= 141312 )
        {
          a1->state = 50;
          a1->xm = 0;
          a1->ym = -2048;
          a1->count2 = 0;
        }
        break;
      case 0x32u:
        if ( a1->y >= -16384 )
          break;
        a1->cond = 0;
        return result;
      default:
        break;
    }
  }
  a1->x += a1->xm;
  a1->y += a1->ym;
  v2 = &v4 + 4 * a1->count2;
  v3 = (char *)&a1->rect;
  *(_DWORD *)v3 = *v2;
  *((_DWORD *)v3 + 1) = v2[1];
  *((_DWORD *)v3 + 2) = v2[2];
  *((_DWORD *)v3 + 3) = v2[3];
  result = (NPCHAR *)(a1->shock / 2 % 2);
  if ( result )
  {
    a1->rect.top += 16;
    result = a1;
    a1->rect.bottom += 16;
  }
  return result;
}


int ActNpc044_Chester(int a1)
{
  int result; 
  int *v2; 
  int v3; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 
  int v23; 
  int v24; 
  int v25; 
  int v26; 
  int v27; 
  int v28; 
  int v29; 
  unsigned __int8 v30; 

  v6 = 96;
  v7 = 32;
  v8 = 112;
  v9 = 48;
  v10 = 112;
  v11 = 32;
  v12 = 128;
  v13 = 48;
  v14 = 128;
  v15 = 32;
  v16 = 144;
  v17 = 48;
  v18 = 112;
  v19 = 32;
  v20 = 128;
  v21 = 48;
  v22 = 144;
  v23 = 32;
  v24 = 160;
  v25 = 48;
  v26 = 160;
  v27 = 32;
  v28 = 176;
  v29 = 48;
  v4 = *(_DWORD *)(a1 + 4);
  v5 = *(_DWORD *)(a1 + 8);
  SubStageXOScroll(&v4, &v5);
  v3 = *(_DWORD *)(a1 + 44);
  if ( v3 )
  {
    if ( v3 != 10 )
    {
      if ( v3 == 20 && ++*(_DWORD *)(a1 + 48) > 24 )
      {
        *(_DWORD *)(a1 + 44) = 10;
        *(_DWORD *)(a1 + 48) = 0;
        *(_DWORD *)(a1 + 52) = 0;
        *(_DWORD *)(a1 + 56) = 0;
        *(_DWORD *)(a1 + 72) = 0;
        *(_DWORD *)(a1 + 68) |= 8u;
        *(_DWORD *)(a1 + 68) &= 0xFFFFFFFC;
        v30 = GetArktan(v4 - (_DWORD)ShipX, v5 - ShipY, 64);
        *(_DWORD *)(a1 + 12) = GetCos(v30);
        *(_DWORD *)(a1 + 16) = GetSin(v30);
        if ( *(_DWORD *)(a1 + 84) > 6 )
          *(_DWORD *)(a1 + 16) = 1024;
      }
      goto LABEL_24;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 44) = 10;
    *(_DWORD *)(a1 + 48) = -20;
    *(_DWORD *)(a1 + 68) |= 0x48u;
    v30 = GetArktan(v4 - (_DWORD)ShipX, v5 - ShipY, 64);
    *(_DWORD *)(a1 + 12) = 2 * (GetCos(v30) / 3);
    *(_DWORD *)(a1 + 16) = 2 * (GetSin(v30) / 3);
  }
  if ( *(_DWORD *)a1 & 0x10 && *(_DWORD *)(a1 + 12) < 0 )
  {
    *(_DWORD *)(a1 + 12) = -*(_DWORD *)(a1 + 12);
  }
  else if ( *(_DWORD *)a1 & 0x40 && *(_DWORD *)(a1 + 16) < 0 )
  {
    *(_DWORD *)(a1 + 16) = -*(_DWORD *)(a1 + 16);
  }
  else if ( *(_DWORD *)a1 & 0x20 && *(_DWORD *)(a1 + 12) > 0 )
  {
    *(_DWORD *)(a1 + 12) = -*(_DWORD *)(a1 + 12);
  }
  else if ( *(_DWORD *)a1 & 0x80 && *(_DWORD *)(a1 + 16) > 0 )
  {
    *(_DWORD *)(a1 + 16) = -*(_DWORD *)(a1 + 16);
  }
  *(_DWORD *)a1 &= 0xFFFFFF0F;
  if ( ++*(_DWORD *)(a1 + 48) > 36 )
  {
    *(_DWORD *)(a1 + 48) = 0;
    *(_DWORD *)(a1 + 44) = 20;
    *(_DWORD *)(a1 + 12) = 0;
    *(_DWORD *)(a1 + 16) = 0;
    *(_DWORD *)(a1 + 52) = 4;
    ++*(_DWORD *)(a1 + 84);
    *(_DWORD *)(a1 + 68) &= 0xFFFFFFF7;
    *(_DWORD *)(a1 + 68) |= 3u;
    PlaySound(39);
  }
LABEL_24:
  *(_DWORD *)(a1 + 4) += *(_DWORD *)(a1 + 12);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  if ( *(_DWORD *)(a1 + 44) < 20 )
  {
    if ( ++*(_DWORD *)(a1 + 56) > 3 )
    {
      *(_DWORD *)(a1 + 56) = 0;
      ++*(_DWORD *)(a1 + 52);
    }
    if ( *(_DWORD *)(a1 + 52) > 3 )
      *(_DWORD *)(a1 + 52) = 0;
  }
  if ( *(_DWORD *)(a1 + 72) / 2 % 2 )
  {
    result = a1 + 104;
    *(_DWORD *)result = v26;
    *(_DWORD *)(result + 4) = v27;
    *(_DWORD *)(result + 8) = v28;
    *(_DWORD *)(result + 12) = v29;
  }
  else
  {
    v2 = &v6 + 4 * *(_DWORD *)(a1 + 52);
    result = a1 + 104;
    *(_DWORD *)result = *v2;
    *(_DWORD *)(result + 4) = v2[1];
    *(_DWORD *)(result + 8) = v2[2];
    *(_DWORD *)(result + 12) = v2[3];
  }
  if ( v5 > 172032 )
  {
    result = a1;
    *(_DWORD *)a1 = 0;
  }
  return result;
}


LONG ActNpc045_Bonus(NPCHAR *a1)
{
  tagRECT *v1; 
  tagRECT *v2; 
  LONG result; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 

  v4 = 0;
  v5 = 0;
  v6 = 16;
  v7 = 16;
  v8 = 16;
  v9 = 0;
  v10 = 32;
  v11 = 16;
  if ( !a1->state )
  {
    a1->state = 10;
    a1->count2 = a1->type2;
    if ( a1->type2 )
    {
      a1->flag |= 0x10u;
      AddStageXOScroll(&a1->x, &a1->y);
    }
    else
    {
      a1->score = 5;
      a1->ym = 1024;
    }
  }
  a1->x += a1->xm;
  a1->y += a1->ym;
  v12 = a1->x;
  v13 = a1->y;
  if ( a1->flag & 0x10 )
    SubStageXOScroll(&v12, &v13);
  if ( v13 > 180224 )
    a1->cond = 0;
  v1 = (tagRECT *)(&v4 + 4 * a1->count2);
  v2 = &a1->rect;
  v2->left = v1->left;
  v2->top = v1->top;
  result = v1->right;
  v2->right = result;
  v2->bottom = v1->bottom;
  return result;
}


NPCHAR *ActNpc046_BonusGen(NPCHAR *a1)
{
  NPCHAR *result; 

  result = a1;
  if ( !a1->type2 && dword_44C308 > 400 )
  {
    result = (NPCHAR *)CreateEntity(45, a1->x, -8, 0);
    a1->cond = 0;
  }
  return result;
}



signed int ActNpc047_CloudXL(int a1)
{
  int v1; 
  signed int result; 

  *(_DWORD *)(a1 + 8) += 4096;
  if ( *(_DWORD *)(a1 + 8) > 212992 )
    *(_DWORD *)a1 = 0;
  v1 = a1 + 104;
  *(_DWORD *)v1 = 0;
  *(_DWORD *)(v1 + 4) = 80;
  result = 96;
  *(_DWORD *)(v1 + 8) = 96;
  *(_DWORD *)(v1 + 12) = 128;
  return result;
}


NPCHAR *ActNpc048_Gimmick(NPCHAR *a1)
{
  char v1; 
  int *v2; 
  char *v3; 
  NPCHAR *result; 
  int x; 
  int y; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 

  v7 = 192;
  v8 = 0;
  v9 = 208;
  v10 = 16;
  v11 = 208;
  v12 = 0;
  v13 = 224;
  v14 = 16;
  v15 = 224;
  v16 = 0;
  v17 = 240;
  v18 = 16;
  v19 = 240;
  v20 = 0;
  v21 = 256;
  v22 = 16;
  x = a1->x;
  y = a1->y;
  SubStageXOScroll(&x, &y);
  switch ( a1->state )
  {
    case 0:
      a1->state = 10;
      a1->count2 = a1->type2;
      a1->flag |= 3u;
      goto LABEL_3;
    case 0xA:
LABEL_3:
      if ( a1->shock )
      {
        a1->state = 20;
        a1->flag &= 0xFFFFFFFE;
        a1->flag |= 8u;
      }
      break;
    case 0x14:
      if ( a1->count1 >= 12 )
      {
        a1->state = 30;
        a1->flag |= 1u;
        a1->flag &= 0xFFFFFFF7;
LABEL_27:
        switch ( a1->type2 )
        {
          case 0:
            if ( (signed int)ShipX > x - 0x4000 )
              a1->state = 40;
            break;
          case 1:
            if ( ShipY > y - 0x4000 )
              a1->state = 40;
            break;
          case 2:
            if ( (signed int)ShipX < x + 0x4000 )
              a1->state = 40;
            break;
          case 3:
            if ( ShipY < y + 0x4000 )
              a1->state = 40;
            break;
          default:
            break;
        }
        if ( a1->state == 40 )
        {
          a1->count1 = 0;
          PlaySound(30);
          CreateCaret(1, a1->x, a1->y, (int)a1);
        }
      }
      else
      {
        if ( a1->count1 >= 4 )
        {
          switch ( a1->type2 )
          {
            case 0:
              a1->x += 2048;
              break;
            case 1:
              a1->y += 2048;
              break;
            case 2:
              a1->x -= 2048;
              break;
            case 3:
              a1->y -= 2048;
              break;
            default:
              break;
          }
        }
        else
        {
          switch ( a1->type2 )
          {
            case 0:
              a1->x += 4096;
              break;
            case 1:
              a1->y += 4096;
              break;
            case 2:
              a1->x -= 4096;
              break;
            case 3:
              a1->y -= 4096;
              break;
            default:
              break;
          }
        }
        if ( a1->count1 == 4 )
        {
          switch ( a1->type2 )
          {
            case 0:
              a1->count2 = 2;
              break;
            case 1:
              a1->count2 = 3;
              break;
            case 2:
              a1->count2 = 0;
              break;
            case 3:
              a1->count2 = 1;
              break;
            default:
              break;
          }
        }
        ++a1->count1;
      }
      break;
    case 0x1E:
      goto LABEL_27;
    case 0x28:
      if ( ++a1->count1 == 14 )
      {
        v1 = GetArktan(x - (_DWORD)ShipX, y - ShipY, 64);
        CreateEntity(14, x, y, (unsigned __int8)v1);
        PlaySound(7);
      }
      break;
    default:
      break;
  }
  v2 = &v7 + 4 * a1->count2;
  v3 = (char *)&a1->rect;
  *(_DWORD *)v3 = *v2;
  *((_DWORD *)v3 + 1) = v2[1];
  *((_DWORD *)v3 + 2) = v2[2];
  *((_DWORD *)v3 + 3) = v2[3];
  result = (NPCHAR *)(a1->shock / 2 % 2);
  if ( result )
  {
    a1->rect.top += 32;
    result = a1;
    a1->rect.bottom += 32;
  }
  else if ( a1->state >= 30 )
  {
    a1->rect.top += 16;
    result = (NPCHAR *)(a1->rect.bottom + 16);
    a1->rect.bottom = (LONG)result;
  }
  if ( y > 180224 )
    a1->cond = 0;
  return result;
}


int ActNpc049_Boss3(int a1)
{
  signed int v1; 
  int v2; 
  __int16 v3; 
  int v4; 
  __int16 v5; 
  int result; 
  signed int i; 
  HBITMAP hBitmap; 
  int nWidth; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 

  v10 = 0;
  v11 = 64;
  v12 = 64;
  v13 = 120;
  switch ( *(_DWORD *)(a1 + 44) )
  {
    case 0:
      *(_DWORD *)(a1 + 44) = 10;
      *(_DWORD *)(a1 + 68) |= 2u;
      *(_DWORD *)(a1 + 8) -= 28672;
      CreateEntity(51, 0, 0, a1);
      CreateEntity(52, 0, 0, a1);
      CreateEntity(53, 0, 0, a1);
      hBitmap = *(HBITMAP *)(a1 + 4);
      nWidth = *(_DWORD *)(a1 + 8);
      SubStageXOScroll(&hBitmap, &nWidth);
      CreateEntity(54, (int)(hBitmap - 3328), nWidth, a1);
      CreateEntity(54, (int)(hBitmap + 3328), nWidth, a1);
      hBitmap = (HBITMAP)(*(_DWORD *)(a1 + 4) - 40960);
      nWidth = *(_DWORD *)(a1 + 8) + 12288;
      SubStageXOScroll(&hBitmap, &nWidth);
      CreateEntity(55, (int)hBitmap, nWidth, a1);
      hBitmap = (HBITMAP)(*(_DWORD *)(a1 + 4) + 40960);
      nWidth = *(_DWORD *)(a1 + 8) + 12288;
      SubStageXOScroll(&hBitmap, &nWidth);
      CreateEntity(55, (int)hBitmap, nWidth, a1);
      hBitmap = (HBITMAP)(*(_DWORD *)(a1 + 4) - 40960);
      nWidth = *(_DWORD *)(a1 + 8) - 4096;
      SubStageXOScroll(&hBitmap, &nWidth);
      CreateEntity(57, (int)hBitmap, nWidth, a1);
      hBitmap = (HBITMAP)(*(_DWORD *)(a1 + 4) + 40960);
      nWidth = *(_DWORD *)(a1 + 8) - 4096;
      SubStageXOScroll(&hBitmap, &nWidth);
      CreateEntity(57, (int)hBitmap, nWidth, a1);
      goto LABEL_3;
    case 0xA:
LABEL_3:
      if ( ++*(_DWORD *)(a1 + 48) > 200 )
      {
        *(_DWORD *)(a1 + 48) = 0;
        *(_DWORD *)(a1 + 44) = 20;
        *(_DWORD *)(a1 + 84) = 1;
      }
      goto LABEL_18;
    case 0x14:
      if ( *(_DWORD *)(a1 + 84) >= 4 )
        goto LABEL_7;
      goto LABEL_18;
    case 0x64:
LABEL_7:
      *(_DWORD *)(a1 + 44) = 110;
      *(_DWORD *)(a1 + 48) = 0;
      PlayLoopSound(32);
      goto LABEL_8;
    case 0x6E:
LABEL_8:
      v1 = (*(_DWORD *)(a1 + 48))++;
      if ( v1 < 60 )
        goto LABEL_18;
      *(_DWORD *)(a1 + 12) = 0;
      *(_DWORD *)(a1 + 16) = 341;
      *(_DWORD *)(a1 + 44) = 120;
      PlaySound(12);
      if ( !(ShipCond & 2) )
      {
        AddScore(*(_DWORD *)(a1 + 76));
        hBitmap = *(HBITMAP *)(a1 + 4);
        nWidth = *(_DWORD *)(a1 + 8);
        SubStageXOScroll(&hBitmap, &nWidth);
        CreateCaret(0, (int)hBitmap, nWidth, *(_DWORD *)(a1 + 76));
        SetShipInvincibility();
      }
      for ( i = 0; i < 15; ++i )
      {
        v2 = *(_DWORD *)(a1 + 8) + (((unsigned __int16)GetRandom(48) - 20) << 10);
        v3 = GetRandom(48);
        CreateEntity(1, *(_DWORD *)(a1 + 4) + (((unsigned __int16)v3 - 24) << 10), v2, 0);
      }
      goto LABEL_14;
    case 0x78:
LABEL_14:
      if ( ++*(_DWORD *)(a1 + 48) > 5 )
      {
        *(_DWORD *)(a1 + 48) = (unsigned __int16)GetRandom(4);
        v4 = *(_DWORD *)(a1 + 8) + (((unsigned __int16)GetRandom(64) - 32) << 10);
        v5 = GetRandom(64);
        CreateEntity(1, *(_DWORD *)(a1 + 4) + (((unsigned __int16)v5 - 32) << 10), v4, 0);
      }
      if ( ++*(_DWORD *)(a1 + 56) <= 250 )
        goto LABEL_18;
      *(_DWORD *)(a1 + 44) = 121;
      CheckStageClear(3);
      result = StopLoopSound(32);
      break;
    default:
LABEL_18:
      result = a1 + 104;
      *(_DWORD *)result = v10;
      *(_DWORD *)(result + 4) = v11;
      *(_DWORD *)(result + 8) = v12;
      *(_DWORD *)(result + 12) = v13;
      break;
  }
  return result;
}


NPCHAR *ActNpc050_62_PowerupHelper(NPCHAR *a1)
{
  char *v1; 
  NPCHAR *result; 
  NPCHAR *v3; 

  v3 = (NPCHAR *)a1->type2;
  if ( !a1->state )
  {
    a1->state = 10;
    a1->count2 = v3->type2 - 1;
  }
  a1->x = v3->x;
  a1->y = v3->y;
  v1 = (char *)&a1->rect;
  *(_DWORD *)v1 = 0;
  *((_DWORD *)v1 + 1) = 0;
  *((_DWORD *)v1 + 2) = 16;
  *((_DWORD *)v1 + 3) = 16;
  a1->rect.left = 16 * (v3->type2 - 1);
  a1->rect.right = a1->rect.left + 16;
  result = a1;
  if ( v3->num >= a1->num || (result = (NPCHAR *)(v3->cond & 1)) == 0 )
    a1->cond = 0;
  return result;
}


LONG *ActNpc051_B3Eye1_(NPCHAR *a1)
{
  LONG *result; 
  char *v2; 
  char *v3; 
  int x; 
  int y; 
  int v6; 

  v6 = a1->type2;
  a1->x = *(_DWORD *)(v6 + 4);
  a1->y = *(_DWORD *)(v6 + 8) + 14336;
  x = a1->x;
  y = a1->y;
  SubStageXOScroll(&x, &y);
  if ( a1->state < 100 && a1->life < 900 )
  {
    a1->state = 100;
    a1->count1 = 0;
    a1->shock = 0;
    a1->count2 = 5;
    *(_DWORD *)(v6 + 84) = 2;
    a1->flag &= 0xFFFFFFFE;
    CreateEntity(1, x, y, 0);
    PlaySound(12);
  }
  switch ( a1->state )
  {
    case 0:
      a1->state = 10;
      a1->flag |= 0xAu;
      goto LABEL_6;
    case 0xA:
LABEL_6:
      if ( *(_DWORD *)(v6 + 84) == 1 )
        a1->state = 18;
      break;
    case 0x12:
      if ( ++a1->count1 > 50 )
      {
        a1->state = 19;
        a1->flag &= 0xFFFFFFF7;
        a1->flag |= 1u;
        PlaySound(38);
      }
      break;
    case 0x13:
      if ( ++a1->count3 > 2 )
      {
        a1->count3 = 0;
        ++a1->count2;
      }
      if ( a1->count2 == 3 )
      {
        a1->state = 20;
        a1->count1 = 0;
        CreateEntity(14, x, y, 64);
      }
      break;
    case 0x14:
      switch ( ++a1->count1 )
      {
        case 0x95:
          CreateEntity(18, x, y, 0);
          CreateEntity(18, x, y, 1);
          CreateEntity(18, x, y, 2);
          break;
        case 0x96:
          CreateEntity(18, x, y, 0);
          CreateEntity(18, x, y, 1);
          CreateEntity(18, x, y, 2);
          a1->count1 = 0;
          break;
        case 0x94:
          PlaySound(9);
          break;
        case 0x82:
          CreateCaret(4, a1->x, a1->y, (int)a1);
          PlaySound(31);
          break;
      }
      break;
    case 0x64:
      if ( *(_DWORD *)(v6 + 44) != 120 )
        break;
      a1->state = 110;
      a1->life = 100;
      a1->flag |= 1u;
      a1->destroyHitVoice = 4;
      a1->w = 6144;
      a1->h = 6144;
      goto LABEL_28;
    case 0x6E:
LABEL_28:
      if ( a1->life <= 52 )
      {
        a1->state = 120;
        CreateEntity(7, x, y, 2);
        a1->flag &= 0xFFFFFFFE;
        PlaySound(11);
        CreateEntity(1, x, y, 0);
      }
      break;
    default:
      break;
  }
  if ( a1->count2 != 5 && a1->shock / 2 % 2 )
  {
    result = &a1->rect.left;
    *result = 160;
    result[1] = 48;
    result[2] = 176;
    result[3] = 64;
  }
  else
  {
    v2 = (char *)&unk_43B550 + 16 * a1->count2;
    v3 = (char *)&a1->rect;
    *(_DWORD *)v3 = *(_DWORD *)v2;
    *((_DWORD *)v3 + 1) = *((_DWORD *)v2 + 1);
    result = (LONG *)*((_DWORD *)v2 + 2);
    *((_DWORD *)v3 + 2) = result;
    *((_DWORD *)v3 + 3) = *((_DWORD *)v2 + 3);
  }
  return result;
}


int ActNpc052_B3Eye2_(int a1)
{
  int v1; 
  int result; 
  char *v3; 
  int x; 
  int y; 
  int v6; 

  v6 = *(_DWORD *)(a1 + 80);
  *(_DWORD *)(a1 + 4) = *(_DWORD *)(v6 + 4);
  *(_DWORD *)(a1 + 8) = *(_DWORD *)(v6 + 8) + 1024;
  x = *(_DWORD *)(a1 + 4);
  y = *(_DWORD *)(a1 + 8);
  SubStageXOScroll(&x, &y);
  if ( *(_DWORD *)(a1 + 44) < 100 && *(_DWORD *)(a1 + 60) < 900 )
  {
    *(_DWORD *)(a1 + 44) = 100;
    *(_DWORD *)(a1 + 48) = 0;
    *(_DWORD *)(a1 + 72) = 0;
    *(_DWORD *)(a1 + 52) = 5;
    *(_DWORD *)(v6 + 84) = 3;
    *(_DWORD *)(a1 + 68) &= 0xFFFFFFFE;
    CreateEntity(1, x, y, 0);
    PlaySound(12);
  }
  switch ( *(_DWORD *)(a1 + 44) )
  {
    case 0:
      *(_DWORD *)(a1 + 44) = 10;
      *(_DWORD *)(a1 + 68) |= 8u;
      goto LABEL_6;
    case 0xA:
LABEL_6:
      if ( *(_DWORD *)(v6 + 84) == 2 )
        *(_DWORD *)(a1 + 44) = 18;
      break;
    case 0x12:
      if ( ++*(_DWORD *)(a1 + 48) > 50 )
      {
        *(_DWORD *)(a1 + 44) = 19;
        *(_DWORD *)(a1 + 68) &= 0xFFFFFFF7;
        *(_DWORD *)(a1 + 68) |= 3u;
        PlaySound(38);
      }
      break;
    case 0x13:
      if ( ++*(_DWORD *)(a1 + 56) > 2 )
      {
        *(_DWORD *)(a1 + 56) = 0;
        ++*(_DWORD *)(a1 + 52);
      }
      if ( *(_DWORD *)(a1 + 52) == 3 )
      {
        *(_DWORD *)(a1 + 44) = 20;
        *(_DWORD *)(a1 + 48) = 0;
        CreateEntity(14, x, y, 64);
      }
      break;
    case 0x14:
      switch ( ++*(_DWORD *)(a1 + 48) )
      {
        case 0x95:
          CreateEntity(18, x, y, 0);
          break;
        case 0x96:
          CreateEntity(18, x, y, 0);
          *(_DWORD *)(a1 + 48) = 0;
          break;
        case 0x94:
          PlaySound(9);
          break;
        case 0x82:
          CreateCaret(4, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), a1);
          PlaySound(31);
          break;
      }
      break;
    case 0x64:
      if ( *(_DWORD *)(v6 + 44) != 120 )
        break;
      *(_DWORD *)(a1 + 44) = 110;
      *(_DWORD *)(a1 + 60) = 100;
      *(_DWORD *)(a1 + 68) |= 1u;
      *(_DWORD *)(a1 + 100) = 4;
      *(_DWORD *)(a1 + 28) = 6144;
      *(_DWORD *)(a1 + 32) = 6144;
      goto LABEL_28;
    case 0x6E:
LABEL_28:
      if ( *(_DWORD *)(a1 + 60) <= 52 )
      {
        *(_DWORD *)(a1 + 44) = 120;
        CreateEntity(7, x, y, 2);
        *(_DWORD *)(a1 + 68) &= 0xFFFFFFFE;
        PlaySound(11);
        CreateEntity(1, x, y, 0);
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 52) != 5 && *(_DWORD *)(a1 + 72) / 2 % 2 )
  {
    v1 = a1 + 104;
    *(_DWORD *)v1 = 160;
    *(_DWORD *)(v1 + 4) = 48;
    *(_DWORD *)(v1 + 8) = 176;
    result = 64;
    *(_DWORD *)(v1 + 12) = 64;
  }
  else
  {
    v3 = (char *)&unk_43B550 + 16 * *(_DWORD *)(a1 + 52);
    result = a1 + 104;
    *(_DWORD *)result = *(_DWORD *)v3;
    *(_DWORD *)(result + 4) = *((_DWORD *)v3 + 1);
    *(_DWORD *)(result + 8) = *((_DWORD *)v3 + 2);
    *(_DWORD *)(result + 12) = *((_DWORD *)v3 + 3);
  }
  return result;
}


int ActNpc053_B3Eye3_(int a1)
{
  char v1; 
  int result; 
  char *v3; 
  int v4; 
  int x; 
  int y; 
  int v7; 

  v7 = *(_DWORD *)(a1 + 80);
  *(_DWORD *)(a1 + 4) = *(_DWORD *)(v7 + 4);
  *(_DWORD *)(a1 + 8) = *(_DWORD *)(v7 + 8) - 12288;
  x = *(_DWORD *)(a1 + 4);
  y = *(_DWORD *)(a1 + 8);
  SubStageXOScroll(&x, &y);
  if ( *(_DWORD *)(a1 + 44) < 100 && *(_DWORD *)(a1 + 60) < 900 )
  {
    *(_DWORD *)(a1 + 44) = 100;
    *(_DWORD *)(a1 + 48) = 0;
    *(_DWORD *)(a1 + 72) = 0;
    *(_DWORD *)(a1 + 52) = 5;
    *(_DWORD *)(v7 + 84) = 4;
    *(_DWORD *)(a1 + 68) &= 0xFFFFFFFE;
    CreateEntity(1, x, y, 0);
    PlaySound(12);
  }
  switch ( *(_DWORD *)(a1 + 44) )
  {
    case 0:
      *(_DWORD *)(a1 + 44) = 10;
      *(_DWORD *)(a1 + 68) |= 8u;
      goto LABEL_6;
    case 0xA:
LABEL_6:
      if ( *(_DWORD *)(v7 + 84) == 3 )
        *(_DWORD *)(a1 + 44) = 18;
      break;
    case 0x12:
      if ( ++*(_DWORD *)(a1 + 48) > 50 )
      {
        *(_DWORD *)(a1 + 44) = 19;
        *(_DWORD *)(a1 + 68) &= 0xFFFFFFF7;
        *(_DWORD *)(a1 + 68) |= 3u;
        PlaySound(38);
      }
      break;
    case 0x13:
      if ( ++*(_DWORD *)(a1 + 56) > 2 )
      {
        *(_DWORD *)(a1 + 56) = 0;
        ++*(_DWORD *)(a1 + 52);
      }
      if ( *(_DWORD *)(a1 + 52) == 3 )
      {
        *(_DWORD *)(a1 + 44) = 20;
        *(_DWORD *)(a1 + 48) = 0;
        CreateEntity(14, x, y, 64);
      }
      break;
    case 0x14:
      switch ( ++*(_DWORD *)(a1 + 48) )
      {
        case 0x32:
          v1 = GetArktan(x - (_DWORD)ShipX, y - ShipY, 64);
          CreateEntity(13, x, y, (unsigned __int8)v1);
          CreateEntity(13, x, y, (unsigned __int8)v1 - 8);
          CreateEntity(13, x, y, (unsigned __int8)v1 + 8);
          CreateEntity(13, x, y, (unsigned __int8)v1 - 16);
          CreateEntity(13, x, y, (unsigned __int8)v1 + 16);
          PlaySound(7);
          break;
        case 0x22:
          CreateCaret(1, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), a1);
          PlaySound(30);
          break;
        case 0xA6:
          *(_DWORD *)(a1 + 48) = 0;
          break;
        default:
          if ( *(_DWORD *)(a1 + 48) != 150 && *(_DWORD *)(a1 + 48) != 156 && *(_DWORD *)(a1 + 48) != 162 )
          {
            if ( *(_DWORD *)(a1 + 48) == 130 )
            {
              CreateCaret(1, *(_DWORD *)(a1 + 4) - 17408, *(_DWORD *)(a1 + 8) + 28672, a1);
              CreateCaret(1, *(_DWORD *)(a1 + 4) + 17408, *(_DWORD *)(a1 + 8) + 28672, a1);
              PlaySound(31);
              CreateCaret(5, (int)ShipX, ShipY, 0);
              *(_DWORD *)(a1 + 84) = (unsigned __int8)GetArktan(x - 17408 - (_DWORD)ShipX, y + 28672 - ShipY, 64);
              *(_DWORD *)(a1 + 88) = (unsigned __int8)GetArktan(x + 17408 - (_DWORD)ShipX, y + 28672 - ShipY, 64);
            }
          }
          else
          {
            CreateEntity(63, x - 17408, y + 28672, *(_DWORD *)(a1 + 84));
            CreateEntity(63, x + 17408, y + 28672, *(_DWORD *)(a1 + 88));
            PlaySound(36);
          }
          break;
      }
      break;
    case 0x64:
      if ( *(_DWORD *)(v7 + 44) != 120 )
        break;
      *(_DWORD *)(a1 + 44) = 110;
      *(_DWORD *)(a1 + 60) = 100;
      *(_DWORD *)(a1 + 68) |= 1u;
      *(_DWORD *)(a1 + 100) = 4;
      *(_DWORD *)(a1 + 28) = 6144;
      *(_DWORD *)(a1 + 32) = 6144;
      goto LABEL_32;
    case 0x6E:
LABEL_32:
      if ( *(_DWORD *)(a1 + 60) <= 52 )
      {
        *(_DWORD *)(a1 + 44) = 120;
        CreateEntity(7, x, y, 2);
        *(_DWORD *)(a1 + 68) &= 0xFFFFFFFE;
        PlaySound(11);
        CreateEntity(1, x, y, 0);
      }
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 52) != 5 && *(_DWORD *)(a1 + 72) / 2 % 2 )
  {
    result = a1 + 104;
    *(_DWORD *)result = 160;
    *(_DWORD *)(result + 4) = 48;
    *(_DWORD *)(result + 8) = 176;
    *(_DWORD *)(result + 12) = 64;
  }
  else
  {
    v3 = (char *)&unk_43B550 + 16 * *(_DWORD *)(a1 + 52);
    v4 = a1 + 104;
    *(_DWORD *)v4 = *(_DWORD *)v3;
    *(_DWORD *)(v4 + 4) = *((_DWORD *)v3 + 1);
    result = *((_DWORD *)v3 + 2);
    *(_DWORD *)(v4 + 8) = result;
    *(_DWORD *)(v4 + 12) = *((_DWORD *)v3 + 3);
  }
  return result;
}


NPCHAR *ActNpc054_B3BulletBlocker_(NPCHAR *a1)
{
  NPCHAR *result; 

  result = a1;
  a1->flag |= 8u;
  return result;
}


int ActNpc055_B3Target__(NPCHAR *a1)
{
  char v1; 
  char *v2; 
  int result; 
  int *v4; 
  char *v5; 
  int x; 
  int y; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 
  int v23; 
  int v24; 
  int v25; 
  int v26; 
  int v27; 
  int v28; 

  v8 = 96;
  v9 = 64;
  v10 = 112;
  v11 = 80;
  v12 = 112;
  v13 = 64;
  v14 = 128;
  v15 = 80;
  v16 = 128;
  v17 = 64;
  v18 = 144;
  v19 = 80;
  v20 = 144;
  v21 = 64;
  v22 = 160;
  v23 = 80;
  v24 = 160;
  v25 = 64;
  v26 = 176;
  v27 = 80;
  v28 = a1->type2;
  x = a1->x;
  y = a1->y;
  SubStageXOScroll(&x, &y);
  if ( a1->state < 100 && *(_DWORD *)(v28 + 84) > 1 )
  {
    a1->state = 100;
    a1->count1 = 0;
    a1->shock = 0;
    a1->flag &= 0xFFFFFFFE;
  }
  switch ( a1->state )
  {
    case 0:
      a1->state = 10;
      a1->flag |= 8u;
      goto LABEL_6;
    case 0xA:
LABEL_6:
      if ( *(_DWORD *)(v28 + 84) == 1 )
      {
        a1->state = 19;
        a1->flag &= 0xFFFFFFF7;
        a1->flag |= 1u;
        PlaySound(38);
      }
      break;
    case 0x13:
      if ( ++a1->count3 > 2 )
      {
        a1->count3 = 0;
        ++a1->count2;
      }
      if ( a1->count2 == 2 )
        a1->state = 20;
      break;
    case 0x14:
      if ( ++a1->count1 == 86 )
      {
        CreateCaret(1, a1->x, a1->y, (int)a1);
        PlaySound(30);
      }
      if ( a1->count1 == 100 )
      {
        a1->count1 = 0;
        v1 = GetArktan(x - (_DWORD)ShipX, y - ShipY, 64);
        CreateEntity(14, x, y, (unsigned __int8)v1);
        PlaySound(7);
      }
      if ( a1->life < 912 )
      {
        a1->state = 90;
        a1->count2 = 3;
        AddScore(a1->score);
        CreateCaret(0, a1->x, a1->y, a1->score);
        CreateEntity(1, x, y, 0);
        PlaySound(12);
        a1->flag &= 0xFFFFFFFE;
      }
      break;
    case 0x64:
      if ( ++a1->count1 > 50 )
      {
        CreateEntity(1, x, y, 0);
        PlaySound(14);
        a1->cond = 0;
      }
      break;
    default:
      break;
  }
  if ( a1->shock / 2 % 2 )
  {
    v2 = (char *)&a1->rect;
    *(_DWORD *)v2 = v24;
    *((_DWORD *)v2 + 1) = v25;
    *((_DWORD *)v2 + 2) = v26;
    result = v27;
    *((_DWORD *)v2 + 3) = v27;
  }
  else
  {
    v4 = &v8 + 4 * a1->count2;
    v5 = (char *)&a1->rect;
    *(_DWORD *)v5 = *v4;
    *((_DWORD *)v5 + 1) = v4[1];
    *((_DWORD *)v5 + 2) = v4[2];
    result = v4[3];
    *((_DWORD *)v5 + 3) = result;
  }
  return result;
}


NPCHAR *ActNpc056_Checkpoint(NPCHAR *a1)
{
  NPCHAR *result; 

  if ( !a1->state )
  {
    a1->state = 10;
    SetCheckpointScroll();
    CreateCaret(3, 0, 0, 1);
    PlaySound(43);
  }
  a1->y += 1024;
  result = a1;
  if ( a1->y > 172032 )
    a1->cond = 0;
  return result;
}


int ActNpc057_Boss3TurretSpawner(NPCHAR *a1)
{
  int *v1; 
  char *v2; 
  int result; 
  int x; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 

  v6 = 192;
  v7 = 48;
  v8 = 208;
  v9 = 64;
  v10 = 208;
  v11 = 48;
  v12 = 224;
  v13 = 64;
  v14 = 224;
  v15 = 48;
  v16 = 240;
  v17 = 64;
  v18 = a1->type2;
  x = a1->x;
  v5 = a1->y;
  SubStageXOScroll(&x, &v5);
  switch ( a1->state )
  {
    case 0:
      a1->state = 10;
      goto LABEL_3;
    case 0xA:
LABEL_3:
      if ( *(_DWORD *)(v18 + 84) == 2 )
      {
        a1->state = 19;
        PlaySound(38);
      }
      break;
    case 0x13:
      if ( ++a1->count3 > 1 )
      {
        a1->count3 = 0;
        ++a1->count2;
      }
      if ( a1->count2 == 2 )
      {
        a1->state = 20;
        if ( x < 61440 )
          a1->count1 = 80;
      }
      break;
    case 0x14:
      if ( ++a1->count1 == 160 )
      {
        a1->count1 = 0;
        CreateEntity(58, x, v5 - 10240, 0);
      }
      if ( *(_DWORD *)(v18 + 84) != 2 )
        a1->state = 30;
      break;
    default:
      break;
  }
  v1 = &v6 + 4 * a1->count2;
  v2 = (char *)&a1->rect;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  result = v1[2];
  *((_DWORD *)v2 + 2) = result;
  *((_DWORD *)v2 + 3) = v1[3];
  return result;
}


int ActNpc058_B3Turret(int nHeight)
{
  char v1; 
  int v2; 
  int result; 
  int *v4; 
  int v5; 
  int v6; 
  int x; 
  int y; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 

  v9 = 192;
  v10 = 64;
  v11 = 208;
  v12 = 80;
  v13 = 208;
  v14 = 64;
  v15 = 224;
  v16 = 80;
  v17 = 224;
  v18 = 64;
  v19 = 240;
  v20 = 80;
  v6 = *(_DWORD *)(nHeight + 44);
  if ( v6 )
  {
    if ( v6 == 10 )
    {
      *(_DWORD *)(nHeight + 8) += 512;
      ++*(_DWORD *)(nHeight + 48);
      x = *(_DWORD *)(nHeight + 4);
      y = *(_DWORD *)(nHeight + 8);
      SubStageXOScroll(&x, &y);
      if ( *(_DWORD *)(nHeight + 48) == 136 )
      {
        CreateCaret(1, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), nHeight);
        PlaySound(30);
      }
      if ( *(_DWORD *)(nHeight + 48) == 150 )
      {
        *(_DWORD *)(nHeight + 48) = 0;
        v1 = GetArktan(x - (_DWORD)ShipX, y - ShipY, 64);
        CreateEntity(14, x, y, (unsigned __int8)v1);
        PlaySound(7);
      }
      if ( y > 180224 )
        *(_DWORD *)nHeight = 0;
    }
  }
  else
  {
    *(_DWORD *)(nHeight + 8) += 1024;
    ++*(_DWORD *)(nHeight + 48);
    ++*(_DWORD *)(nHeight + 56);
    if ( *(_DWORD *)(nHeight + 48) > 20 )
    {
      *(_DWORD *)(nHeight + 48) = 100;
      *(_DWORD *)(nHeight + 44) = 0;
      *(_DWORD *)(nHeight + 44) = 10;
      *(_DWORD *)(nHeight + 68) |= 1u;
    }
  }
  ++*(_DWORD *)(nHeight + 56);
  if ( ++*(_DWORD *)(nHeight + 56) > 1 )
  {
    *(_DWORD *)(nHeight + 56) = 0;
    ++*(_DWORD *)(nHeight + 52);
  }
  if ( *(_DWORD *)(nHeight + 52) > 1 )
    *(_DWORD *)(nHeight + 52) = 0;
  if ( *(_DWORD *)(nHeight + 72) / 2 % 2 )
  {
    v2 = nHeight + 104;
    *(_DWORD *)v2 = v17;
    *(_DWORD *)(v2 + 4) = v18;
    *(_DWORD *)(v2 + 8) = v19;
    result = v20;
    *(_DWORD *)(v2 + 12) = v20;
  }
  else
  {
    v4 = &v9 + 4 * *(_DWORD *)(nHeight + 52);
    v5 = nHeight + 104;
    *(_DWORD *)v5 = *v4;
    *(_DWORD *)(v5 + 4) = v4[1];
    *(_DWORD *)(v5 + 8) = v4[2];
    result = v4[3];
    *(_DWORD *)(v5 + 12) = result;
  }
  return result;
}


NPCHAR *ActNpc059_PowerupSpinnerShield(NPCHAR *a1)
{
  int *v1; 
  char *v2; 
  NPCHAR *result; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 
  int v23; 
  int v24; 
  int v25; 
  int v26; 
  int v27; 

  v4 = 0;
  v5 = 24;
  v6 = 24;
  v7 = 48;
  v8 = 24;
  v9 = 24;
  v10 = 48;
  v11 = 48;
  v12 = 48;
  v13 = 24;
  v14 = 72;
  v15 = 48;
  v16 = 144;
  v17 = 0;
  v18 = 168;
  v19 = 24;
  v20 = 168;
  v21 = 0;
  v22 = 192;
  v23 = 24;
  v24 = 192;
  v25 = 0;
  v26 = 216;
  v27 = 24;
  switch ( a1->state )
  {
    case 0:
      a1->state = 10;
      a1->y = 163840;
      a1->ym = -6144;
      if ( a1->type2 )
      {
        CreateEntity(50, 0, 0, (int)a1);
        a1->life = 1;
        a1->score = 0;
      }
      PlaySound(26);
      goto LABEL_5;
    case 0xA:
LABEL_5:
      a1->ym += 113;
      if ( ++a1->count3 > 2 )
      {
        a1->count3 = 0;
        ++a1->count2;
      }
      if ( a1->count2 > 2 )
        a1->count2 = 0;
      if ( a1->ym > 0 )
        goto LABEL_10;
      break;
    case 0x14:
LABEL_10:
      a1->state = 30;
      a1->flag |= 0x43u;
      a1->damage = 1;
      goto LABEL_11;
    case 0x1E:
LABEL_11:
      if ( a1->type2 )
      {
        a1->ym += 42;
      }
      else
      {
        if ( (signed int)ShipX >= a1->x )
          a1->xm += 32;
        else
          a1->xm -= 32;
        if ( a1->xm < -1024 )
          a1->xm = -1024;
        if ( a1->xm > 1024 )
          a1->xm = 1024;
        a1->ym += 64;
      }
      if ( ++a1->count3 > 1 )
      {
        a1->count3 = 0;
        ++a1->count2;
      }
      if ( a1->count2 > 5 )
        a1->count2 = 3;
      if ( a1->cond & 0x10 )
      {
        a1->cond &= 0xFFFFFFEF;
        a1->xm = 1024;
      }
      if ( a1->cond & 0x20 )
      {
        a1->cond &= 0xFFFFFFDF;
        a1->xm = -1024;
      }
      if ( a1->cond & 0x40 )
      {
        a1->cond &= 0xFFFFFFBF;
        a1->ym = 1024;
      }
      if ( a1->cond & 0x80 )
      {
        a1->cond &= 0xFFFFFF7F;
        a1->ym = -1024;
      }
      if ( a1->y > 180224 )
        a1->cond = 0;
      break;
    default:
      break;
  }
  a1->x += a1->xm;
  a1->y += a1->ym;
  v1 = &v4 + 4 * a1->count2;
  v2 = (char *)&a1->rect;
  *(_DWORD *)v2 = *v1;
  *((_DWORD *)v2 + 1) = v1[1];
  *((_DWORD *)v2 + 2) = v1[2];
  *((_DWORD *)v2 + 3) = v1[3];
  result = (NPCHAR *)(a1->shock / 2 % 2);
  if ( result )
  {
    a1->rect.top += 24;
    a1->rect.bottom += 24;
    result = a1;
    a1->xm *= 2;
    a1->ym = -1024;
  }
  return result;
}


NPCHAR *ActNpc060_PowerupBox(NPCHAR *o)
{
  NPCHAR *result; 
  char *v2; 
  char *v3; 
  int o_x; 
  int o_y; 

  o_x = o->x;
  o_y = o->y;
  SubStageXOScroll(&o_x, &o_y);
  if ( o->life > 999 )
  {
    if ( !o->state )
    {
      o->state = 10;
      o->flag |= 1u;
    }
    if ( ++o->count3 > 8 )
    {
      o->count3 = 0;
      ++o->count2;
    }
    if ( o->count2 > 1 )
      o->count2 = 0;
    v2 = (char *)&Npc060Attr + 16 * o->count2;
    v3 = (char *)&o->rect;
    *(_DWORD *)v3 = *(_DWORD *)v2;
    *((_DWORD *)v3 + 1) = *((_DWORD *)v2 + 1);
    *((_DWORD *)v3 + 2) = *((_DWORD *)v2 + 2);
    result = (NPCHAR *)*((_DWORD *)v2 + 3);
    *((_DWORD *)v3 + 3) = result;
    if ( o_y > 180224 )
      o->cond = 0;
  }
  else
  {
    PlaySound(11);
    AddScore(o->score);
    if ( o->type2 )
      CreateEntity(61, o_x, o_y, o->type2);
    if ( o->score )
      CreateCaret(0, o_x, o_y, o->score);
    CreateEntity(1, o_x, o_y, 0);
    result = o;
    o->cond = 0;
  }
  return result;
}


LONG *ActNpc061_PowerupStatic(NPCHAR *a1)
{
  int *v1; 
  LONG *result; 
  int v3; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 

  v4 = 240;
  v5 = 48;
  v6 = 256;
  v7 = 64;
  v8 = 240;
  v9 = 64;
  v10 = 256;
  v11 = 80;
  v12 = 240;
  v13 = 80;
  v14 = 256;
  v15 = 96;
  v16 = a1->x;
  v17 = a1->y;
  SubStageXOScroll(&v16, &v17);
  v3 = a1->state;
  if ( v3 )
  {
    if ( v3 != 10 )
      goto LABEL_9;
  }
  else
  {
    a1->state = 10;
    CreateEntity(62, 0, 0, (int)a1);
    a1->flag |= 2u;
  }
  if ( ++a1->count3 > 2 )
  {
    a1->count3 = 0;
    ++a1->count2;
  }
  if ( a1->count2 > 2 )
    a1->count2 = 0;
LABEL_9:
  if ( a1->score )
  {
    if ( ++a1->count1 == 16 )
    {
      a1->count1 = 0;
      --a1->score;
    }
  }
  if ( v17 > 180224 )
    a1->cond = 0;
  v1 = &v4 + 4 * a1->count2;
  result = &a1->rect.left;
  *result = *v1;
  result[1] = v1[1];
  result[2] = v1[2];
  result[3] = v1[3];
  return result;
}


int ActNpc063_BulletWhite(NPCHAR *a1)
{
  int result; 
  char *v2; 
  char *v3; 
  int v4; 

  v4 = a1->state;
  if ( v4 )
  {
    if ( v4 != 10 )
      goto LABEL_9;
  }
  else
  {
    a1->flag |= 0x43u;
    a1->xm = 3 * GetCos(a1->type2);
    a1->ym = 3 * GetSin(a1->type2);
    a1->state = 10;
  }
  if ( ++a1->count1 > 4 && a1->cond & 0xF0 )
  {
    CreateCaret(1, a1->x, a1->y, 0);
    result = PlaySound(20);
    a1->cond = 0;
    return result;
  }
  a1->x += a1->xm;
  a1->y += a1->ym;
LABEL_9:
  ++a1->count3;
  if ( a1->x < -65536 || a1->x > 188416 || a1->y < -65536 || a1->y > 229376 )
    a1->cond = 0;
  v2 = (char *)&unk_43B610 + 16 * (a1->count3 / 2 % 2);
  v3 = (char *)&a1->rect;
  *(_DWORD *)v3 = *(_DWORD *)v2;
  *((_DWORD *)v3 + 1) = *((_DWORD *)v2 + 1);
  *((_DWORD *)v3 + 2) = *((_DWORD *)v2 + 2);
  result = *((_DWORD *)v2 + 3);
  *((_DWORD *)v3 + 3) = result;
  return result;
}


int *ActNpc064_PowerupSpinner(NPCHAR *a1)
{
  int *result; 
  int *v2; 
  char *v3; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 
  int v23; 
  int v24; 
  int v25; 
  int v26; 
  int v27; 

  v4 = 48;
  v5 = 112;
  v6 = 72;
  v7 = 136;
  v8 = 72;
  v9 = 112;
  v10 = 96;
  v11 = 136;
  v12 = 96;
  v13 = 112;
  v14 = 120;
  v15 = 136;
  v16 = 48;
  v17 = 136;
  v18 = 72;
  v19 = 160;
  v20 = 72;
  v21 = 136;
  v22 = 96;
  v23 = 160;
  v24 = 96;
  v25 = 136;
  v26 = 120;
  v27 = 160;
  if ( a1->life > 994 )
  {
    switch ( a1->state )
    {
      case 0:
        a1->state = 10;
        a1->y = 163840;
        a1->ym = -6144;
        CreateEntity(50, 0, 0, (int)a1);
        a1->life = 995;
        a1->score = 0;
        PlaySound(26);
        goto LABEL_5;
      case 0xA:
LABEL_5:
        a1->ym += 113;
        if ( ++a1->count3 > 2 )
        {
          a1->count3 = 0;
          ++a1->count2;
        }
        if ( a1->count2 > 2 )
          a1->count2 = 0;
        if ( a1->ym > 0 )
          goto LABEL_10;
        break;
      case 0x14:
LABEL_10:
        a1->state = 30;
        a1->flag |= 0x43u;
        a1->damage = 1;
        goto LABEL_11;
      case 0x1E:
LABEL_11:
        a1->ym += 42;
        if ( ++a1->count3 > 1 )
        {
          a1->count3 = 0;
          ++a1->count2;
        }
        if ( a1->count2 > 5 )
          a1->count2 = 3;
        if ( a1->cond & 0x10 )
        {
          a1->cond &= 0xFFFFFFEF;
          a1->xm = 1024;
        }
        if ( a1->cond & 0x20 )
        {
          a1->cond &= 0xFFFFFFDF;
          a1->xm = -1024;
        }
        if ( a1->cond & 0x40 )
        {
          a1->cond &= 0xFFFFFFBF;
          a1->ym = 1024;
        }
        if ( a1->cond & 0x80 )
        {
          a1->cond &= 0xFFFFFF7F;
          a1->ym = -1024;
        }
        if ( a1->y > 180224 )
          a1->cond = 0;
        break;
      default:
        break;
    }
    a1->x += a1->xm;
    a1->y += a1->ym;
    v2 = &v4 + 4 * a1->count2;
    v3 = (char *)&a1->rect;
    *(_DWORD *)v3 = *v2;
    *((_DWORD *)v3 + 1) = v2[1];
    *((_DWORD *)v3 + 2) = v2[2];
    result = (int *)v2[3];
    *((_DWORD *)v3 + 3) = result;
  }
  else
  {
    PlaySound(11);
    CreateEntity(7, a1->x, a1->y, a1->type2);
    result = CreateEntity(1, a1->x, a1->y, 0);
    a1->cond = 0;
  }
  return result;
}


int ActNpc065_ClimberShoot(int nHeight)
{
  int v1; 
  int result; 
  int *v3; 
  int v4; 
  int v5; 
  int x; 
  int y; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  int v22; 
  int v23; 
  int v24; 
  int v25; 
  int v26; 
  int v27; 
  int v28; 
  int v29; 
  int v30; 
  int v31; 

  v8 = 0;
  v9 = 0;
  v10 = 16;
  v11 = 24;
  v12 = 16;
  v13 = 0;
  v14 = 32;
  v15 = 24;
  v16 = 32;
  v17 = 0;
  v18 = 48;
  v19 = 24;
  v20 = 48;
  v21 = 0;
  v22 = 64;
  v23 = 24;
  v24 = 64;
  v25 = 0;
  v26 = 80;
  v27 = 24;
  v28 = 80;
  v29 = 0;
  v30 = 96;
  v31 = 24;
  x = *(_DWORD *)(nHeight + 4);
  y = *(_DWORD *)(nHeight + 8);
  SubStageXOScroll(&x, &y);
  v5 = *(_DWORD *)(nHeight + 44);
  if ( v5 )
  {
    if ( v5 != 10 )
    {
      if ( v5 == 20 )
      {
        if ( ++*(_DWORD *)(nHeight + 56) > 1 )
        {
          *(_DWORD *)(nHeight + 56) = 0;
          ++*(_DWORD *)(nHeight + 52);
        }
        if ( *(_DWORD *)(nHeight + 52) > 4 )
          *(_DWORD *)(nHeight + 52) = 3;
        *(_DWORD *)(nHeight + 16) += 64;
        if ( ++*(_DWORD *)(nHeight + 48) == 10 )
        {
          CreateCaret(1, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), nHeight);
          PlaySound(30);
        }
        if ( *(_DWORD *)(nHeight + 48) == 26 )
        {
          *(_DWORD *)(nHeight + 84) = (unsigned __int8)GetArktan(x - (_DWORD)ShipX, y - ShipY, 64);
          CreateEntity(13, x, y, *(_BYTE *)(nHeight + 84));
          PlaySound(7);
        }
        if ( y > 180224 )
          *(_DWORD *)nHeight = 0;
      }
      goto LABEL_23;
    }
  }
  else
  {
    *(_DWORD *)(nHeight + 44) = 10;
    *(_DWORD *)(nHeight + 8) = 180224;
    AddStageXOScroll(0, (_DWORD *)(nHeight + 8));
  }
  if ( ++*(_DWORD *)(nHeight + 56) > 1 )
  {
    *(_DWORD *)(nHeight + 56) = 0;
    ++*(_DWORD *)(nHeight + 52);
  }
  if ( *(_DWORD *)(nHeight + 52) > 2 )
    *(_DWORD *)(nHeight + 52) = 0;
  *(_DWORD *)(nHeight + 16) = -3072;
  x = *(_DWORD *)(nHeight + 4);
  y = *(_DWORD *)(nHeight + 8);
  SubStageXOScroll(&x, &y);
  if ( y < 0x8000 )
  {
    *(_DWORD *)(nHeight + 44) = 20;
    *(_DWORD *)(nHeight + 16) = -3584;
    *(_DWORD *)(nHeight + 52) = 3;
    PlaySound(26);
    CreateEntity(1, x, y, 0);
    *(_DWORD *)(nHeight + 68) |= 3u;
  }
LABEL_23:
  *(_DWORD *)(nHeight + 8) += *(_DWORD *)(nHeight + 16);
  if ( *(_DWORD *)(nHeight + 72) / 2 % 2 )
  {
    v1 = nHeight + 104;
    *(_DWORD *)v1 = v28;
    *(_DWORD *)(v1 + 4) = v29;
    *(_DWORD *)(v1 + 8) = v30;
    result = v31;
    *(_DWORD *)(v1 + 12) = v31;
  }
  else
  {
    v3 = &v8 + 4 * *(_DWORD *)(nHeight + 52);
    v4 = nHeight + 104;
    *(_DWORD *)v4 = *v3;
    *(_DWORD *)(v4 + 4) = v3[1];
    *(_DWORD *)(v4 + 8) = v3[2];
    result = v3[3];
    *(_DWORD *)(v4 + 12) = result;
  }
  return result;
}


int ActNpc066_Tri(int nHeight)
{
  int v1; 
  int result; 
  int *v3; 
  int v4; 
  int v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  unsigned __int8 v17; 

  v5 = 0;
  v6 = 24;
  v7 = 32;
  v8 = 48;
  v9 = 32;
  v10 = 24;
  v11 = 64;
  v12 = 48;
  v13 = 64;
  v14 = 24;
  v15 = 96;
  v16 = 48;
  switch ( *(_DWORD *)(nHeight + 44) )
  {
    case 0:
      *(_DWORD *)(nHeight + 44) = 10;
      *(_DWORD *)(nHeight + 84) = *(_DWORD *)(nHeight + 4);
      *(_DWORD *)(nHeight + 8) = 122880;
      *(_DWORD *)(nHeight + 68) &= 0xFFFFFFFC;
      *(_DWORD *)(nHeight + 68) |= 8u;
      if ( *(_DWORD *)(nHeight + 4) >= 61440 )
        *(_DWORD *)(nHeight + 88) = 139264;
      else
        *(_DWORD *)(nHeight + 88) = -16384;
      *(_DWORD *)(nHeight + 16) = -1024;
      goto LABEL_6;
    case 0xA:
LABEL_6:
      *(_DWORD *)(nHeight + 4) = *(_DWORD *)(nHeight + 88)
                               + ++*(_DWORD *)(nHeight + 48)
                               * (*(_DWORD *)(nHeight + 84) - *(_DWORD *)(nHeight + 88))
                               / 80;
      if ( *(_DWORD *)(nHeight + 48) >= 80 )
      {
        *(_DWORD *)(nHeight + 48) = 0;
        *(_DWORD *)(nHeight + 44) = 20;
        *(_DWORD *)(nHeight + 52) = 1;
        *(_DWORD *)(nHeight + 16) = -256;
        *(_DWORD *)(nHeight + 68) |= 3u;
        *(_DWORD *)(nHeight + 68) &= 0xFFFFFFF7;
        CreateCaret(1, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8) - 1024, nHeight);
        PlaySound(30);
      }
      break;
    case 0x14:
      if ( ++*(_DWORD *)(nHeight + 48) == 16 )
      {
        v17 = GetArktan(*(_DWORD *)(nHeight + 4) - (_DWORD)ShipX, *(_DWORD *)(nHeight + 8) - 1024 - ShipY, 64);
        CreateEntity(13, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8) - 1024, v17);
        CreateEntity(13, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8) - 1024, v17 - 10);
        CreateEntity(13, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8) - 1024, v17 + 10);
        PlaySound(7);
      }
      if ( *(_DWORD *)(nHeight + 48) > 66 )
        *(_DWORD *)(nHeight + 44) = 30;
      break;
    case 0x1E:
      *(_DWORD *)(nHeight + 16) -= 32;
      if ( *(_DWORD *)(nHeight + 8) < -16384 )
        *(_DWORD *)nHeight = 0;
      break;
    default:
      break;
  }
  *(_DWORD *)(nHeight + 8) += *(_DWORD *)(nHeight + 16);
  if ( *(_DWORD *)(nHeight + 72) / 2 % 2 )
  {
    v1 = nHeight + 104;
    *(_DWORD *)v1 = v13;
    *(_DWORD *)(v1 + 4) = v14;
    result = v15;
    *(_DWORD *)(v1 + 8) = v15;
    *(_DWORD *)(v1 + 12) = v16;
  }
  else
  {
    v3 = &v5 + 4 * *(_DWORD *)(nHeight + 52);
    v4 = nHeight + 104;
    *(_DWORD *)v4 = *v3;
    *(_DWORD *)(v4 + 4) = v3[1];
    result = v3[2];
    *(_DWORD *)(v4 + 8) = result;
    *(_DWORD *)(v4 + 12) = v3[3];
  }
  return result;
}


NPCHAR *ActNpc067_GuxtTank(NPCHAR *o)
{
  int v1; 
  char *v2; 
  int *v3; 
  char *v4; 
  NPCHAR *result; 
  int v6; 
  int x; 
  int y; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  unsigned __int8 v21; 

  v9 = 0;
  v10 = 48;
  v11 = 32;
  v12 = 64;
  v13 = 32;
  v14 = 48;
  v15 = 64;
  v16 = 64;
  v17 = 64;
  v18 = 48;
  v19 = 96;
  v20 = 64;
  x = o->x;
  y = o->y;
  SubStageXOScroll(&x, &y);
  v6 = o->state;
  if ( v6 )
  {
    if ( v6 != 10 )
      goto LABEL_18;
  }
  else
  {
    o->state = 10;
    o->flag |= 1u;
    if ( x >= 61440 )
    {
      o->x = 139264;
      o->xm = -512;
    }
    else
    {
      o->x = -16384;
      o->xm = 512;
    }
    AddStageXOScroll(&o->x, 0);
    o->y += o->type2 << 13;
  }
  if ( ++o->count1 == 50 )
  {
    CreateCaret(1, o->x, o->y - 1024, (int)o);
    PlaySound(30);
  }
  else if ( o->count1 == 66 )
  {
    v21 = GetArktan(x - (_DWORD)ShipX, y - 1024 - ShipY, 64);
    CreateEntity(13, x, y - 1024, v21);
    PlaySound(7);
  }
  v1 = o->count3++;
  if ( v1 > 0 )
  {
    o->count3 = 0;
    ++o->count2;
  }
  if ( o->count2 > 1 )
    o->count2 = 0;
  o->x += o->xm;
  if ( y > 180224 )
    o->cond = 0;
LABEL_18:
  if ( o->shock / 2 % 2 )
  {
    v2 = (char *)&o->rect;
    *(_DWORD *)v2 = v17;
    *((_DWORD *)v2 + 1) = v18;
    *((_DWORD *)v2 + 2) = v19;
    *((_DWORD *)v2 + 3) = v20;
  }
  else
  {
    v3 = &v9 + 4 * o->count2;
    v4 = (char *)&o->rect;
    *(_DWORD *)v4 = *v3;
    *((_DWORD *)v4 + 1) = v3[1];
    *((_DWORD *)v4 + 2) = v3[2];
    *((_DWORD *)v4 + 3) = v3[3];
  }
  result = o;
  if ( o->xm > 0 )
  {
    o->rect.top += 16;
    result = o;
    o->rect.bottom += 16;
  }
  return result;
}


int ActNpc068_MedusaEye(NPCHAR *a1)
{
  char v1; 
  char *v2; 
  char *v3; 
  char *v4; 
  int result; 
  int x; 
  int y; 
  int a1a; 
  int v9; 

  x = a1->x;
  y = a1->y;
  SubStageXOScroll(&x, &y);
  switch ( a1->state )
  {
    case 0:
      a1->state = 10;
      a1->count1 = 25 * a1->type2;
      goto LABEL_3;
    case 0xA:
LABEL_3:
      if ( !--a1->count1 )
      {
        a1->state = 20;
        PlaySound(38);
      }
      break;
    case 0x14:
      if ( ++a1->count3 > 2 )
      {
        a1->count3 = 0;
        ++a1->count2;
      }
      if ( a1->count2 == 2 )
      {
        a1->state = 30;
        a1->count1 = 0;
        CreateCaret(4, a1->x, a1->y, (int)a1);
        PlaySound(31);
        a1->flag |= 1u;
      }
      break;
    case 0x1E:
      if ( ++a1->count1 > 14 && !(a1->count1 % 16) )
      {
        v1 = GetArktan(x - (_DWORD)ShipX, y - ShipY, 64);
        CreateEntity(13, x, y, (unsigned __int8)v1);
        PlaySound(7);
      }
      if ( ++a1->count3 > 2 )
      {
        a1->count3 = 0;
        ++a1->count2;
      }
      if ( a1->count2 > 4 )
        a1->count2 = 2;
      break;
    default:
      break;
  }
  if ( a1->shock / 2 % 2 )
  {
    v2 = (char *)&a1->rect;
    *(_DWORD *)v2 = 224;
    *((_DWORD *)v2 + 1) = 96;
    *((_DWORD *)v2 + 2) = 240;
    *((_DWORD *)v2 + 3) = 112;
  }
  else
  {
    v3 = (char *)&unk_43B630 + 16 * a1->count2;
    v4 = (char *)&a1->rect;
    *(_DWORD *)v4 = *(_DWORD *)v3;
    *((_DWORD *)v4 + 1) = *((_DWORD *)v3 + 1);
    *((_DWORD *)v4 + 2) = *((_DWORD *)v3 + 2);
    *((_DWORD *)v4 + 3) = *((_DWORD *)v3 + 3);
  }
  AlignStageScroll((NPCHAR *)&a1a);
  result = v9 + 0x2000;
  if ( a1->y > v9 + 0x2000 )
    a1->cond = 0;
  return result;
}


_DWORD *ActNpc069_GuxtMine(int nHeight)
{
  _DWORD *result; 
  int v2; 
  int v3; 
  int v4; 
  int v5; 
  int v6; 
  signed int i; 
  int x; 
  int y; 

  if ( *(_DWORD *)(nHeight + 44) < 100 && *(_DWORD *)(nHeight + 60) <= 86 )
  {
    *(_DWORD *)(nHeight + 44) = 100;
    *(_DWORD *)(nHeight + 48) = 0;
    *(_DWORD *)(nHeight + 72) = 0;
    *(_DWORD *)(nHeight + 68) &= 0xFFFFFFFE;
    CreateCaret(4, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), nHeight);
    PlaySound(30);
  }
  v6 = *(_DWORD *)(nHeight + 44);
  if ( v6 )
  {
    if ( v6 == 100 && ++*(_DWORD *)(nHeight + 48) >= 14 )
    {
      x = *(_DWORD *)(nHeight + 4);
      y = *(_DWORD *)(nHeight + 8);
      SubStageXOScroll(&x, &y);
      for ( i = 0; i < 4; ++i )
        CreateEntity(13, x, y, (unsigned __int8)(((_BYTE)i << 6) + 32));
      PlaySound(12);
      CreateEntity(1, x, y, 0);
      AddScore(*(_DWORD *)(nHeight + 76));
      CreateCaret(0, x, y, *(_DWORD *)(nHeight + 76));
      result = (_DWORD *)nHeight;
      *(_DWORD *)(nHeight + 44) = 110;
      return result;
    }
  }
  else
  {
    *(_DWORD *)(nHeight + 44) = 10;
    *(_DWORD *)(nHeight + 84) = *(_DWORD *)(nHeight + 60) - 24;
    *(_DWORD *)(nHeight + 68) |= 1u;
  }
  if ( *(_DWORD *)(nHeight + 44) == 100 )
  {
    v2 = nHeight + 104;
    *(_DWORD *)v2 = 112;
    *(_DWORD *)(v2 + 4) = 0;
    *(_DWORD *)(v2 + 8) = 128;
    *(_DWORD *)(v2 + 12) = 24;
  }
  else if ( *(_DWORD *)(nHeight + 44) == 110 )
  {
    v3 = nHeight + 104;
    *(_DWORD *)v3 = 144;
    *(_DWORD *)(v3 + 4) = 0;
    *(_DWORD *)(v3 + 8) = 160;
    *(_DWORD *)(v3 + 12) = 24;
  }
  else if ( *(_DWORD *)(nHeight + 72) / 2 % 2 )
  {
    v4 = nHeight + 104;
    *(_DWORD *)v4 = 128;
    *(_DWORD *)(v4 + 4) = 0;
    *(_DWORD *)(v4 + 8) = 144;
    *(_DWORD *)(v4 + 12) = 24;
  }
  else
  {
    v5 = nHeight + 104;
    *(_DWORD *)v5 = 96;
    *(_DWORD *)(v5 + 4) = 0;
    *(_DWORD *)(v5 + 8) = 112;
    *(_DWORD *)(v5 + 12) = 24;
  }
  y = *(_DWORD *)(nHeight + 8);
  result = SubStageXOScroll(0, &y);
  if ( y >= 180224 )
    *(_DWORD *)nHeight = 0;
  return result;
}


int ActNpc070_BlendyGen(NPCHAR *a1)
{
  char *v1; 
  char *v2; 
  int result; 

  if ( !a1->state )
  {
    a1->state = 10;
    a1->y = -49152;
    a1->child = 2;
    a1->rot1 = a1->life--;
    if ( a1->type2 & 256 )
      a1->count4 = 1024;
    else
      a1->count4 = 256;
    a1->type2 &= 255u;
    CreateEntity(71, 0, 0, (int)a1);
    CreateEntity(71, 0, 0, (int)a1);
    CreateEntity(71, 0, 0, (int)a1);
    CreateEntity(71, 0, 0, (int)a1);
  }
  a1->y += a1->count4;
  if ( a1->y > 212992 )
    a1->cond = 0;
  v1 = (char *)&unk_43B6D0 + 16 * (3 * a1->life / a1->rot1);
  v2 = (char *)&a1->rect;
  *(_DWORD *)v2 = *(_DWORD *)v1;
  *((_DWORD *)v2 + 1) = *((_DWORD *)v1 + 1);
  *((_DWORD *)v2 + 2) = *((_DWORD *)v1 + 2);
  *((_DWORD *)v2 + 3) = *((_DWORD *)v1 + 3);
  result = a1->shock / 2 % 2;
  if ( result )
  {
    a1->rect.top += 24;
    result = a1->rect.bottom + 24;
    a1->rect.bottom = result;
  }
  return result;
}


int *ActNpc071_Blendy(NPCHAR *a1)
{
  unsigned __int8 v1; 
  int *result; 
  int *v3; 
  char *v4; 
  int v5; 
  int v6; 

  v6 = a1->type2;
  v5 = a1->state;
  if ( !v5 )
  {
    a1->state = 10;
    if ( *(_DWORD *)(v6 + 80) < 8 )
    {
      a1->child = 32 * *(_DWORD *)(v6 + 80);
      a1->xm = 2;
    }
    else
    {
      a1->child = 32 * (*(_DWORD *)(v6 + 80) - 8);
      a1->xm = -2;
    }
    if ( *(_DWORD *)(v6 + 84) >= 5 )
    {
      a1->rot1 = 40;
      a1->count2 = 1;
      a1->flag |= 0xAu;
      a1->xoff = 0x2000;
      a1->yoff = 0x2000;
    }
    else
    {
      a1->rot1 = 8 * *(_DWORD *)(v6 + 84);
    }
    a1->count4 = *(_DWORD *)(v6 + 96);
    ++*(_DWORD *)(v6 + 84);
    goto LABEL_12;
  }
  if ( v5 == 10 )
  {
LABEL_12:
    if ( a1->count4 == *(_DWORD *)(v6 + 96) && *(_DWORD *)v6 )
    {
      a1->child += a1->xm;
      ++a1->count3;
      a1->child %= 256;
      v1 = a1->child;
      a1->x = *(_DWORD *)(v6 + 4) + a1->rot1 * GetCos(v1);
      a1->y = *(_DWORD *)(v6 + 8) + a1->rot1 * GetSin(v1);
      goto LABEL_23;
    }
    if ( a1->y > 172032 )
    {
      a1->cond = 0;
      goto LABEL_23;
    }
    a1->state = 100;
    a1->count1 = 4 * a1->rot1 / 4 - 16;
    a1->flag &= 0xFFFFFFFD;
    a1->count3 = 0;
    goto LABEL_18;
  }
  if ( v5 != 100 )
  {
LABEL_23:
    if ( a1->count2 )
    {
      v3 = &dword_43B700[4 * (a1->count3 / 4 % 2 + 1)];
      v4 = (char *)&a1->rect;
      *(_DWORD *)v4 = *v3;
      *((_DWORD *)v4 + 1) = v3[1];
      *((_DWORD *)v4 + 2) = v3[2];
      *((_DWORD *)v4 + 3) = v3[3];
      result = (int *)a1;
      ++a1->count3;
    }
    else
    {
      result = (int *)&a1->rect.left;
      *result = 144;
      result[1] = 40;
      result[2] = 152;
      result[3] = 48;
    }
    return result;
  }
LABEL_18:
  if ( --a1->count1 >= 1 )
    goto LABEL_23;
  if ( a1->rot1 == 40 )
  {
    PlaySound(13);
    result = CreateEntity(1, a1->x, a1->y, 0);
  }
  else
  {
    PlaySound(15);
    result = (int *)CreateCaret(2, a1->x, a1->y, 0);
  }
  a1->cond = 0;
  return result;
}



int ActNpc072_Cycloid2(int a1)
{
  unsigned __int8 v1; 
  int result; 
  __int64 v3; 
  int v4; 
  int v5; 
  char v6; 
  unsigned __int8 v7; 

  v5 = *(_DWORD *)(a1 + 44);
  if ( v5 )
  {
    if ( v5 != 10 )
    {
      if ( v5 != 20 )
        goto LABEL_14;
      goto LABEL_10;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 44) = 10;
    *(_DWORD *)(a1 + 84) = 64;
    *(_DWORD *)(a1 + 8) = -8192;
    *(_DWORD *)(a1 + 68) |= 2u;
    PlaySound(26);
  }
  if ( *(_DWORD *)(a1 + 8) < 24576 )
    goto LABEL_14;
  *(_DWORD *)(a1 + 44) = 20;
  if ( *(_DWORD *)(a1 + 4) >= 61440 )
    *(_DWORD *)(a1 + 88) = 8;
  else
    *(_DWORD *)(a1 + 88) = -8;
LABEL_10:
  *(_DWORD *)(a1 + 84) += *(_DWORD *)(a1 + 88);
  *(_DWORD *)(a1 + 84) = *(_BYTE *)(a1 + 84);
  if ( ++*(_DWORD *)(a1 + 48) > 50 )
  {
    v7 = *(_BYTE *)(a1 + 84);
    v6 = GetArktan(*(_DWORD *)(a1 + 4) - (_DWORD)ShipX, *(_DWORD *)(a1 + 8) - ShipY, 64);
    if ( v7 <= (unsigned __int8)v6 + 8 && v7 > (unsigned __int8)v6 - 8 )
    {
      *(_DWORD *)(a1 + 44) = 30;
      *(_DWORD *)(a1 + 84) = (unsigned __int8)v6;
    }
  }
LABEL_14:
  v1 = *(_BYTE *)(a1 + 84);
  *(_DWORD *)(a1 + 4) += 3 * GetCos(v1);
  *(_DWORD *)(a1 + 8) += 3 * GetSin(v1);
  result = a1;
  if ( *(_DWORD *)(a1 + 44) != 30
    || *(_DWORD *)(a1 + 4) >= -8192
    && *(_DWORD *)(a1 + 4) <= 0x20000
    && (result = a1, *(_DWORD *)(a1 + 4) >= -8192)
    && *(_DWORD *)(a1 + 4) <= 0x20000 )
  {
    v3 = *(_BYTE *)(a1 + 84) + 16;
    *(_DWORD *)(a1 + 52) = ((((BYTE4(v3) & 0x1F) + (signed int)v3) >> 5) + 2) % 8;
    LODWORD(v3) = (char *)&unk_43B730 + 16 * *(_DWORD *)(a1 + 52);
    v4 = a1 + 104;
    *(_DWORD *)v4 = *(_DWORD *)v3;
    *(_DWORD *)(v4 + 4) = *(_DWORD *)(v3 + 4);
    *(_DWORD *)(v4 + 8) = *(_DWORD *)(v3 + 8);
    result = *(_DWORD *)(v3 + 12);
    *(_DWORD *)(v4 + 12) = result;
    if ( *(_DWORD *)(a1 + 60) != 5 )
    {
      if ( *(_DWORD *)(a1 + 72) / 2 % 2 )
      {
        *(_DWORD *)(a1 + 108) -= 16;
        result = a1;
        *(_DWORD *)(a1 + 116) -= 16;
      }
      else
      {
        *(_DWORD *)(a1 + 108) -= 32;
        result = a1;
        *(_DWORD *)(a1 + 116) -= 32;
      }
    }
  }
  else
  {
    *(_DWORD *)a1 = 0;
  }
  return result;
}


int ActNpc073_Cycloid2Gen(int a1)
{
  int result; 

  if ( ++*(_DWORD *)(a1 + 48) % 8 == 1 )
    CreateEntity(72, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), 0);
  result = a1;
  if ( *(_DWORD *)(a1 + 48) > 24 )
    *(_DWORD *)a1 = 0;
  return result;
}


int ActNpc074_PowerupHidden(int a1)
{
  int result; 
  HBITMAP hBitmap; 
  int nWidth; 

  hBitmap = *(HBITMAP *)(a1 + 4);
  nWidth = *(_DWORD *)(a1 + 8);
  SubStageXOScroll(&hBitmap, &nWidth);
  result = a1;
  if ( *(_DWORD *)(a1 + 60) > 952 )
  {
    if ( !*(_DWORD *)(a1 + 44) )
    {
      *(_DWORD *)(a1 + 44) = 10;
      result = a1;
      *(_DWORD *)(a1 + 68) |= 1u;
    }
    if ( nWidth > 180224 )
      *(_DWORD *)a1 = 0;
  }
  else
  {
    PlaySound(11);
    AddScore(*(_DWORD *)(a1 + 76));
    if ( *(_DWORD *)(a1 + 80) )
      CreateEntity(61, (int)hBitmap, nWidth, *(_DWORD *)(a1 + 80));
    if ( *(_DWORD *)(a1 + 76) )
      CreateCaret(0, (int)hBitmap, nWidth, *(_DWORD *)(a1 + 76));
    CreateEntity(1, (int)hBitmap, nWidth, 0);
    result = a1;
    *(_DWORD *)a1 = 0;
  }
  return result;
}


NPCHAR *ActNpc075_PowerupAsteroid(NPCHAR *a1)
{
  NPCHAR *result; 
  int v2; 

  if ( a1->life < 82 )
  {
    CreateEntity(23, a1->x - 4096, a1->y - 4096, 0);
    CreateEntity(23, a1->x + 4096, a1->y - 4096, 1);
    CreateEntity(23, a1->x - 4096, a1->y + 4096, 2);
    CreateEntity(23, a1->x + 4096, a1->y + 4096, 3);
    PlaySound(12);
    CreateEntity(1, a1->x, a1->y, 0);
    CreateEntity(7, a1->x, a1->y, a1->type2);
    result = a1;
    a1->cond = 0;
    return result;
  }
  v2 = a1->state;
  if ( !v2 )
  {
    a1->state = 1;
    a1->y -= 0x2000;
    a1->ym = 1024;
LABEL_7:
    a1->y += a1->ym;
    if ( a1->y > 180224 )
      a1->cond = 0;
    goto LABEL_9;
  }
  if ( v2 == 1 )
    goto LABEL_7;
LABEL_9:
  if ( a1->shock / 2 % 2 )
  {
    result = (NPCHAR *)((char *)a1 + 104);
    result->cond = 32;
    result->x = 160;
    result->y = 64;
    result->xm = 192;
  }
  else
  {
    result = (NPCHAR *)((char *)a1 + 104);
    result->cond = 80;
    result->x = 160;
    result->y = 112;
    result->xm = 192;
  }
  return result;
}


int ActNpc076_Boss4(int a1)
{
  int v1; 
  int result; 
  int v3; 
  __int16 v4; 
  int v5; 
  signed int v6; 
  signed int i; 

  if ( (*(_DWORD *)(a1 + 44) == 112 || *(_DWORD *)(a1 + 44) == 122)
    && *(_DWORD *)(a1 + 68) & 8
    && *(_DWORD *)(a1 + 60) <= 680
    && *(_DWORD *)(a1 + 4) == 61440 )
  {
    *(_DWORD *)(a1 + 48) = 0;
    *(_DWORD *)(a1 + 44) = 200;
  }
  if ( *(_DWORD *)(a1 + 44) == 210 && *(_DWORD *)(a1 + 68) & 8 && *(_DWORD *)(a1 + 60) <= 520 )
  {
    *(_DWORD *)(a1 + 44) = 300;
    *(_DWORD *)(a1 + 48) = 0;
    *(_DWORD *)(a1 + 12) = 0;
    *(_DWORD *)(a1 + 16) = 0;
    PlayLoopSound(32);
  }
  v6 = *(_DWORD *)(a1 + 44);
  if ( v6 > 112 )
  {
    switch ( v6 )
    {
      case 113:
        goto LABEL_83;
      case 120:
        *(_DWORD *)(a1 + 44) = 120;
        if ( *(_DWORD *)(a1 + 4) >= 94208 )
          goto LABEL_91;
        *(_DWORD *)(a1 + 4) += 512;
        break;
      case 121:
LABEL_91:
        *(_DWORD *)(a1 + 44) = 121;
        if ( *(_DWORD *)(a1 + 8) <= 28672 )
          goto LABEL_93;
        *(_DWORD *)(a1 + 8) -= 1024;
        break;
      case 122:
LABEL_93:
        *(_DWORD *)(a1 + 44) = 122;
        if ( *(_DWORD *)(a1 + 4) <= 28672 )
          goto LABEL_95;
        *(_DWORD *)(a1 + 4) -= 512;
        break;
      case 123:
LABEL_95:
        *(_DWORD *)(a1 + 44) = 123;
        if ( *(_DWORD *)(a1 + 8) >= 135168 )
        {
          *(_DWORD *)(a1 + 44) = 120;
          if ( *(_DWORD *)(a1 + 60) > 680 && *(_DWORD *)(a1 + 68) & 8 )
          {
            PlaySound(38);
            *(_DWORD *)(a1 + 68) &= 0xFFFFFFF7;
            *(_DWORD *)(a1 + 68) |= 1u;
          }
        }
        else
        {
          *(_DWORD *)(a1 + 8) += 1024;
        }
        break;
      case 200:
        *(_DWORD *)(a1 + 88) -= 4;
        if ( *(_DWORD *)(a1 + 88) < 0 )
          *(_DWORD *)(a1 + 88) += 256;
        if ( ++*(_DWORD *)(a1 + 48) > 200 )
        {
          *(_DWORD *)(a1 + 48) = 0;
          *(_DWORD *)(a1 + 44) = 210;
          PlaySound(38);
          *(_DWORD *)(a1 + 68) &= 0xFFFFFFF7;
          *(_DWORD *)(a1 + 68) |= 1u;
          if ( *(_DWORD *)(a1 + 4) >= (signed int)ShipX )
            *(_DWORD *)(a1 + 12) = 1024;
          else
            *(_DWORD *)(a1 + 12) = -1024;
          *(_DWORD *)(a1 + 16) = 0;
        }
        break;
      case 210:
        *(_DWORD *)(a1 + 88) += 8;
        if ( *(_DWORD *)(a1 + 88) >= 256 )
          *(_DWORD *)(a1 + 88) -= 256;
        if ( *(_DWORD *)(a1 + 4) < (signed int)ShipX )
          *(_DWORD *)(a1 + 12) += 16;
        if ( *(_DWORD *)(a1 + 4) > (signed int)ShipX )
          *(_DWORD *)(a1 + 12) -= 16;
        if ( *(_DWORD *)(a1 + 12) > 1024 )
          *(_DWORD *)(a1 + 12) = 1024;
        if ( *(_DWORD *)(a1 + 12) < -1024 )
          *(_DWORD *)(a1 + 12) = -1024;
        *(_DWORD *)(a1 + 4) += *(_DWORD *)(a1 + 12);
        if ( *(_DWORD *)(a1 + 8) < ShipY )
          *(_DWORD *)(a1 + 16) += 4;
        if ( *(_DWORD *)(a1 + 8) > ShipY )
          *(_DWORD *)(a1 + 16) -= 4;
        if ( *(_DWORD *)(a1 + 16) > 256 )
          *(_DWORD *)(a1 + 16) = 256;
        if ( *(_DWORD *)(a1 + 16) < -256 )
          *(_DWORD *)(a1 + 16) = -256;
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
        break;
      case 300:
        if ( --*(_DWORD *)(a1 + 88) < 0 )
          *(_DWORD *)(a1 + 88) += 256;
        ++*(_DWORD *)(a1 + 48);
        if ( *(_DWORD *)(a1 + 4) > 81920 )
          *(_DWORD *)(a1 + 4) -= 512;
        if ( *(_DWORD *)(a1 + 4) < 40960 )
          *(_DWORD *)(a1 + 4) += 512;
        if ( *(_DWORD *)(a1 + 48) < 50 )
          break;
        PlaySound(12);
        SetShipInvincibility();
        *(_DWORD *)(a1 + 44) = 310;
        *(_DWORD *)(a1 + 92) = 0;
        goto LABEL_136;
      case 310:
LABEL_136:
        *(_DWORD *)(a1 + 88) -= 2;
        if ( *(_DWORD *)(a1 + 88) < 0 )
          *(_DWORD *)(a1 + 88) += 256;
        if ( ++*(_DWORD *)(a1 + 92) < 200 )
          break;
        *(_DWORD *)(a1 + 92) = 0;
        *(_DWORD *)(a1 + 44) = 320;
        *(_DWORD *)(a1 + 16) = 512;
        goto LABEL_140;
      case 320:
LABEL_140:
        *(_DWORD *)(a1 + 88) -= 8;
        if ( *(_DWORD *)(a1 + 88) < 0 )
          *(_DWORD *)(a1 + 88) += 256;
        *(_DWORD *)(a1 + 16) -= 32;
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
        v1 = (*(_DWORD *)(a1 + 92))++;
        if ( v1 != 100 )
          break;
        CheckStageClear(4);
        return StopLoopSound(32);
      default:
        break;
    }
  }
  else if ( v6 == 112 )
  {
LABEL_81:
    *(_DWORD *)(a1 + 44) = 112;
    if ( *(_DWORD *)(a1 + 4) >= 94208 )
    {
LABEL_83:
      *(_DWORD *)(a1 + 44) = 113;
      if ( *(_DWORD *)(a1 + 8) >= 135168 )
      {
        *(_DWORD *)(a1 + 44) = 110;
        if ( *(_DWORD *)(a1 + 60) > 680 && *(_DWORD *)(a1 + 68) & 8 )
        {
          PlaySound(38);
          *(_DWORD *)(a1 + 68) &= 0xFFFFFFF7;
          *(_DWORD *)(a1 + 68) |= 1u;
        }
      }
      else
      {
        *(_DWORD *)(a1 + 8) += 1024;
      }
    }
    else
    {
      *(_DWORD *)(a1 + 4) += 512;
    }
  }
  else
  {
    switch ( v6 )
    {
      case 0:
        *(_DWORD *)(a1 + 44) = 10;
        *(_DWORD *)(a1 + 8) = -32768;
        *(_DWORD *)(a1 + 16) = 256;
        *(_DWORD *)(a1 + 68) |= 0xAu;
        CreateEntity(78, 0, -16384, a1);
        CreateEntity(78, 0, -16384, a1);
        CreateEntity(78, 0, -16384, a1);
        CreateEntity(78, 0, -16384, a1);
        CreateEntity(78, 0, -16384, a1);
        CreateEntity(78, 0, -16384, a1);
        CreateEntity(78, 0, -16384, a1);
        CreateEntity(78, 0, -16384, a1);
        CreateEntity(77, 0, -16384, a1);
        CreateEntity(77, 0, -16384, a1);
        CreateEntity(77, 0, -16384, a1);
        CreateEntity(77, 0, -16384, a1);
        CreateEntity(82, 0, -16384, a1);
        for ( i = 0; i < 20; ++i )
          CreateEntity(80, 0, -16384, a1);
        *(_DWORD *)(a1 + 56) = 48;
        goto LABEL_19;
      case 10:
LABEL_19:
        if ( *(_DWORD *)(a1 + 8) > 24576 )
          *(_DWORD *)(a1 + 16) -= 4;
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
        if ( !*(_DWORD *)(a1 + 16) )
        {
          *(_DWORD *)(a1 + 44) = 11;
          CreateEntity(79, 0, -16384, a1);
          CreateEntity(79, 0, -16384, a1);
          CreateEntity(79, 0, -16384, a1);
          CreateEntity(79, 0, -16384, a1);
        }
        break;
      case 11:
        *(_DWORD *)(a1 + 88) -= 2;
        if ( *(_DWORD *)(a1 + 88) < 0 )
          *(_DWORD *)(a1 + 88) += 256;
        if ( *(_DWORD *)(a1 + 56) >= 256 )
          *(_DWORD *)(a1 + 44) = 12;
        else
          ++*(_DWORD *)(a1 + 56);
        break;
      case 12:
        *(_DWORD *)(a1 + 88) -= 4;
        if ( *(_DWORD *)(a1 + 88) < 0 )
          *(_DWORD *)(a1 + 88) += 256;
        if ( ++*(_DWORD *)(a1 + 48) > 100 )
        {
          *(_DWORD *)(a1 + 48) = 0;
          *(_DWORD *)(a1 + 44) = 20;
          *(_DWORD *)(a1 + 68) &= 0xFFFFFFF7;
          *(_DWORD *)(a1 + 68) |= 1u;
          PlaySound(38);
        }
        break;
      case 20:
        *(_DWORD *)(a1 + 88) -= 2;
        if ( *(_DWORD *)(a1 + 88) < 0 )
          *(_DWORD *)(a1 + 88) += 256;
        if ( *(_DWORD *)(a1 + 8) >= 126976 )
        {
          if ( *(_DWORD *)(a1 + 16) )
            *(_DWORD *)(a1 + 16) -= 4;
          else
            *(_DWORD *)(a1 + 44) = 21;
        }
        else if ( *(_DWORD *)(a1 + 16) < 256 )
        {
          *(_DWORD *)(a1 + 16) += 4;
        }
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
        break;
      case 21:
        *(_DWORD *)(a1 + 88) -= 2;
        if ( *(_DWORD *)(a1 + 88) < 0 )
          *(_DWORD *)(a1 + 88) += 256;
        if ( *(_DWORD *)(a1 + 56) <= 96 )
        {
          if ( *(_DWORD *)(a1 + 68) & 8 )
          {
            if ( (signed int)ShipX >= 61440 )
              *(_DWORD *)(a1 + 44) = 120;
            else
              *(_DWORD *)(a1 + 44) = 110;
          }
          else
          {
            PlaySound(31);
            CreateCaret(4, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), a1);
            *(_DWORD *)(a1 + 44) = 30;
          }
        }
        else
        {
          --*(_DWORD *)(a1 + 56);
        }
        break;
      case 30:
        if ( --*(_DWORD *)(a1 + 88) < 0 )
          *(_DWORD *)(a1 + 88) += 256;
        if ( *(_DWORD *)(a1 + 8) <= 36864 )
        {
          if ( *(_DWORD *)(a1 + 16) )
          {
            *(_DWORD *)(a1 + 16) += 4;
          }
          else if ( *(_DWORD *)(a1 + 68) & 8 )
          {
            if ( (signed int)ShipX <= 61440 )
              *(_DWORD *)(a1 + 44) = 122;
            else
              *(_DWORD *)(a1 + 44) = 112;
          }
          else
          {
            *(_DWORD *)(a1 + 44) = 31;
          }
        }
        else if ( *(_DWORD *)(a1 + 16) > -256 )
        {
          *(_DWORD *)(a1 + 16) -= 4;
        }
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
        break;
      case 31:
        *(_DWORD *)(a1 + 88) -= 2;
        if ( *(_DWORD *)(a1 + 88) < 0 )
          *(_DWORD *)(a1 + 88) += 256;
        if ( *(_DWORD *)(a1 + 56) >= 256 )
          *(_DWORD *)(a1 + 44) = 20;
        else
          ++*(_DWORD *)(a1 + 56);
        break;
      case 110:
        *(_DWORD *)(a1 + 44) = 110;
        if ( *(_DWORD *)(a1 + 4) <= 28672 )
          goto LABEL_79;
        *(_DWORD *)(a1 + 4) -= 512;
        break;
      case 111:
LABEL_79:
        *(_DWORD *)(a1 + 44) = 111;
        if ( *(_DWORD *)(a1 + 8) <= 28672 )
          goto LABEL_81;
        *(_DWORD *)(a1 + 8) -= 1024;
        break;
      default:
        break;
    }
  }
  if ( *(_DWORD *)(a1 + 44) > 300 && ++*(_DWORD *)(a1 + 48) > 5 )
  {
    *(_DWORD *)(a1 + 48) = (unsigned __int16)GetRandom(4);
    v3 = *(_DWORD *)(a1 + 8) + (((unsigned __int16)GetRandom(48) - 32) << 10);
    v4 = GetRandom(48);
    CreateEntity(1, *(_DWORD *)(a1 + 4) + (((unsigned __int16)v4 - 24) << 10), v3, 0);
  }
  v5 = a1 + 104;
  *(_DWORD *)v5 = 0;
  *(_DWORD *)(v5 + 4) = 80;
  *(_DWORD *)(v5 + 8) = 48;
  *(_DWORD *)(v5 + 12) = 128;
  switch ( *(_DWORD *)(a1 + 44) )
  {
    case 0x6E:
      if ( --*(_DWORD *)(a1 + 88) < 0 )
        *(_DWORD *)(a1 + 88) += 256;
      break;
    case 0x6F:
      *(_DWORD *)(a1 + 88) -= 2;
      if ( *(_DWORD *)(a1 + 88) < 0 )
        *(_DWORD *)(a1 + 88) += 256;
      break;
    case 0x70:
      if ( --*(_DWORD *)(a1 + 88) < 0 )
        *(_DWORD *)(a1 + 88) += 256;
      break;
    case 0x71:
      *(_DWORD *)(a1 + 88) -= 2;
      if ( *(_DWORD *)(a1 + 88) < 0 )
        *(_DWORD *)(a1 + 88) += 256;
      break;
    case 0x78:
      if ( ++*(_DWORD *)(a1 + 88) >= 256 )
        *(_DWORD *)(a1 + 88) -= 256;
      break;
    case 0x79:
      *(_DWORD *)(a1 + 88) += 2;
      if ( *(_DWORD *)(a1 + 88) >= 256 )
        *(_DWORD *)(a1 + 88) -= 256;
      break;
    case 0x7A:
      if ( ++*(_DWORD *)(a1 + 88) >= 256 )
        *(_DWORD *)(a1 + 88) -= 256;
      break;
    case 0x7B:
      *(_DWORD *)(a1 + 88) += 2;
      if ( *(_DWORD *)(a1 + 88) >= 256 )
        *(_DWORD *)(a1 + 88) -= 256;
      break;
    default:
      break;
  }
  result = *(_DWORD *)(a1 + 72) / 2 % 2;
  if ( result )
  {
    *(_DWORD *)(a1 + 104) += 48;
    result = a1;
    *(_DWORD *)(a1 + 112) += 48;
  }
  return result;
}


int ActNpc077(int a1)
{
  int v1; 
  int result; 
  int v3; 
  char *v4; 
  int v5; 

  v5 = *(_DWORD *)(a1 + 80);
  if ( *(_DWORD *)(a1 + 44) >= 100 )
  {
    v1 = (*(_DWORD *)(a1 + 48))++ % 6;
    if ( !v1 )
      CreateEntity(29, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), 0);
  }
  else
  {
    if ( *(_DWORD *)(v5 + 60) < 1000 - 160 * (*(_DWORD *)(a1 + 84) + 1) )
      *(_DWORD *)(a1 + 44) = 30;
    switch ( *(_DWORD *)(a1 + 44) )
    {
      case 0:
        *(_DWORD *)(a1 + 44) = 10;
        *(_DWORD *)(a1 + 84) = (*(_DWORD *)(v5 + 84))++;
        if ( *(_DWORD *)(v5 + 84) == 4 )
          *(_DWORD *)(v5 + 84) = 0;
        goto LABEL_7;
      case 0xA:
LABEL_7:
        if ( !(*(_DWORD *)(v5 + 68) & 1) )
          break;
        *(_DWORD *)(a1 + 44) = 11;
        goto LABEL_9;
      case 0xB:
LABEL_9:
        if ( *(_DWORD *)(a1 + 52) >= 3 )
        {
          *(_DWORD *)(a1 + 44) = 20;
        }
        else if ( ++*(_DWORD *)(a1 + 56) > 1 )
        {
          *(_DWORD *)(a1 + 56) = 0;
          ++*(_DWORD *)(a1 + 52);
        }
        break;
      case 0x14:
        if ( *(_DWORD *)(v5 + 68) & 1 )
          break;
        *(_DWORD *)(a1 + 44) = 21;
        goto LABEL_16;
      case 0x15:
LABEL_16:
        if ( *(_DWORD *)(a1 + 52) <= 0 )
        {
          *(_DWORD *)(a1 + 44) = 10;
        }
        else if ( ++*(_DWORD *)(a1 + 56) > 1 )
        {
          *(_DWORD *)(a1 + 56) = 0;
          --*(_DWORD *)(a1 + 52);
        }
        break;
      case 0x1E:
        CreateEntity(1, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), 0);
        PlaySound(11);
        *(_DWORD *)(a1 + 44) = 100;
        *(_DWORD *)(v5 + 68) &= 0xFFFFFFFE;
        *(_DWORD *)(v5 + 68) |= 8u;
        PlaySound(38);
        break;
      default:
        break;
    }
  }
  switch ( *(_DWORD *)(a1 + 84) )
  {
    case 0:
      *(_DWORD *)(a1 + 4) = *(_DWORD *)(v5 + 4) - 14336;
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(v5 + 8) + 10240;
      break;
    case 1:
      *(_DWORD *)(a1 + 4) = *(_DWORD *)(v5 + 4) + 15360;
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(v5 + 8) + 10240;
      break;
    case 2:
      *(_DWORD *)(a1 + 4) = *(_DWORD *)(v5 + 4) - 5120;
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(v5 + 8) + 0x4000;
      break;
    case 3:
      *(_DWORD *)(a1 + 4) = *(_DWORD *)(v5 + 4) + 6144;
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(v5 + 8) + 0x4000;
      break;
    default:
      break;
  }
  if ( *(_DWORD *)(a1 + 44) == 100 )
  {
    result = a1 + 104;
    *(_DWORD *)result = 0;
    *(_DWORD *)(result + 4) = 0;
    *(_DWORD *)(result + 8) = 0;
    *(_DWORD *)(result + 12) = 0;
  }
  else if ( *(_DWORD *)(v5 + 72) / 2 % 2 )
  {
    v3 = a1 + 104;
    *(_DWORD *)v3 = 160;
    *(_DWORD *)(v3 + 4) = 96;
    *(_DWORD *)(v3 + 8) = 176;
    result = 112;
    *(_DWORD *)(v3 + 12) = 112;
  }
  else
  {
    v4 = (char *)&unk_43B7E0 + 16 * *(_DWORD *)(a1 + 52);
    result = a1 + 104;
    *(_DWORD *)result = *(_DWORD *)v4;
    *(_DWORD *)(result + 4) = *((_DWORD *)v4 + 1);
    *(_DWORD *)(result + 8) = *((_DWORD *)v4 + 2);
    *(_DWORD *)(result + 12) = *((_DWORD *)v4 + 3);
  }
  return result;
}


int ActNpc078(int nHeight)
{
  unsigned __int8 v1; 
  int v2; 
  int result; 
  char *v4; 
  int v5; 
  int v6; 

  v6 = *(_DWORD *)(nHeight + 80);
  v5 = *(_DWORD *)(nHeight + 44);
  if ( v5 )
  {
    if ( v5 != 10 )
    {
      if ( v5 == 20 && *(_DWORD *)(nHeight + 60) < 968 )
      {
        *(_DWORD *)(nHeight + 44) = 30;
        *(_DWORD *)(nHeight + 72) = 0;
        *(_DWORD *)(nHeight + 52) = 1;
        *(_DWORD *)(nHeight + 68) &= 0xFFFFFFFC;
        CreateCaret(1, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), nHeight);
        PlaySound(11);
      }
      goto LABEL_13;
    }
  }
  else
  {
    *(_DWORD *)(nHeight + 44) = 10;
    *(_DWORD *)(nHeight + 84) = 32 * (*(_DWORD *)(v6 + 84))++;
    if ( *(_DWORD *)(v6 + 84) == 8 )
      *(_DWORD *)(v6 + 84) = 0;
    *(_DWORD *)(nHeight + 68) |= 0xAu;
  }
  if ( *(_DWORD *)(v6 + 44) == 12 )
  {
    *(_DWORD *)(nHeight + 44) = 20;
    *(_DWORD *)(nHeight + 68) &= 0xFFFFFFF7;
    *(_DWORD *)(nHeight + 68) |= 1u;
  }
LABEL_13:
  *(_DWORD *)(nHeight + 84) += 4;
  *(_DWORD *)(nHeight + 84) %= 256;
  v1 = *(_BYTE *)(nHeight + 84);
  *(_DWORD *)(nHeight + 4) = *(_DWORD *)(v6 + 4) + 24 * GetCos(v1);
  *(_DWORD *)(nHeight + 8) = *(_DWORD *)(v6 + 8) + 24 * GetSin(v1);
  if ( *(_DWORD *)(nHeight + 72) / 2 % 2 )
  {
    v2 = nHeight + 104;
    *(_DWORD *)v2 = 168;
    *(_DWORD *)(v2 + 4) = 40;
    *(_DWORD *)(v2 + 8) = 176;
    result = 48;
    *(_DWORD *)(v2 + 12) = 48;
  }
  else
  {
    v4 = (char *)&unk_43B840 + 16 * *(_DWORD *)(nHeight + 52);
    result = nHeight + 104;
    *(_DWORD *)result = *(_DWORD *)v4;
    *(_DWORD *)(result + 4) = *((_DWORD *)v4 + 1);
    *(_DWORD *)(result + 8) = *((_DWORD *)v4 + 2);
    *(_DWORD *)(result + 12) = *((_DWORD *)v4 + 3);
  }
  return result;
}


int ActNpc079(int a1)
{
  unsigned __int8 v1; 
  char *v2; 
  int v3; 
  int result; 
  int v5; 
  int v6; 

  v6 = *(_DWORD *)(a1 + 80);
  v5 = *(_DWORD *)(a1 + 44);
  if ( v5 )
  {
    if ( v5 != 10 )
      goto LABEL_8;
  }
  else
  {
    *(_DWORD *)(a1 + 44) = 10;
    *(_DWORD *)(a1 + 84) = (*(_DWORD *)(v6 + 84))++;
    if ( *(_DWORD *)(v6 + 84) == 4 )
      *(_DWORD *)(v6 + 84) = 0;
    *(_DWORD *)(a1 + 68) |= 0xAu;
  }
  v1 = (*(_BYTE *)(a1 + 84) << 6) + *(_BYTE *)(v6 + 88);
  *(_DWORD *)(a1 + 4) = *(_DWORD *)(v6 + 4) + *(_DWORD *)(v6 + 56) * GetCos(v1) / 4;
  *(_DWORD *)(a1 + 8) = *(_DWORD *)(v6 + 8) + *(_DWORD *)(v6 + 56) * GetSin(v1) / 4;
LABEL_8:
  v2 = (char *)&unk_43B870 + 16 * (*(_DWORD *)(a1 + 56) / 2 % 2);
  v3 = a1 + 104;
  *(_DWORD *)v3 = *(_DWORD *)v2;
  *(_DWORD *)(v3 + 4) = *((_DWORD *)v2 + 1);
  *(_DWORD *)(v3 + 8) = *((_DWORD *)v2 + 2);
  *(_DWORD *)(v3 + 12) = *((_DWORD *)v2 + 3);
  result = a1;
  ++*(_DWORD *)(a1 + 56);
  return result;
}


signed int ActNpc080(int a1)
{
  unsigned __int8 v1; 
  __int64 v2; 
  __int64 v3; 
  int v4; 
  signed int result; 
  int v6; 
  int v7; 

  v7 = *(_DWORD *)(a1 + 80);
  v6 = *(_DWORD *)(a1 + 44);
  if ( v6 )
  {
    if ( v6 != 10 )
      goto LABEL_7;
  }
  else
  {
    *(_DWORD *)(a1 + 44) = 10;
    *(_DWORD *)(a1 + 84) = (*(_DWORD *)(v7 + 84))++;
    if ( *(_DWORD *)(v7 + 84) == 20 )
      *(_DWORD *)(v7 + 84) = 0;
  }
  v1 = ((unsigned __int8)(*(_DWORD *)(a1 + 84) % 4) << 6) + *(_BYTE *)(v7 + 88);
  v2 = *(_DWORD *)(v7 + 56) * GetCos(v1) * (*(_DWORD *)(a1 + 84) / 4 + 5);
  *(_DWORD *)(a1 + 4) = *(_DWORD *)(v7 + 4) + (((BYTE4(v2) & 3) + (signed int)v2) >> 2) / 11;
  v3 = *(_DWORD *)(v7 + 56) * GetSin(v1) * (*(_DWORD *)(a1 + 84) / 4 + 5);
  *(_DWORD *)(a1 + 8) = *(_DWORD *)(v7 + 8) + (((BYTE4(v3) & 3) + (signed int)v3) >> 2) / 11;
LABEL_7:
  v4 = a1 + 104;
  *(_DWORD *)v4 = 144;
  *(_DWORD *)(v4 + 4) = 40;
  result = 152;
  *(_DWORD *)(v4 + 8) = 152;
  *(_DWORD *)(v4 + 12) = 48;
  return result;
}


int ActNpc081_SpaceAmeba(int a1)
{
  int v1; 
  char *v2; 
  int v3; 
  int result; 
  int v5; 
  int v6; 
  int v7; 
  unsigned __int8 v8; 

  v6 = *(_DWORD *)(a1 + 4);
  v7 = *(_DWORD *)(a1 + 8);
  SubStageXOScroll(&v6, &v7);
  v5 = *(_DWORD *)(a1 + 44);
  if ( v5 )
  {
    if ( v5 != 10 )
    {
      if ( v5 == 20 && ++*(_DWORD *)(a1 + 48) > 24 )
      {
        *(_DWORD *)(a1 + 44) = 10;
        *(_DWORD *)(a1 + 48) = 0;
        *(_DWORD *)(a1 + 56) = 0;
        *(_DWORD *)(a1 + 72) = 0;
        v8 = GetArktan(v6 - (_DWORD)ShipX, v7 - ShipY, 64);
        *(_DWORD *)(a1 + 12) = GetCos(v8);
        *(_DWORD *)(a1 + 16) = GetSin(v8);
        if ( *(_DWORD *)(a1 + 84) > 6 )
          *(_DWORD *)(a1 + 16) = 1024;
      }
      goto LABEL_16;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 44) = 10;
    *(_DWORD *)(a1 + 48) = -10;
    *(_DWORD *)(a1 + 68) |= 0x40u;
    v8 = GetArktan(v6 - (_DWORD)ShipX, v7 - ShipY, 64);
    *(_DWORD *)(a1 + 12) = 2 * (GetCos(v8) / 3);
    *(_DWORD *)(a1 + 16) = 2 * (GetSin(v8) / 3);
  }
  *(_DWORD *)a1 &= 0xFFFFFF0F;
  if ( ++*(_DWORD *)(a1 + 48) > 24 )
  {
    *(_DWORD *)(a1 + 48) = 0;
    *(_DWORD *)(a1 + 44) = 20;
    *(_DWORD *)(a1 + 12) = 0;
    *(_DWORD *)(a1 + 16) = 0;
    ++*(_DWORD *)(a1 + 84);
    *(_DWORD *)(a1 + 68) |= 3u;
    PlaySound(42);
  }
  if ( ++*(_DWORD *)(a1 + 56) > 3 )
  {
    *(_DWORD *)(a1 + 56) = 0;
    ++*(_DWORD *)(a1 + 52);
  }
  if ( *(_DWORD *)(a1 + 52) > 2 )
    *(_DWORD *)(a1 + 52) = 0;
LABEL_16:
  *(_DWORD *)(a1 + 4) += *(_DWORD *)(a1 + 12);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
  if ( *(_DWORD *)(a1 + 72) / 2 % 2 )
  {
    v1 = a1 + 104;
    *(_DWORD *)v1 = 48;
    *(_DWORD *)(v1 + 4) = 104;
    *(_DWORD *)(v1 + 8) = 64;
    *(_DWORD *)(v1 + 12) = 120;
  }
  else
  {
    v2 = (char *)&unk_43B8A0 + 16 * *(_DWORD *)(a1 + 52);
    v3 = a1 + 104;
    *(_DWORD *)v3 = *(_DWORD *)v2;
    *(_DWORD *)(v3 + 4) = *((_DWORD *)v2 + 1);
    *(_DWORD *)(v3 + 8) = *((_DWORD *)v2 + 2);
    *(_DWORD *)(v3 + 12) = *((_DWORD *)v2 + 3);
  }
  result = a1;
  if ( !(*(_DWORD *)(a1 + 68) & 1) )
  {
    *(_DWORD *)(a1 + 108) += 16;
    result = *(_DWORD *)(a1 + 116) + 16;
    *(_DWORD *)(a1 + 116) = result;
  }
  if ( v7 > 172032 )
    *(_DWORD *)a1 = 0;
  return result;
}


int *ActNpc082(int nHeight)
{
  int *result; 
  char v2; 
  char v3; 
  char v4; 
  __int16 v5; 
  int v6; 

  v6 = *(_DWORD *)(nHeight + 80);
  *(_DWORD *)(nHeight + 4) = *(_DWORD *)(v6 + 4);
  *(_DWORD *)(nHeight + 8) = *(_DWORD *)(v6 + 8) - 2048;
  result = *(int **)(v6 + 44);
  switch ( *(_DWORD *)(v6 + 44) )
  {
    case 0x1E:
      if ( ++*(_DWORD *)(nHeight + 48) >= 48 && !(*(_DWORD *)(nHeight + 48) % 16) )
      {
        v2 = GetArktan(*(_DWORD *)(nHeight + 4) - (_DWORD)ShipX, *(_DWORD *)(nHeight + 8) - ShipY, 64);
        CreateEntity(63, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), (unsigned __int8)v2);
        CreateCaret(1, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), nHeight);
        PlaySound(36);
      }
      result = (int *)nHeight;
      if ( *(_DWORD *)(nHeight + 48) > 112 )
        *(_DWORD *)(nHeight + 48) = 16;
      break;
    case 0x6E:
    case 0x6F:
    case 0x70:
    case 0x71:
    case 0x78:
    case 0x79:
    case 0x7A:
    case 0x7B:
      if ( *(_DWORD *)(v6 + 60) < 680 )
      {
        result = (int *)(*(_DWORD *)(nHeight + 48) + 1);
        *(_DWORD *)(nHeight + 48) = result;
        if ( *(_DWORD *)(nHeight + 48) >= 48 )
        {
          result = (int *)nHeight;
          if ( !(*(_DWORD *)(nHeight + 48) % 16) )
          {
            v4 = GetArktan(*(_DWORD *)(nHeight + 4) - (_DWORD)ShipX, *(_DWORD *)(nHeight + 8) - ShipY, 64);
            CreateEntity(63, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), (unsigned __int8)v4);
            CreateCaret(1, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), nHeight);
            result = (int *)PlaySound(36);
          }
        }
        if ( *(_DWORD *)(nHeight + 48) > 112 )
          *(_DWORD *)(nHeight + 48) = 16;
      }
      else
      {
        ++*(_DWORD *)(nHeight + 48);
        result = (int *)nHeight;
        if ( *(_DWORD *)(nHeight + 48) >= 70 )
        {
          v3 = GetArktan(*(_DWORD *)(nHeight + 4) - (_DWORD)ShipX, *(_DWORD *)(nHeight + 8) - 1024 - ShipY, 64);
          CreateEntity(13, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8) - 1024, (unsigned __int8)v3);
          CreateEntity(13, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8) - 1024, (unsigned __int8)v3 - 10);
          CreateEntity(13, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8) - 1024, (unsigned __int8)v3 + 10);
          CreateCaret(1, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), nHeight);
          result = (int *)PlaySound(36);
          *(_DWORD *)(nHeight + 48) = 0;
        }
        if ( *(_DWORD *)(nHeight + 48) == 50 )
        {
          CreateCaret(4, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8) - 1024, nHeight);
          result = (int *)PlaySound(31);
        }
      }
      break;
    case 0xC8:
      if ( *(_DWORD *)(v6 + 48) == 20 )
      {
        CreateCaret(4, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8) - 1024, nHeight);
        PlaySound(31);
      }
      result = (int *)v6;
      if ( *(_DWORD *)(v6 + 48) > 50 && *(_DWORD *)(v6 + 48) < 150 )
      {
        result = (int *)(*(_DWORD *)(v6 + 48) / 6);
        if ( !(*(_DWORD *)(v6 + 48) % 6) )
        {
          CreateEntity(63, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), 192);
          CreateCaret(1, *(_DWORD *)(nHeight + 4), *(_DWORD *)(nHeight + 8), nHeight);
          result = (int *)PlaySound(36);
        }
      }
      break;
    case 0xD2:
      result = (int *)(*(_DWORD *)(nHeight + 48) + 1);
      *(_DWORD *)(nHeight + 48) = result;
      if ( *(_DWORD *)(nHeight + 48) > 32 )
      {
        *(_DWORD *)(nHeight + 48) = (unsigned __int16)GetRandom(32);
        v5 = GetRandom(120);
        result = CreateEntity(83, (unsigned __int16)v5 << 10, -8192, 0);
      }
      break;
    default:
      return result;
  }
  return result;
}


int ActNpc083_B4Bullet(int a1)
{
  char *v1; 
  int v2; 
  int result; 
  int v4; 

  v4 = *(_DWORD *)(a1 + 44);
  if ( v4 )
  {
    if ( v4 != 10 )
      goto LABEL_8;
  }
  else
  {
    *(_DWORD *)(a1 + 44) = 10;
    *(_DWORD *)(a1 + 16) = 1024;
  }
  if ( ++*(_DWORD *)(a1 + 48) == 32 )
    *(_DWORD *)(a1 + 68) |= 3u;
  *(_DWORD *)(a1 + 4) += *(_DWORD *)(a1 + 12);
  *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
LABEL_8:
  ++*(_DWORD *)(a1 + 56);
  if ( *(_DWORD *)(a1 + 4) < -65536
    || *(_DWORD *)(a1 + 4) > 188416
    || *(_DWORD *)(a1 + 8) < -65536
    || *(_DWORD *)(a1 + 8) > 229376 )
  {
    *(_DWORD *)a1 = 0;
  }
  v1 = (char *)&unk_43B8E0 + 16 * (*(_DWORD *)(a1 + 56) / 3 % 2);
  v2 = a1 + 104;
  *(_DWORD *)v2 = *(_DWORD *)v1;
  *(_DWORD *)(v2 + 4) = *((_DWORD *)v1 + 1);
  *(_DWORD *)(v2 + 8) = *((_DWORD *)v1 + 2);
  result = *((_DWORD *)v1 + 3);
  *(_DWORD *)(v2 + 12) = result;
  return result;
}


LONG *ActNpc084_Square(NPCHAR *a1)
{
  __int64 v1; 
  __int64 v2; 
  char v3; 
  int v4; 
  int v5; 
  int v6; 
  char *v7; 
  char *v8; 
  char *v9; 
  LONG *result; 
  char *v11; 
  char *v12; 

  switch ( a1->state )
  {
    case 0:
      PlaySound(26);
      a1->state = 10;
      a1->child = a1->x;
      a1->rot1 = a1->type2 << 14;
      a1->x = 2 * a1->x - 61440;
      a1->y = -8192;
      goto LABEL_3;
    case 0xA:
LABEL_3:
      v1 = a1->child - a1->x;
      a1->x += ((BYTE4(v1) & 7) + (signed int)v1) >> 3;
      v2 = a1->rot1 - a1->y;
      a1->y += ((BYTE4(v2) & 7) + (signed int)v2) >> 3;
      if ( ++a1->count1 > 10 )
        a1->flag |= 3u;
      if ( a1->count1 <= 100 )
      {
        if ( a1->life < 998 )
        {
          a1->state = 20;
          a1->life = 2;
          v3 = GetArktan(a1->x - (_DWORD)ShipX, a1->y - ShipY, 64);
          a1->xm = -3 * GetCos(v3);
          a1->ym = -3 * GetSin(v3);
          a1->child = (unsigned __int8)v3;
        }
        v4 = a1->count3++;
        if ( v4 > 0 )
        {
          a1->count3 = 0;
          ++a1->count2;
        }
        if ( a1->count2 > 3 )
          a1->count2 = 0;
      }
      else
      {
        a1->state = 30;
        a1->life = 4;
      }
      break;
    case 0x14:
      a1->xm += GetCos(a1->child) / 8;
      a1->ym += GetSin(a1->child) / 8;
      a1->x += a1->xm;
      a1->y += a1->ym;
      v5 = a1->count3++;
      if ( v5 > 0 )
      {
        a1->count3 = 0;
        ++a1->count2;
      }
      if ( a1->count2 > 11 )
        a1->count2 = 8;
      if ( a1->x < -65536 || a1->x > 188416 || a1->y < -65536 || a1->y > 229376 )
        a1->cond = 0;
      break;
    case 0x1E:
      a1->ym += 128;
      a1->y += a1->ym;
      if ( a1->y < -65536 || a1->y > 229376 )
        a1->cond = 0;
      v6 = a1->count3++;
      if ( v6 > 0 )
      {
        a1->count3 = 0;
        ++a1->count2;
      }
      if ( a1->count2 > 3 )
        a1->count2 = 0;
      break;
    default:
      break;
  }
  v7 = (char *)&unk_43B900 + 16 * a1->count2;
  v8 = (char *)&a1->rect;
  *(_DWORD *)v8 = *(_DWORD *)v7;
  *((_DWORD *)v8 + 1) = *((_DWORD *)v7 + 1);
  *((_DWORD *)v8 + 2) = *((_DWORD *)v7 + 2);
  *((_DWORD *)v8 + 3) = *((_DWORD *)v7 + 3);
  if ( a1->shock / 2 % 2 )
  {
    v9 = (char *)&unk_43B900 + 16 * (a1->count2 % 4 + 12);
    result = &a1->rect.left;
    *result = *(_DWORD *)v9;
    result[1] = *((_DWORD *)v9 + 1);
    result[2] = *((_DWORD *)v9 + 2);
    result[3] = *((_DWORD *)v9 + 3);
  }
  else
  {
    v11 = (char *)&unk_43B900 + 16 * a1->count2;
    v12 = (char *)&a1->rect;
    *(_DWORD *)v12 = *(_DWORD *)v11;
    *((_DWORD *)v12 + 1) = *((_DWORD *)v11 + 1);
    result = (LONG *)*((_DWORD *)v11 + 2);
    *((_DWORD *)v12 + 2) = result;
    *((_DWORD *)v12 + 3) = *((_DWORD *)v11 + 3);
  }
  return result;
}


signed int ActNpc085_CloudDarkL(int a1)
{
  int v1; 
  signed int result; 

  *(_DWORD *)(a1 + 8) += 3072;
  if ( *(_DWORD *)(a1 + 8) > 180224 )
    *(_DWORD *)a1 = 0;
  v1 = a1 + 104;
  *(_DWORD *)v1 = 64;
  *(_DWORD *)(v1 + 4) = 0;
  result = 112;
  *(_DWORD *)(v1 + 8) = 112;
  *(_DWORD *)(v1 + 12) = 24;
  return result;
}


signed int ActNpc086_CloudDarkS(int a1)
{
  int v1; 
  signed int result; 

  *(_DWORD *)(a1 + 8) += 2048;
  if ( *(_DWORD *)(a1 + 8) > 180224 )
    *(_DWORD *)a1 = 0;
  v1 = a1 + 104;
  *(_DWORD *)v1 = 64;
  *(_DWORD *)(v1 + 4) = 24;
  result = 88;
  *(_DWORD *)(v1 + 8) = 88;
  *(_DWORD *)(v1 + 12) = 40;
  return result;
}


int *ActNpc087_CloudDarkGen(int a1)
{
  int *result; 
  int v2; 

  ++*(_DWORD *)(a1 + 48);
  result = (int *)a1;
  if ( *(_DWORD *)(a1 + 48) > 12 )
  {
    *(_DWORD *)(a1 + 48) = 0;
    result = (int *)(*(_DWORD *)(a1 + 44) + 1);
    *(_DWORD *)(a1 + 44) = result;
    if ( *(_DWORD *)(a1 + 44) > 9 )
    {
      result = (int *)a1;
      *(_DWORD *)(a1 + 44) = 0;
    }
  }
  if ( !*(_DWORD *)(a1 + 48) )
  {
    v2 = (unsigned __int16)GetRandom(120) << 10;
    result = (int *)a1;
    switch ( *(_DWORD *)(a1 + 44) )
    {
      case 0:
        result = CreateEntity(85, v2, -16384, 0);
        break;
      case 1:
        result = CreateEntity(85, v2, -16384, 0);
        break;
      case 2:
        result = CreateEntity(86, v2, -16384, 0);
        break;
      case 3:
        result = CreateEntity(85, v2, -16384, 0);
        break;
      case 4:
        result = CreateEntity(86, v2, -16384, 0);
        break;
      case 7:
        result = CreateEntity(85, v2, -16384, 0);
        break;
      default:
        return result;
    }
  }
  return result;
}


NPCHAR *ActNpc088_MissilePot(NPCHAR *o)
{
  char *v1; 
  char *v2; 
  NPCHAR *result; 
  int v4; 

  v4 = o->state;
  if ( v4 )
  {
    if ( v4 != 10 )
      goto LABEL_17;
  }
  else
  {
    CreateEntity(89, -1, 0, (int)o);
    CreateEntity(89, 1, 0, (int)o);
    o->state = 10;
    if ( o->x >= 81920 )
    {
      o->x = 139264;
      o->xm = -256;
    }
    else
    {
      o->x = -16384;
      o->xm = 256;
    }
    o->ym = 256;
    if ( o->type2 )
      o->y = 24576;
    else
      o->y = -16384;
  }
  if ( ++o->count1 == 143 )
  {
    CreateCaret(1, o->x, o->y, (int)o);
    PlaySound(30);
  }
  if ( o->count1 > 162 && !(o->count1 % 6) )
  {
    CreateEntity(90, o->x, o->y - 0x2000, ++o->child % 6);
    PlaySound(20);
  }
  if ( o->count1 > 206 )
    o->count1 = 0;
LABEL_17:
  if ( !(o->count1 % 6) )
    CreateEntity(29, o->x, o->y + 0x2000, 0);
  o->x += o->xm;
  o->y += o->ym;
  if ( o->shock / 2 % 2 )
  {
    v1 = (char *)&o->rect;
    *(_DWORD *)v1 = 112;
    *((_DWORD *)v1 + 1) = 32;
    *((_DWORD *)v1 + 2) = 144;
    *((_DWORD *)v1 + 3) = 64;
  }
  else
  {
    v2 = (char *)&o->rect;
    *(_DWORD *)v2 = 112;
    *((_DWORD *)v2 + 1) = 0;
    *((_DWORD *)v2 + 2) = 144;
    *((_DWORD *)v2 + 3) = 32;
  }
  ++o->count3;
  result = o;
  if ( o->count3 > 100 && (o->x < -16384 || o->x > 139264) )
  {
    result = o;
    o->cond = 0;
  }
  return result;
}


NPCHAR *ActNpc089(NPCHAR *a1)
{
  NPCHAR *result; 
  int v2; 

  v2 = a1->state;
  if ( !v2 )
  {
    a1->child = a1->x;
    a1->state = 10;
    goto LABEL_5;
  }
  if ( v2 == 10 )
  {
LABEL_5:
    if ( a1->child >= 0 )
      a1->x = *(_DWORD *)(a1->type2 + 4) + 10240;
    else
      a1->x = *(_DWORD *)(a1->type2 + 4) - 10240;
    a1->y = *(_DWORD *)(a1->type2 + 8);
  }
  result = (NPCHAR *)(*(_DWORD *)a1->type2 & 1);
  if ( !result || *(_DWORD *)(a1->type2 + 40) != 88 )
  {
    result = a1;
    a1->cond = 0;
  }
  return result;
}


LONG *ActNpc090_Missile(NPCHAR *a1)
{
  char *v1; 
  LONG *result; 
  int v3; 

  v3 = a1->state;
  if ( v3 )
  {
    if ( v3 != 10 )
      goto LABEL_21;
  }
  else
  {
    switch ( a1->type2 )
    {
      case 0:
        a1->xm = -256;
        a1->ym = -1536;
        break;
      case 1:
        a1->xm = 256;
        a1->ym = -1536;
        break;
      case 2:
        a1->xm = -341;
        a1->ym = -1024;
        break;
      case 3:
        a1->xm = 341;
        a1->ym = -1024;
        break;
      case 4:
        a1->xm = -512;
        a1->ym = -512;
        break;
      case 5:
        a1->xm = 512;
        a1->ym = -512;
        break;
      default:
        break;
    }
    a1->state = 10;
  }
  a1->ym += 64;
  if ( a1->ym >= 1024 )
  {
    a1->xm = 0;
  }
  else if ( (signed int)ShipX >= a1->x )
  {
    a1->xm += 10;
  }
  else
  {
    a1->xm -= 10;
  }
  if ( ++a1->count2 > 1 )
    a1->count2 = 0;
  a1->x += a1->xm;
  a1->y += a1->ym;
LABEL_21:
  if ( a1->y >= 176128 )
    a1->cond = 0;
  v1 = (char *)&unk_43BA20 + 16 * a1->count2;
  result = &a1->rect.left;
  *result = *(_DWORD *)v1;
  result[1] = *((_DWORD *)v1 + 1);
  result[2] = *((_DWORD *)v1 + 2);
  result[3] = *((_DWORD *)v1 + 3);
  return result;
}


int ActNpc091(int a1)
{
  char *v1; 
  int v2; 
  int result; 

  *(_DWORD *)(a1 + 8) += 4096;
  if ( *(_DWORD *)(a1 + 8) > 172032 )
    *(_DWORD *)a1 = 0;
  v1 = (char *)&unk_43BA40 + 16 * *(_DWORD *)(a1 + 80);
  v2 = a1 + 104;
  *(_DWORD *)v2 = *(_DWORD *)v1;
  *(_DWORD *)(v2 + 4) = *((_DWORD *)v1 + 1);
  *(_DWORD *)(v2 + 8) = *((_DWORD *)v1 + 2);
  result = *((_DWORD *)v1 + 3);
  *(_DWORD *)(v2 + 12) = result;
  return result;
}


NPCHAR *ActNpc092_BGRock(NPCHAR *a1)
{
  NPCHAR *result; 
  int x; 

  if ( ++a1->child == 30 )
    ShipFlags |= 0x100u;
  if ( ++a1->count1 > 10 )
  {
    a1->count1 = 0;
    if ( ++a1->state > 9 )
      a1->state = 0;
  }
  result = a1;
  if ( !a1->count1 )
  {
    x = ((unsigned __int16)GetRandom(136) << 10) - 0x4000;
    result = (NPCHAR *)a1->state;
    switch ( a1->state )
    {
      case 0:
        result = (NPCHAR *)CreateEntity(91, x, -16384, 0);
        break;
      case 1:
        result = (NPCHAR *)CreateEntity(91, x, -16384, 0);
        break;
      case 2:
        result = (NPCHAR *)CreateEntity(91, x, -16384, 1);
        break;
      case 3:
        result = (NPCHAR *)CreateEntity(91, x, -16384, 0);
        break;
      case 4:
        result = (NPCHAR *)CreateEntity(91, x, -16384, 1);
        break;
      case 7:
        result = (NPCHAR *)CreateEntity(91, x, -16384, 0);
        break;
      default:
        return result;
    }
  }
  return result;
}



_DWORD *ActNpc093_ClearRockCloudGen(_DWORD *a1)
{
  _DWORD *result; 

  ClearReplaceNpChar(87, 0);
  ClearReplaceNpChar(92, 0);
  result = a1;
  *a1 = 0;
  return result;
}


signed int ActNpc094_SandStamper(NPCHAR *a1)
{
  char v1; 
  char *v2; 
  signed int result; 
  char *v4; 
  char *v5; 
  char *v6; 

  if ( a1->state < 20 && a1->life <= 976 )
  {
    a1->state = 20;
    PlaySound(11);
    CreateEntity(1, a1->x, a1->y, 0);
    CreateCaret(0, a1->x, a1->y, a1->score);
    AddScore(a1->score);
    a1->flag &= 0xFFFFFFFE;
    a1->flag |= 8u;
  }
  switch ( a1->state )
  {
    case 0:
      CreateEntity(95, a1->x, a1->y, (int)a1);
      a1->state = 10;
      a1->rot1 = a1->y - 0x4000;
      a1->flag |= 3u;
      a1->count4 = 0;
      a1->count3 = -3072;
      if ( !a1->type2 )
        CreateEntity(96, a1->x, a1->y + 3072, (int)a1);
      PlaySound(20);
      goto LABEL_8;
    case 0xA:
LABEL_8:
      if ( a1->type2 )
      {
        a1->rot1 += 2048;
      }
      else if ( a1->rot1 < 40960 )
      {
        a1->rot1 += 256;
      }
      else
      {
        a1->rot1 += 1024;
      }
      a1->count3 += 128;
      a1->count4 += a1->count3;
      if ( a1->count4 > 0 )
      {
        a1->count4 = 0;
        a1->count3 = -3072;
        if ( !a1->type2 )
          CreateEntity(96, a1->x, a1->y + 3072, (int)a1);
        PlaySound(20);
      }
      break;
    case 0x14:
      a1->rot1 += 512;
      a1->count3 += 128;
      a1->count4 += a1->count3;
      if ( a1->count4 <= 0 )
        break;
      a1->count4 = 0;
      PlaySound(20);
      CreateEntity(1, a1->x, a1->y + 10240, 0);
      a1->state = 30;
      a1->ym = 0;
      goto LABEL_20;
    case 0x1E:
LABEL_20:
      a1->ym += 256;
      if ( a1->ym > 4096 )
        a1->ym = 4096;
      a1->rot1 += a1->ym;
      break;
    default:
      break;
  }
  if ( a1->state < 20 )
  {
    if ( ++a1->count1 == 350 )
    {
      CreateCaret(1, a1->x, a1->y - 2048, (int)a1);
      PlaySound(30);
    }
    if ( a1->count1 == 370 )
    {
      a1->count1 = 0;
      v1 = GetArktan(a1->x - (_DWORD)ShipX, a1->y - 2048 - ShipY, 64);
      CreateEntity(13, a1->x, a1->y - 2048, (unsigned __int8)v1);
      v1 += 12;
      CreateEntity(13, a1->x, a1->y - 2048, (unsigned __int8)v1);
      CreateEntity(13, a1->x, a1->y - 2048, (unsigned __int8)(v1 - 24));
      PlaySound(7);
    }
  }
  if ( a1->rot1 > 196608 )
    a1->cond = 0;
  a1->y = a1->rot1 + a1->count4 / 2;
  if ( a1->state < 20 )
  {
    if ( a1->shock / 2 % 2 )
    {
      v4 = (char *)&a1->rect;
      *(_DWORD *)v4 = 176;
      *((_DWORD *)v4 + 1) = 0;
      result = 192;
      *((_DWORD *)v4 + 2) = 192;
      *((_DWORD *)v4 + 3) = 24;
    }
    else
    {
      v5 = (char *)&unk_43BA60 + 16 * (++a1->count2 % 2);
      v6 = (char *)&a1->rect;
      *(_DWORD *)v6 = *(_DWORD *)v5;
      *((_DWORD *)v6 + 1) = *((_DWORD *)v5 + 1);
      *((_DWORD *)v6 + 2) = *((_DWORD *)v5 + 2);
      result = *((_DWORD *)v5 + 3);
      *((_DWORD *)v6 + 3) = result;
    }
  }
  else
  {
    v2 = (char *)&a1->rect;
    *(_DWORD *)v2 = 232;
    *((_DWORD *)v2 + 1) = 0;
    *((_DWORD *)v2 + 2) = 248;
    result = 24;
    *((_DWORD *)v2 + 3) = 24;
  }
  return result;
}


NPCHAR *ActNpc095(NPCHAR *a1)
{
  char *v1; 
  NPCHAR *result; 
  int v3; 

  v3 = a1->type2;
  a1->x = *(_DWORD *)(v3 + 4)
        + ((signed int)((((unsigned __int64)-*(_DWORD *)(v3 + 92) >> 32) & 3) - *(_DWORD *)(v3 + 92)) >> 2);
  a1->y = *(_DWORD *)(v3 + 8) + -*(_DWORD *)(v3 + 92) / 3 + 3072;
  if ( *(_DWORD *)(v3 + 44) == 30 )
    a1->y += 4096;
  v1 = (char *)&a1->rect;
  *(_DWORD *)v1 = 208;
  *((_DWORD *)v1 + 1) = 0;
  *((_DWORD *)v1 + 2) = 232;
  *((_DWORD *)v1 + 3) = 32;
  result = a1;
  if ( *(_DWORD *)(v3 + 96) >= a1->num || (result = (NPCHAR *)(*(_DWORD *)v3 & 1)) == 0 )
    a1->cond = 0;
  return result;
}


signed int ActNpc096_Stamp(int a1)
{
  int v1; 
  signed int result; 

  *(_DWORD *)(a1 + 8) += 4096;
  if ( *(_DWORD *)(a1 + 8) > 176128 )
    *(_DWORD *)a1 = 0;
  v1 = a1 + 104;
  *(_DWORD *)v1 = 192;
  *(_DWORD *)(v1 + 4) = 0;
  result = 208;
  *(_DWORD *)(v1 + 8) = 208;
  *(_DWORD *)(v1 + 12) = 24;
  return result;
}


int ActNpc097_Brick(int a1)
{
  char *v1; 
  int result; 

  if ( !*(_DWORD *)(a1 + 44) )
  {
    *(_DWORD *)(a1 + 44) = 1;
    *(_DWORD *)(a1 + 68) |= 1u;
  }
  v1 = (char *)&unk_43BAB0 + 16 * (2 - *(_DWORD *)(a1 + 60) / 5);
  result = a1 + 104;
  *(_DWORD *)result = *(_DWORD *)v1;
  *(_DWORD *)(result + 4) = *((_DWORD *)v1 + 1);
  *(_DWORD *)(result + 8) = *((_DWORD *)v1 + 2);
  *(_DWORD *)(result + 12) = *((_DWORD *)v1 + 3);
  return result;
}


int ActNpc098_BulletSquare(NPCHAR *a1)
{
  char *v1; 
  char *v2; 
  int result; 
  int v4; 

  v4 = a1->state;
  if ( !v4 )
  {
    a1->xm = GetCos(a1->type2) / 2;
    a1->ym = GetSin(a1->type2) / 2;
    a1->state = 10;
    goto LABEL_5;
  }
  if ( v4 == 10 )
  {
LABEL_5:
    a1->x += a1->xm;
    a1->y += a1->ym;
  }
  if ( ++a1->count3 > 0 )
  {
    a1->count3 = 0;
    ++a1->count2;
  }
  if ( a1->count2 > 3 )
    a1->count2 = 0;
  if ( a1->x < -65536 || a1->x > 188416 || a1->y < -65536 || a1->y > 229376 )
    a1->cond = 0;
  v1 = (char *)&unk_43BAE0 + 16 * a1->count2;
  v2 = (char *)&a1->rect;
  *(_DWORD *)v2 = *(_DWORD *)v1;
  *((_DWORD *)v2 + 1) = *((_DWORD *)v1 + 1);
  *((_DWORD *)v2 + 2) = *((_DWORD *)v1 + 2);
  result = *((_DWORD *)v1 + 3);
  *((_DWORD *)v2 + 3) = result;
  return result;
}


NPCHAR *ActNpc099_BulletSquareGen(NPCHAR *o)
{
  char v1; 
  char *v2; 
  char *v3; 
  NPCHAR *result; 
  int x; 
  int y; 
  int a1; 
  int v8; 

  x = o->x;
  y = o->y;
  SubStageXOScroll(&x, &y);
  switch ( o->state )
  {
    case 0:
      o->state = 10;
      o->count1 = 25 * o->type2;
      goto LABEL_3;
    case 0xA:
LABEL_3:
      if ( !--o->count1 )
      {
        o->state = 20;
        PlaySound(38);
      }
      break;
    case 0x14:
      if ( ++o->count3 > 2 )
      {
        o->count3 = 0;
        ++o->count2;
      }
      if ( o->count2 == 2 )
      {
        o->state = 30;
        o->count1 = 0;
        CreateCaret(4, o->x, o->y, (int)o);
      }
      break;
    case 0x1E:
      if ( ++o->count1 > 14 && !(o->count1 % 41) )
      {
        v1 = GetArktan(x - (_DWORD)ShipX, y - ShipY, 64);
        CreateEntity(98, x, y, (unsigned __int8)v1);
        PlaySound(7);
      }
      if ( ++o->count3 > 2 )
      {
        o->count3 = 0;
        ++o->count2;
      }
      if ( o->count2 > 4 )
        o->count2 = 2;
      break;
    default:
      break;
  }
  v2 = (char *)&unk_43BB20 + 16 * o->count2;
  v3 = (char *)&o->rect;
  *(_DWORD *)v3 = *(_DWORD *)v2;
  *((_DWORD *)v3 + 1) = *((_DWORD *)v2 + 1);
  *((_DWORD *)v3 + 2) = *((_DWORD *)v2 + 2);
  *((_DWORD *)v3 + 3) = *((_DWORD *)v2 + 3);
  AlignStageScroll((NPCHAR *)&a1);
  result = o;
  if ( o->y > v8 + 0x10000 )
    o->cond = 0;
  return result;
}


LONG *ActNpc100_Boss5(NPCHAR *o)
{
  int cos; 
  int sin; 
  int v3; 
  int v4; 
  __int16 v5; 
  int v6; 
  __int16 v7; 
  LONG *result; 
  char *v9; 
  char *v10; 
  char *v11; 
  char *v12; 
  char *v13; 
  signed int i; 
  HBITMAP x; 
  int y; 
  int arktan; 
  int v18; 

  x = (HBITMAP)o->x;
  y = o->y;
  SubStageXOScroll(&x, &y);
  v18 = (1000 - o->life) / 50;
  if ( o->life < 800 )
    o->life = 800;
  if ( v18 > 3 )
    v18 = 3;
  switch ( o->state )
  {
    case 0:
      o->state = 10;
      o->y -= 33792;
      o->flag |= 8u;
      x = (HBITMAP)(o->x - 18432);
      y = o->y + 21504;
      SubStageXOScroll(&x, &y);
      CreateEntity(101, (int)x, y, (int)o);
      x = (HBITMAP)(o->x + 18432);
      y = o->y + 21504;
      SubStageXOScroll(&x, &y);
      CreateEntity(101, (int)x, y, (int)o);
      x = (HBITMAP)(o->x - 45056);
      y = o->y + 9216;
      SubStageXOScroll(&x, &y);
      CreateEntity(101, (int)x, y, (int)o);
      x = (HBITMAP)(o->x + 45056);
      y = o->y + 9216;
      SubStageXOScroll(&x, &y);
      CreateEntity(101, (int)x, y, (int)o);
      goto LABEL_7;
    case 0xA:
LABEL_7:
      if ( o->child < 4 )
        goto LABEL_40;
      o->state = 11;
      o->count1 = 0;
      goto LABEL_9;
    case 0xB:
LABEL_9:
      if ( ++o->count1 < 200 )
        goto LABEL_40;
      o->state = 15;
      PlaySound(38);
      goto LABEL_11;
    case 0xF:
LABEL_11:
      if ( ++o->count3 > 3 )
      {
        ++o->count2;
        o->count3 = 0;
      }
      if ( o->count2 < 3 )
        goto LABEL_40;
      o->state = 20;
      o->flag &= 0xFFFFFFF7;
      o->flag |= 1u;
      goto LABEL_15;
    case 0x14:
LABEL_15:
      if ( o->count1 == 200 )
      {
        PlaySound(31);
        CreateCaret(4, (int)x, y + 2048, 0);
        ++o->count1;
      }
      if ( o->count1 == 216 )
      {
        ++o->count1;
        PlaySound(9);
        arktan = (unsigned __int8)GetArktan((char *)x - (char *)ShipX, y + 1024 - ShipY, 64);
        CreateEntity(104, (int)x, y + 2048, arktan);
        cos = GetCos(o->type2);
        x = (HBITMAP)((char *)x + 2 * cos);
        sin = GetSin(o->type2);
        y += 2 * sin;
        CreateEntity(104, (int)x, y + 2048, arktan);
        o->count1 = 0;
        ++o->count1;
      }
      else if ( !o->shock )
      {
        ++o->count1;
      }
      if ( v18 < 3 )
        goto LABEL_40;
      o->state = 110;
      o->count1 = 0;
      o->flag &= 0xFFFFFFFE;
      CreateEntity(1, (int)x, y, 0);
      PlaySound(13);
      PlayLoopSound(32);
      if ( !GetInScoreAttack() )
        SetShipInvincibility();
      goto LABEL_24;
    case 0x6E:
LABEL_24:
      v3 = o->count1++;
      if ( v3 < 60 )
        goto LABEL_40;
      o->state = 120;
      o->child = 0;
      PlaySound(12);
      SetScrollSpeed(-256);
      if ( !(ShipCond & 2) )
      {
        AddScore(o->score);
        CreateCaret(0, (int)x, y + 24576, o->score);
      }
      for ( i = 0; i < 20; ++i )
      {
        v4 = y + (((unsigned __int16)GetRandom(16) - 4) << 10);
        v5 = GetRandom(96);
        CreateEntity(1, (int)(x + 256 * ((unsigned __int16)v5 - 48)), v4, 0);
      }
      goto LABEL_30;
    case 0x78:
LABEL_30:
      ++o->child;
      ++o->count1;
      if ( o->child == 150 )
        SetScrollSpeed(-512);
      if ( o->count1 > 5 )
      {
        o->count1 = (unsigned __int16)GetRandom(4);
        v6 = y + (((unsigned __int16)GetRandom(16) - 4) << 10);
        v7 = GetRandom(96);
        CreateEntity(1, (int)(x + 256 * ((unsigned __int16)v7 - 48)), v6, 0);
      }
      if ( y < 139264 )
        goto LABEL_40;
      o->state = 130;
      goto LABEL_36;
    case 0x82:
LABEL_36:
      if ( y <= 188416 )
        goto LABEL_40;
      o->cond = 0;
      if ( !GetInScoreAttack() )
        CheckStageClear(5);
      result = (LONG *)StopLoopSound(32);
      break;
    default:
LABEL_40:
      if ( o->state >= 20 )
      {
        if ( o->state < 30 )
        {
          if ( o->shock / 2 % 2 )
          {
            v11 = (char *)&o->rect;
            *(_DWORD *)v11 = 192;
            *((_DWORD *)v11 + 1) = 80;
            result = (LONG *)224;
            *((_DWORD *)v11 + 2) = 224;
            *((_DWORD *)v11 + 3) = 104;
          }
          else
          {
            v12 = (char *)&unk_43BB70 + 16 * (v18 + o->count2);
            v13 = (char *)&o->rect;
            *(_DWORD *)v13 = *(_DWORD *)v12;
            *((_DWORD *)v13 + 1) = *((_DWORD *)v12 + 1);
            *((_DWORD *)v13 + 2) = *((_DWORD *)v12 + 2);
            result = (LONG *)*((_DWORD *)v12 + 3);
            *((_DWORD *)v13 + 3) = result;
          }
        }
        else
        {
          v10 = (char *)&o->rect;
          *(_DWORD *)v10 = 224;
          *((_DWORD *)v10 + 1) = 80;
          *((_DWORD *)v10 + 2) = 256;
          result = (LONG *)104;
          *((_DWORD *)v10 + 3) = 104;
        }
      }
      else
      {
        v9 = (char *)&unk_43BB70 + 16 * o->count2;
        result = &o->rect.left;
        *result = *(_DWORD *)v9;
        result[1] = *((_DWORD *)v9 + 1);
        result[2] = *((_DWORD *)v9 + 2);
        result[3] = *((_DWORD *)v9 + 3);
      }
      break;
  }
  return result;
}


LONG *ActNpc101(NPCHAR *a1)
{
  char *v1; 
  char *v2; 
  LONG *result; 
  char *v4; 
  char *v5; 
  char *v6; 
  int v7; 
  HBITMAP hBitmap; 
  int y; 
  unsigned __int8 v10; 
  int v11; 
  int v12; 

  v11 = (1000 - a1->life) / 50;
  if ( a1->life < 850 )
    a1->life = 850;
  if ( v11 > 2 )
    v11 = 2;
  v12 = a1->type2;
  hBitmap = (HBITMAP)a1->x;
  y = a1->y;
  SubStageXOScroll(&hBitmap, &y);
  switch ( a1->state )
  {
    case 0:
      a1->state = 10;
      a1->flag |= 8u;
      switch ( a1->x / 1024 )
      {
        case 46:
          a1->xm = 1;
          a1->count1 = -40;
          break;
        case 82:
          a1->xm = 2;
          a1->count1 = -30;
          break;
        case 20:
          a1->xm = 3;
          a1->count1 = -20;
          break;
        case 108:
          a1->xm = 4;
          a1->count1 = -10;
          break;
        default:
          goto LABEL_11;
      }
      goto LABEL_11;
    case 0xA:
LABEL_11:
      if ( ++a1->count1 < 200 )
        goto LABEL_40;
      a1->state = 15;
      PlaySound(38);
      goto LABEL_13;
    case 0xF:
LABEL_13:
      if ( ++a1->count3 > 3 )
      {
        ++a1->count2;
        a1->count3 = 0;
      }
      if ( a1->count2 < 3 )
        goto LABEL_40;
      a1->state = 20;
      a1->flag &= 0xFFFFFFF7;
      a1->flag |= 1u;
      switch ( a1->xm )
      {
        case 1:
          a1->count1 = -10;
          break;
        case 2:
          a1->count1 = -20;
          break;
        case 3:
          a1->count1 = -30;
          break;
        case 4:
          a1->count1 = -40;
          break;
        default:
          goto LABEL_21;
      }
      goto LABEL_21;
    case 0x14:
LABEL_21:
      if ( v11 == 2 )
      {
        a1->flag &= 0xFFFFFFFE;
        ++*(_DWORD *)(a1->type2 + 84);
        a1->state = 21;
        CreateEntity(1, (int)hBitmap, y, 0);
        PlaySound(14);
      }
      goto LABEL_23;
    case 0x15:
LABEL_23:
      v7 = a1->child;
      if ( v7 )
      {
        if ( v7 != 1 )
          goto LABEL_30;
      }
      else
      {
        if ( ++a1->count1 < 180 )
          goto LABEL_30;
        a1->count1 = 0;
        a1->child = 1;
        PlaySound(30);
        CreateCaret(1, (int)hBitmap, y + 2048, 0);
        ++a1->count1;
      }
      if ( ++a1->count1 >= 14 )
      {
        a1->count1 = 0;
        a1->child = 0;
        PlaySound(36);
        v10 = GetArktan((char *)hBitmap - (char *)ShipX, y + 1024 - ShipY, 64);
        CreateEntity(102, (int)hBitmap, y + 2048, v10);
        a1->count1 = 50 * v11;
      }
LABEL_30:
      if ( a1->shock )
        a1->count1 += 2;
      if ( *(_DWORD *)(v12 + 44) >= 30 )
      {
        a1->state = 30;
        switch ( a1->xm )
        {
          case 1:
            a1->count1 = -10;
            break;
          case 2:
            a1->count1 = -20;
            break;
          case 3:
            a1->count1 = -30;
            break;
          case 4:
            a1->count1 = -40;
            break;
          default:
            break;
        }
LABEL_38:
        if ( ++a1->count1 >= 50 )
        {
          a1->state = 31;
          CreateEntity(1, (int)hBitmap, y, 0);
          PlaySound(12);
        }
      }
LABEL_40:
      if ( a1->state >= 20 )
      {
        if ( a1->state <= 30 )
        {
          if ( a1->shock / 2 % 2 )
          {
            v4 = (char *)&a1->rect;
            *(_DWORD *)v4 = 96;
            *((_DWORD *)v4 + 1) = 64;
            *((_DWORD *)v4 + 2) = 112;
            result = (LONG *)80;
            *((_DWORD *)v4 + 3) = 80;
          }
          else
          {
            v5 = (char *)&unk_43BBF0 + 16 * (v11 + 3);
            v6 = (char *)&a1->rect;
            *(_DWORD *)v6 = *(_DWORD *)v5;
            *((_DWORD *)v6 + 1) = *((_DWORD *)v5 + 1);
            result = (LONG *)*((_DWORD *)v5 + 2);
            *((_DWORD *)v6 + 2) = result;
            *((_DWORD *)v6 + 3) = *((_DWORD *)v5 + 3);
          }
        }
        else
        {
          result = &a1->rect.left;
          *result = 112;
          result[1] = 64;
          result[2] = 128;
          result[3] = 80;
        }
      }
      else
      {
        v1 = (char *)&unk_43BBF0 + 16 * a1->count2;
        v2 = (char *)&a1->rect;
        *(_DWORD *)v2 = *(_DWORD *)v1;
        *((_DWORD *)v2 + 1) = *((_DWORD *)v1 + 1);
        result = (LONG *)*((_DWORD *)v1 + 2);
        *((_DWORD *)v2 + 2) = result;
        *((_DWORD *)v2 + 3) = *((_DWORD *)v1 + 3);
      }
      return result;
    case 0x1E:
      goto LABEL_38;
    default:
      goto LABEL_40;
  }
}


NPCHAR *ActNpc102_B5Bullet(NPCHAR *a1)
{
  NPCHAR *result; 
  int v2; 

  v2 = a1->state;
  if ( v2 )
  {
    if ( v2 != 10 )
      goto LABEL_6;
  }
  else
  {
    a1->xm = 2 * GetCos(a1->type2);
    a1->ym = 2 * GetSin(a1->type2);
    CreateEntity(103, a1->x + 4096, a1->y, (int)a1);
    CreateEntity(103, a1->x - 4096, a1->y, (int)a1);
    a1->state = 10;
  }
  a1->x += a1->xm;
  a1->y += a1->ym;
LABEL_6:
  result = a1;
  if ( a1->x < -65536 || a1->x > 188416 || a1->y < -65536 || (result = a1, a1->y > 229376) )
    a1->cond = 0;
  return result;
}


LONG *ActNpc103(NPCHAR *a1)
{
  LONG *result; 
  int v2; 
  int v3; 

  v3 = a1->type2;
  v2 = a1->state;
  if ( v2 )
  {
    if ( v2 != 10 )
      goto LABEL_11;
  }
  else
  {
    a1->state = 10;
    a1->rot1 = 0;
    a1->count4 = *(_DWORD *)(v3 + 96);
    if ( a1->x >= *(_DWORD *)(v3 + 4) )
      a1->child = 128;
    else
      a1->child = 0;
    a1->flag |= 1u;
  }
  a1->child += 12;
  a1->child %= 256;
  if ( a1->rot1 < 6144 )
    a1->rot1 += 341;
  a1->x = *(_DWORD *)(v3 + 4) + a1->rot1 * GetCos(a1->child) / 1024;
  a1->y = *(_DWORD *)(v3 + 8) + a1->rot1 * GetSin(a1->child) / 1024;
LABEL_11:
  if ( !(*(_DWORD *)v3 & 1) || *(_DWORD *)(v3 + 96) != a1->count4 )
    a1->cond = 0;
  result = &a1->rect.left;
  *result = 120;
  result[1] = 72;
  result[2] = 136;
  result[3] = 88;
  return result;
}


signed int ActNpc104_B5Laser(NPCHAR *a1)
{
  char *v1; 
  signed int result; 
  int v3; 

  v3 = a1->state;
  if ( v3 )
  {
    if ( v3 != 10 )
      goto LABEL_6;
  }
  else
  {
    a1->xm = 4 * GetCos(a1->type2);
    a1->ym = 4 * GetSin(a1->type2);
    a1->state = 10;
  }
  CreateEntity(105, a1->x, a1->y, 0);
  a1->x += a1->xm;
  a1->y += a1->ym;
LABEL_6:
  if ( a1->x < -65536 || a1->x > 188416 || a1->y < -65536 || a1->y > 229376 )
    a1->cond = 0;
  v1 = (char *)&a1->rect;
  *(_DWORD *)v1 = 168;
  *((_DWORD *)v1 + 1) = 56;
  result = 176;
  *((_DWORD *)v1 + 2) = 176;
  *((_DWORD *)v1 + 3) = 64;
  return result;
}


int ActNpc105_B5LaserTrail(int a1)
{
  char *v1; 
  int result; 
  int v3; 

  v3 = *(_DWORD *)(a1 + 44);
  if ( v3 )
  {
    if ( v3 != 10 )
      goto LABEL_9;
  }
  else
  {
    *(_DWORD *)(a1 + 44) = 10;
  }
  if ( ++*(_DWORD *)(a1 + 56) > 4 )
  {
    ++*(_DWORD *)(a1 + 52);
    *(_DWORD *)(a1 + 56) = 0;
  }
  if ( *(_DWORD *)(a1 + 52) >= 3 )
    *(_DWORD *)a1 = 0;
LABEL_9:
  v1 = (char *)&unk_43BC90 + 16 * *(_DWORD *)(a1 + 52);
  result = a1 + 104;
  *(_DWORD *)result = *(_DWORD *)v1;
  *(_DWORD *)(result + 4) = *((_DWORD *)v1 + 1);
  *(_DWORD *)(result + 8) = *((_DWORD *)v1 + 2);
  *(_DWORD *)(result + 12) = *((_DWORD *)v1 + 3);
  return result;
}


NPCHAR *ActNpc106_AzaBonusSpawner_(NPCHAR *a1)
{
  NPCHAR *result; 
  int v2; 

  result = a1;
  v2 = a1->state;
  if ( !v2 )
  {
    a1->x = 0;
    result = a1;
    a1->y = 0;
    asteroidsKilled = 0;
    a1->state = 1;
    goto LABEL_6;
  }
  if ( v2 == 1 )
  {
LABEL_6:
    if ( asteroidsKilled < 20 )
      return result;
    a1->state = 10;
    a1->x = bonusAzaX;
    a1->y = bonusAzaY;
    a1->flag |= 2u;
    a1->ym = -2048;
    goto LABEL_8;
  }
  if ( v2 == 10 )
  {
LABEL_8:
    if ( a1->ym < 2048 )
      a1->ym += 64;
    a1->y += a1->ym;
  }
  if ( a1->y > 180224 )
    a1->cond = 0;
  result = (NPCHAR *)((char *)a1 + 0x68);
  result->cond = 16;
  result->x = 0;
  result->y = 32;
  result->xm = 16;
  return result;
}





NPCHAR *ActNpc107(NPCHAR *a1)
{
  NPCHAR *result; 

  result = a1;
  if ( a1->type2 )
    ShipFlags |= 0x100u;
  else
    ShipFlags &= 0xFFFFFEFF;
  return result;
}



void *ActNpc108_Boss6(NPCHAR *a1)
{
  char v1; 
  char v2; 
  int v3; 
  int v4; 
  int v5; 
  __int16 v6; 
  int v7; 
  void *result; 
  tagRECT *v9; 
  int v10; 
  HBITMAP hBitmap; 
  int nWidth; 

  switch ( a1->state )
  {
    case 0:
      a1->state = 10;
      a1->y = -32768;
      a1->ym = 512;
      a1->count3 = 96;
      CreateEntity(112, 0, -24576, (int)a1);
      CreateEntity(109, 0, -16384, (int)a1);
      CreateEntity(109, 0, -16384, (int)a1);
      CreateEntity(109, 0, -16384, (int)a1);
      CreateEntity(109, 0, -16384, (int)a1);
      CreateEntity(110, 0, -16384, (int)a1);
      CreateEntity(113, a1->x - 1024, -16384, (int)a1);
      CreateEntity(113, a1->x + 1024, -16384, (int)a1);
      goto LABEL_3;
    case 0xA:
LABEL_3:
      if ( a1->y > 139264 )
        a1->ym -= 8;
      if ( a1->ym < 0 )
      {
        a1->state = 20;
        a1->child = 0;
      }
      a1->y += a1->ym;
      a1->rot1 -= 4;
      if ( a1->rot1 < 0 )
        a1->rot1 += 256;
      goto LABEL_130;
    case 0x14:
      if ( a1->count3 < 108 )
        ++a1->count3;
      if ( a1->y <= 0x8000 )
      {
        a1->rot1 -= 4;
        if ( a1->rot1 < 0 )
          a1->rot1 += 256;
        a1->ym += 8;
      }
      else
      {
        a1->rot1 -= 8;
        if ( a1->rot1 < 0 )
          a1->rot1 += 256;
        a1->ym -= 8;
      }
      if ( a1->x <= 98304 )
      {
        if ( a1->x >= 24576 )
        {
          if ( a1->x <= (signed int)ShipX )
            a1->xm += 8;
          else
            a1->xm -= 8;
        }
        else
        {
          a1->xm += 8;
        }
      }
      else
      {
        a1->xm -= 8;
      }
      if ( a1->xm > 768 )
        a1->xm = 768;
      if ( a1->xm < -768 )
        a1->xm = -768;
      if ( a1->ym > 768 )
        a1->ym = 768;
      if ( a1->ym < -768 )
        a1->ym = -768;
      a1->y += a1->ym;
      a1->x += a1->xm;
      v10 = a1->child;
      if ( v10 )
      {
        if ( v10 == 1 )
        {
          if ( !++a1->count1 )
          {
            CreateCaret(1, a1->x - 14336, a1->y + 10240, (int)a1);
            PlaySound(30);
          }
          if ( a1->count1 == 10 )
          {
            CreateEntity(111, a1->x - 14336, a1->y + 10240, 0);
            PlaySound(9);
          }
          if ( a1->count1 == 15 )
          {
            CreateCaret(1, a1->x + 15360, a1->y + 10240, (int)a1);
            PlaySound(30);
          }
          if ( a1->count1 == 25 )
          {
            CreateEntity(111, a1->x + 15360, a1->y + 10240, 0);
            PlaySound(9);
          }
          if ( a1->count1 == 30 )
          {
            CreateCaret(1, a1->x - 5120, a1->y + 0x4000, (int)a1);
            PlaySound(30);
          }
          if ( a1->count1 == 40 )
          {
            CreateEntity(111, a1->x - 5120, a1->y + 0x4000, 0);
            PlaySound(9);
          }
          if ( a1->count1 > 80 )
          {
            a1->count1 = 0;
            a1->child = 0;
          }
        }
        else if ( v10 == 2 )
        {
          a1->state = 30;
          a1->child = 2;
          a1->count4 = 0;
          a1->count1 = 0;
        }
      }
      else
      {
        if ( ++a1->count1 < 80 && !(a1->count1 % 12) )
        {
          v1 = GetArktan(a1->x - (_DWORD)ShipX + 1024, a1->y - ShipY - 2048, 64);
          CreateEntity(63, a1->x, a1->y, (unsigned __int8)v1);
          CreateCaret(1, a1->x + 1024, a1->y - 2048, (int)a1);
          PlaySound(36);
        }
        if ( a1->count1 >= 96 )
          a1->count1 = 0;
        if ( (signed int)ShipX >= a1->x - 12288 && (signed int)ShipX <= a1->x + 12288 && ShipY > a1->y )
        {
          a1->count1 = -1;
          a1->child = 1;
        }
      }
      goto LABEL_130;
    case 0x1E:
      if ( a1->count3 < 128 )
        ++a1->count3;
      if ( a1->y <= 0x8000 )
      {
        a1->rot1 -= 4;
        if ( a1->rot1 < 0 )
          a1->rot1 += 256;
        a1->ym += 8;
      }
      else
      {
        a1->rot1 -= 8;
        if ( a1->rot1 < 0 )
          a1->rot1 += 256;
        a1->ym -= 8;
      }
      if ( a1->x <= 98304 )
      {
        if ( a1->x >= 24576 )
        {
          if ( a1->x <= (signed int)ShipX )
            a1->xm += 8;
          else
            a1->xm -= 8;
        }
        else
        {
          a1->xm += 8;
        }
      }
      else
      {
        a1->xm -= 8;
      }
      if ( a1->xm > 768 )
        a1->xm = 768;
      if ( a1->xm < -768 )
        a1->xm = -768;
      if ( a1->ym > 768 )
        a1->ym = 768;
      if ( a1->ym < -768 )
        a1->ym = -768;
      a1->y += a1->ym;
      a1->x += a1->xm;
      ++a1->count1;
      switch ( a1->child )
      {
        case 0:
        case 1:
          if ( a1->child )
            hBitmap = (HBITMAP)(a1->x - 12288);
          else
            hBitmap = (HBITMAP)(a1->x + 13312);
          nWidth = a1->y - 0x4000;
          if ( a1->count1 == 1 )
          {
            CreateCaret(1, (int)hBitmap, nWidth, (int)a1);
            PlaySound(30);
          }
          if ( a1->count1 > 24 && a1->count1 < 8 * a1->count4 + 64 && !(a1->count1 % 8) )
          {
            v2 = GetArktan((char *)hBitmap - (char *)ShipX, nWidth - ShipY, 64);
            CreateEntity(114, (int)hBitmap, nWidth, (unsigned __int8)v2);
            PlaySound(36);
          }
          if ( a1->count1 >= 8 * a1->count4 + 72 )
          {
            ++a1->child;
            a1->count1 = 0;
          }
          break;
        case 2:
          v3 = 70 - 20 * a1->count4;
          v4 = a1->count1++;
          if ( v4 > v3 && CountNpChar(98) < 2 * a1->count4 + 8 )
          {
            a1->child = 0;
            a1->count1 = 0;
          }
          break;
        case 3:
          a1->state = 40;
          a1->child = 0;
          a1->count4 = 0;
          a1->count1 = 0;
          a1->xm = a1->x;
          a1->ym = a1->y;
          PlayLoopSound(32);
          break;
        default:
          goto LABEL_130;
      }
      goto LABEL_130;
    case 0x28:
      if ( ++a1->count1 > 150 && a1->count3 > 80 )
        --a1->count3;
      a1->rot1 -= 4;
      if ( a1->rot1 < 0 )
        a1->rot1 += 256;
      if ( a1->xm < 61440 )
        a1->xm += 170;
      if ( a1->xm > 61440 )
        a1->xm -= 170;
      if ( a1->ym < 54272 )
        a1->ym += 170;
      if ( a1->ym > 54272 )
        a1->ym -= 170;
      a1->x = a1->xm + (((unsigned __int16)GetRandom(2) - 1) << 10);
      a1->y = a1->ym + (((unsigned __int16)GetRandom(2) - 1) << 10);
      if ( ++a1->count4 > 5 )
      {
        a1->count4 = (unsigned __int16)GetRandom(4);
        v5 = a1->y + (((unsigned __int16)GetRandom(48) - 32) << 10);
        v6 = GetRandom(48);
        CreateEntity(1, a1->x + (((unsigned __int16)v6 - 24) << 10), v5, 0);
      }
      if ( a1->count1 < 300 )
        goto LABEL_130;
      a1->state = 41;
      a1->count1 = 0;
      SetFadeWhiteActive(a1->x / 1024, a1->y / 1024);
      PlaySound(13);
      StopLoopSound(32);
      goto LABEL_125;
    case 0x29:
LABEL_125:
      if ( !CheckFadeWhiteEnd() )
        goto LABEL_130;
      a1->state = 100;
      a1->count1 = 0;
      if ( !(ShipCond & 2) )
      {
        AddScore(a1->score);
        CreateCaret(0, a1->x, a1->y - 4096, a1->score);
        SetShipInvincibility();
      }
      goto LABEL_128;
    case 0x64:
LABEL_128:
      v7 = a1->count1++;
      if ( v7 < 150 )
        goto LABEL_130;
      CheckStageClear(5);
      result = a1;
      a1->cond = 0;
      break;
    default:
LABEL_130:
      if ( a1->state >= 100 )
      {
        result = memset(&a1->rect, 0, 0x10u);
      }
      else
      {
        v9 = &a1->rect;
        v9->left = 0;
        v9->top = 104;
        result = (void *)48;
        v9->right = 48;
        v9->bottom = 152;
      }
      break;
  }
  return result;
}


LONG *ActNpc109(NPCHAR *nHeight)
{
  char v1; 
  LONG *result; 
  unsigned __int8 v3; 
  char *v4; 
  char *v5; 
  int v6; 

  v6 = nHeight->type2;
  if ( nHeight->state < 100 && nHeight->life < 930 )
  {
    CreateEntity(1, nHeight->x, nHeight->y, 0);
    v1 = GetArktan(nHeight->x - (_DWORD)ShipX, nHeight->y - ShipY, 64);
    CreateEntity(98, nHeight->x, nHeight->y, (unsigned __int8)v1);
    PlaySound(12);
    nHeight->state = 100;
    nHeight->count2 = 4;
    nHeight->shock = 0;
    nHeight->flag &= 0xFFFFFFFE;
    ++*(_DWORD *)(v6 + 92);
    AddScore(nHeight->score);
    CreateCaret(0, nHeight->x, nHeight->y, nHeight->score);
  }
  result = (LONG *)nHeight->state;
  switch ( result )
  {
    case 0u:
      nHeight->state = 10;
      nHeight->child = (*(_DWORD *)(v6 + 84))++;
      if ( *(_DWORD *)(v6 + 84) == 4 )
        *(_DWORD *)(v6 + 84) = 0;
      nHeight->flag |= 0xAu;
      goto LABEL_8;
    case 0xAu:
LABEL_8:
      if ( *(_DWORD *)(v6 + 44) < 30 )
        goto LABEL_14;
      nHeight->state = 20;
      nHeight->count2 = 2;
      nHeight->flag &= 0xFFFFFFF7;
      nHeight->flag |= 1u;
      CreateCaret(1, nHeight->x, nHeight->y, (int)nHeight);
      goto LABEL_10;
    case 0x14u:
LABEL_10:
      if ( *(_DWORD *)(v6 + 44) < 40 )
        goto LABEL_14;
      nHeight->state = 100;
      nHeight->count2 = 0;
      nHeight->shock = 0;
      nHeight->flag &= 0xFFFFFFFE;
      nHeight->flag |= 8u;
      result = (LONG *)CreateCaret(1, nHeight->x, nHeight->y, (int)nHeight);
      goto LABEL_12;
    case 0x64u:
LABEL_12:
      if ( *(_DWORD *)(v6 + 44) != 100 )
        goto LABEL_14;
      nHeight->cond = 0;
      break;
    default:
LABEL_14:
      v3 = (LOBYTE(nHeight->child) << 6) + *(_BYTE *)(v6 + 88);
      nHeight->x = *(_DWORD *)(v6 + 4) + *(_DWORD *)(v6 + 56) * GetCos(v3) / 4;
      nHeight->y = *(_DWORD *)(v6 + 8) + *(_DWORD *)(v6 + 56) * GetSin(v3) / 4;
      if ( nHeight->shock / 2 % 2 )
      {
        result = &nHeight->rect.left;
        *result = 96;
        result[1] = 48;
        result[2] = 112;
        result[3] = 64;
      }
      else
      {
        v4 = (char *)&unk_43BCD0 + 16 * nHeight->count2;
        v5 = (char *)&nHeight->rect;
        *(_DWORD *)v5 = *(_DWORD *)v4;
        *((_DWORD *)v5 + 1) = *((_DWORD *)v4 + 1);
        result = (LONG *)*((_DWORD *)v4 + 2);
        *((_DWORD *)v5 + 2) = result;
        *((_DWORD *)v5 + 3) = *((_DWORD *)v4 + 3);
      }
      break;
  }
  return result;
}


_DWORD *ActNpc110(NPCHAR *nHeight)
{
  int v1; 
  _DWORD *result; 
  char *v3; 
  char *v4; 
  char *v5; 
  int v6; 

  v6 = nHeight->type2;
  if ( nHeight->state < 100 && nHeight->life < 920 )
    nHeight->state = 30;
  switch ( nHeight->state )
  {
    case 0:
      nHeight->flag |= 0xAu;
      nHeight->state = 10;
      nHeight->child = (*(_DWORD *)(v6 + 84))++;
      if ( *(_DWORD *)(v6 + 84) == 4 )
        *(_DWORD *)(v6 + 84) = 0;
      goto LABEL_7;
    case 0xA:
LABEL_7:
      if ( *(_DWORD *)(v6 + 44) >= 20 )
      {
        nHeight->flag &= 0xFFFFFFF7;
        nHeight->flag |= 1u;
        PlaySound(38);
        CreateCaret(1, nHeight->x, nHeight->y, (int)nHeight);
        nHeight->count2 = 1;
        nHeight->state = 20;
      }
      goto LABEL_14;
    case 0x1E:
      CreateEntity(1, nHeight->x, nHeight->y, 0);
      PlaySound(11);
      nHeight->state = 100;
      nHeight->flag &= 0xFFFFFFFE;
      *(_DWORD *)(v6 + 84) = 2;
      goto LABEL_10;
    case 0x64:
LABEL_10:
      v1 = nHeight->count1++ % 6;
      if ( !v1 )
        CreateEntity(29, nHeight->x, nHeight->y, 0);
      if ( *(_DWORD *)(v6 + 44) != 100 )
        goto LABEL_14;
      result = nHeight;
      nHeight->cond = 0;
      break;
    default:
LABEL_14:
      nHeight->x = *(_DWORD *)(v6 + 4) + 6144;
      nHeight->y = *(_DWORD *)(v6 + 8) + 0x4000;
      if ( nHeight->state == 100 )
      {
        v3 = (char *)&nHeight->rect;
        *(_DWORD *)v3 = 176;
        *((_DWORD *)v3 + 1) = 64;
        result = (_DWORD *)192;
        *((_DWORD *)v3 + 2) = 192;
        *((_DWORD *)v3 + 3) = 80;
      }
      else if ( nHeight->shock / 2 % 2 )
      {
        result = &nHeight->rect.left;
        *result = 160;
        result[1] = 64;
        result[2] = 176;
        result[3] = 80;
      }
      else
      {
        v4 = (char *)&unk_43BD20 + 16 * nHeight->count2;
        v5 = (char *)&nHeight->rect;
        *(_DWORD *)v5 = *(_DWORD *)v4;
        *((_DWORD *)v5 + 1) = *((_DWORD *)v4 + 1);
        result = (_DWORD *)*((_DWORD *)v4 + 2);
        *((_DWORD *)v5 + 2) = result;
        *((_DWORD *)v5 + 3) = *((_DWORD *)v4 + 3);
      }
      break;
  }
  return result;
}


int ActNpc111_B6Laser(int a1)
{
  char *v1; 
  int v2; 
  int result; 

  if ( !*(_DWORD *)(a1 + 44) )
  {
    *(_DWORD *)(a1 + 44) = 1;
    *(_DWORD *)(a1 + 52) = -1;
  }
  if ( *(_DWORD *)(a1 + 52) < 4 )
    ++*(_DWORD *)(a1 + 52);
  *(_DWORD *)(a1 + 8) += 4096;
  if ( *(_DWORD *)(a1 + 8) > 188416 )
    *(_DWORD *)a1 = 0;
  v1 = (char *)&unk_43BD60 + 16 * *(_DWORD *)(a1 + 52);
  v2 = a1 + 104;
  *(_DWORD *)v2 = *(_DWORD *)v1;
  *(_DWORD *)(v2 + 4) = *((_DWORD *)v1 + 1);
  result = *((_DWORD *)v1 + 2);
  *(_DWORD *)(v2 + 8) = result;
  *(_DWORD *)(v2 + 12) = *((_DWORD *)v1 + 3);
  return result;
}


int ActNpc112(NPCHAR *a1)
{
  int result; 
  char *v2; 
  char *v3; 
  int v4; 

  v4 = a1->type2;
  switch ( a1->state )
  {
    case 0:
      a1->state = 10;
      a1->flag |= 0xAu;
      goto LABEL_3;
    case 0xA:
LABEL_3:
      if ( *(_DWORD *)(v4 + 44) < 30 )
        goto LABEL_11;
      a1->state = 20;
      goto LABEL_5;
    case 0x14:
LABEL_5:
      if ( ++a1->count1 < 100 )
        goto LABEL_11;
      a1->state = 30;
      a1->count2 = 1;
      a1->flag &= 0xFFFFFFF7;
      a1->flag |= 1u;
      PlaySound(12);
      CreateEntity(1, a1->x, a1->y, 0);
      goto LABEL_7;
    case 0x1E:
LABEL_7:
      a1->count2 = (1000 - a1->life) / 100 + 1;
      if ( a1->count2 < 4 )
        goto LABEL_11;
      a1->state = 40;
      a1->flag &= 0xFFFFFFFE;
      *(_DWORD *)(v4 + 84) = 3;
      goto LABEL_9;
    case 0x28:
LABEL_9:
      result = v4;
      if ( *(_DWORD *)(v4 + 44) != 100 )
        goto LABEL_11;
      a1->cond = 0;
      break;
    default:
LABEL_11:
      a1->x = *(_DWORD *)(v4 + 4);
      a1->y = *(_DWORD *)(v4 + 8);
      v2 = (char *)&unk_43BDB0 + 16 * a1->count2;
      v3 = (char *)&a1->rect;
      *(_DWORD *)v3 = *(_DWORD *)v2;
      *((_DWORD *)v3 + 1) = *((_DWORD *)v2 + 1);
      *((_DWORD *)v3 + 2) = *((_DWORD *)v2 + 2);
      *((_DWORD *)v3 + 3) = *((_DWORD *)v2 + 3);
      result = a1->shock / 2 % 2;
      if ( result )
      {
        a1->rect.top += 32;
        result = a1->rect.bottom + 32;
        a1->rect.bottom = result;
      }
      break;
  }
  return result;
}


int ActNpc113(int a1)
{
  int result; 
  signed int v2; 
  char *v3; 
  int v4; 
  int v5; 

  v5 = *(_DWORD *)(a1 + 80);
  result = *(_DWORD *)(a1 + 44);
  v4 = *(_DWORD *)(a1 + 44);
  if ( v4 )
  {
    if ( v4 != 10 )
    {
      if ( v4 != 20 )
        goto LABEL_13;
      goto LABEL_11;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 44) = 10;
    *(_DWORD *)(a1 + 52) = 0;
    *(_DWORD *)(a1 + 84) = *(_DWORD *)(a1 + 4) >= *(_DWORD *)(v5 + 4);
  }
  if ( *(_DWORD *)(v5 + 44) < 30 )
    goto LABEL_13;
  v2 = (*(_DWORD *)(a1 + 48))++;
  if ( v2 < 16 )
    goto LABEL_13;
  CreateCaret(1, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), a1);
  *(_DWORD *)(a1 + 44) = 20;
  result = a1;
  *(_DWORD *)(a1 + 52) = 1;
LABEL_11:
  if ( *(_DWORD *)(v5 + 44) == 100 )
  {
    *(_DWORD *)a1 = 0;
    return result;
  }
LABEL_13:
  if ( *(_DWORD *)(a1 + 84) )
    *(_DWORD *)(a1 + 4) = *(_DWORD *)(v5 + 4) + 13312;
  else
    *(_DWORD *)(a1 + 4) = *(_DWORD *)(v5 + 4) - 12288;
  *(_DWORD *)(a1 + 8) = *(_DWORD *)(v5 + 8) - 0x4000;
  v3 = (char *)&unk_43BE00 + 16 * *(_DWORD *)(a1 + 52);
  result = a1 + 104;
  *(_DWORD *)result = *(_DWORD *)v3;
  *(_DWORD *)(result + 4) = *((_DWORD *)v3 + 1);
  *(_DWORD *)(result + 8) = *((_DWORD *)v3 + 2);
  *(_DWORD *)(result + 12) = *((_DWORD *)v3 + 3);
  return result;
}


signed int ActNpc114_B6Ball(int a1)
{
  char v1; 
  signed int result; 
  int v3; 
  int v4; 
  char *v5; 
  int v6; 

  if ( *(_DWORD *)(a1 + 60) >= 1000 )
  {
    v6 = *(_DWORD *)(a1 + 44);
    if ( v6 )
    {
      if ( v6 == 20 )
      {
        *(_DWORD *)(a1 + 12) += GetCos(*(_BYTE *)(a1 + 84)) / 16;
        *(_DWORD *)(a1 + 16) += GetSin(*(_BYTE *)(a1 + 84)) / 16;
        *(_DWORD *)(a1 + 4) += *(_DWORD *)(a1 + 12);
        *(_DWORD *)(a1 + 8) += *(_DWORD *)(a1 + 16);
        v3 = (*(_DWORD *)(a1 + 56))++;
        if ( v3 > 0 )
        {
          *(_DWORD *)(a1 + 56) = 0;
          ++*(_DWORD *)(a1 + 52);
        }
        if ( *(_DWORD *)(a1 + 52) > 3 )
          *(_DWORD *)(a1 + 52) = 0;
        if ( *(_DWORD *)(a1 + 4) < -102400
          || *(_DWORD *)(a1 + 4) > 225280
          || *(_DWORD *)(a1 + 8) < -102400
          || *(_DWORD *)(a1 + 8) > 266240 )
        {
          *(_DWORD *)a1 = 0;
        }
      }
    }
    else
    {
      *(_DWORD *)(a1 + 44) = 20;
      *(_DWORD *)(a1 + 68) |= 1u;
      *(_DWORD *)(a1 + 84) = (unsigned __int8)GetArktan(
                                                *(_DWORD *)(a1 + 4) - (_DWORD)ShipX,
                                                *(_DWORD *)(a1 + 8) - ShipY,
                                                64);
    }
    v4 = (*(_DWORD *)(a1 + 56))++;
    if ( v4 > 0 )
    {
      *(_DWORD *)(a1 + 56) = 0;
      ++*(_DWORD *)(a1 + 52);
    }
    if ( *(_DWORD *)(a1 + 52) > 1 )
      *(_DWORD *)(a1 + 52) = 0;
    v5 = (char *)&unk_43BE20 + 16 * *(_DWORD *)(a1 + 52);
    result = a1 + 104;
    *(_DWORD *)result = *(_DWORD *)v5;
    *(_DWORD *)(result + 4) = *((_DWORD *)v5 + 1);
    *(_DWORD *)(result + 8) = *((_DWORD *)v5 + 2);
    *(_DWORD *)(result + 12) = *((_DWORD *)v5 + 3);
  }
  else
  {
    v1 = GetArktan(*(_DWORD *)(a1 + 4) - (_DWORD)ShipX, *(_DWORD *)(a1 + 8) - ShipY, 64);
    CreateEntity(98, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), (unsigned __int8)v1);
    PlaySound(15);
    result = CreateCaret(1, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8), 0);
    *(_DWORD *)a1 = 0;
  }
  return result;
}


int ActNpc115_B6Caret(int a1)
{
  int result; 
  char *v2; 

  if ( ++*(_DWORD *)(a1 + 56) > 2 )
  {
    *(_DWORD *)(a1 + 56) = 0;
    ++*(_DWORD *)(a1 + 52);
  }
  if ( *(_DWORD *)(a1 + 52) <= 3 )
  {
    v2 = (char *)&unk_43BE40 + 16 * *(_DWORD *)(a1 + 52);
    result = a1 + 104;
    *(_DWORD *)result = *(_DWORD *)v2;
    *(_DWORD *)(result + 4) = *((_DWORD *)v2 + 1);
    *(_DWORD *)(result + 8) = *((_DWORD *)v2 + 2);
    *(_DWORD *)(result + 12) = *((_DWORD *)v2 + 3);
  }
  else
  {
    result = a1;
    *(_DWORD *)a1 = 0;
  }
  return result;
}


_DWORD *ActNpc116_CreditText(_DWORD *a1)
{
  _DWORD *result; 

  ShowNextEndingText();
  SetGameDelay(50);
  result = a1;
  *a1 = 0;
  return result;
}


int ActNpc117_CreditReplace(NPCHAR *a1)
{
  int v1; 
  int result; 

  v1 = a1->count1;
  result = a1->count1 + 1;
  a1->count1 = result;
  if ( v1 > 1 )
  {
    result = ClearReplaceNpChar(a1->type2, 1);
    a1->cond = 0;
  }
  return result;
}


BOOL ActNpc118_CreditLoadImg(NPCHAR *a1)
{
  BOOL result; 

  result = LoadPximgEnemy(a1->type2);
  a1->cond = 0;
  return result;
}


NPCHAR *ActNpc119_CPhoto(NPCHAR *a1)
{
  NPCHAR *result; 
  int v2; 
  char *v3; 
  char *v4; 
  int v5; 

  v5 = a1->state;
  if ( v5 )
  {
    if ( v5 == 30 )
    {
      if ( a1->type2 % 2 )
        a1->x -= 1024;
      else
        a1->x += 1024;
      v2 = a1->count1++;
      if ( v2 == 50 )
        ShowNextEndingText();
    }
  }
  else
  {
    if ( !GetInScoreAttack() && a1->type2 == 5 )
    {
      result = a1;
      a1->cond = 0;
      return result;
    }
    a1->state = 30;
    if ( a1->type2 % 2 )
      a1->x = 172032;
    else
      a1->x = -49152;
    a1->y = 0x10000;
  }
  v3 = (char *)&CreditPhotoRects + 16 * a1->type2;
  v4 = (char *)&a1->rect;
  *(_DWORD *)v4 = *(_DWORD *)v3;
  *((_DWORD *)v4 + 1) = *((_DWORD *)v3 + 1);
  result = (NPCHAR *)*((_DWORD *)v3 + 2);
  *((_DWORD *)v4 + 2) = result;
  *((_DWORD *)v4 + 3) = *((_DWORD *)v3 + 3);
  return result;
}


LONG *ActNpc120_CreditGimmick(NPCHAR *a1)
{
  char *v1; 
  LONG *result; 
  int v3; 

  v3 = a1->state;
  if ( v3 )
  {
    if ( v3 != 10 )
      goto LABEL_9;
  }
  else
  {
    a1->x += 4096;
    a1->state = 10;
  }
  a1->y += 1536;
  if ( a1->y > 81920 )
    a1->count2 = 1;
  if ( a1->y > 180224 )
    a1->cond = 0;
LABEL_9:
  v1 = (char *)&unk_43BEE0 + 16 * a1->count2;
  result = &a1->rect.left;
  *result = *(_DWORD *)v1;
  result[1] = *((_DWORD *)v1 + 1);
  result[2] = *((_DWORD *)v1 + 2);
  result[3] = *((_DWORD *)v1 + 3);
  return result;
}


RECT *ActNpc121_BonusHidden(NPCHAR *o)
{
  _OWORD *v1; 
  RECT *rect; 
  int v3; 
  int x; 
  int y; 

  x = o->x;
  y = o->y;
  SubStageXOScroll(&x, &y);
  v3 = o->state;
  if ( v3 )
  {
    if ( v3 != 10 )
      goto LABEL_15;
  }
  else
  {
    o->state = 10;
  }
  if ( o->type2 == 3 && ++o->count1 > 150 )
    o->flag |= 1u;
  if ( o->type2 == 4 && y > ShipY - 24576 )
  {
    o->flag |= 1u;
    o->count2 = 4;
  }
  if ( o->type2 == 5 )
    o->flag |= 1u;
  if ( o->life <= 960 )
  {
    CreateEntity(1, x, y, 0);
    o->state = 20;
    o->count2 = o->type2 - 2;
    o->flag |= 2u;
    o->flag &= 0xFFFFFFFE;
  }
LABEL_15:
  v1 = &dword_43BF00[o->count2];
  rect = &o->rect;
  rect->left = *(_DWORD *)v1;
  rect->top = *((_DWORD *)v1 + 1);
  rect->right = *((_DWORD *)v1 + 2);
  rect->bottom = *((_DWORD *)v1 + 3);
  return rect;
}

