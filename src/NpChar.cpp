

_BYTE EntityAttrTbl[1464] ={  16,  3,  1,  1,  8,  8,  7,  7,  6,  0,  5,  0,  0,  8,  0,  0,  16,  16,  0,  0,  0,  0,  7,  0,  0,  3,  0,  0,  24,  16,  0,  0,  0,  0,  6,  0,  0,  2,  0,  0,  8,  4,  0,  0,  0,  0,  6,  0,  0,  5,  0,  0,  4,  4,  0,  0,  0,  0,  7,  0,  0,  6,  2,  0,  12,  12,  8,  8,  232,  3,  5,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  2,  8,  4,  0,  8,  8,  8,  8,  0,  0,  5,  0,  67,  5,  1,  1,  8,  8,  5,  5,  3,  0,  5,  0,  67,  5,  1,  1,  8,  8,  6,  6,  8,  0,  5,  0,  0,  9,  0,  0,  8,  8,  0,  0,  0,  0,  5,  0,  67,  4,  3,  1,  20,  8,  5,  4,  24,  0,  6,  1,  10,  4,  0,  1,  0,  0,  6,  2,  0,  0,  6,  0,  34,  8,  0,  1,  8,  8,  1,  1,  1,  0,  7,  6,  34,  8,  0,  1,  8,  8,  1,  1,  1,  0,  7,  6,  0,  4,  7,  1,  68,  16,  7,  6,  232,  3,  6,  2,  0,  4,  3,  1,  8,  8,  4,  3,  100,  0,  6,  0,  0,  4,  0,  1,  12,  20,  12,  16,  100,  0,  6,  3,  2,  8,  0,  1,  8,  8,  2,  4,  0,  0,  5,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  67,  4,  0,  1,  16,  16,  10,  10,  100,  0,  5,  3,  67,  4,  0,  1,  8,  8,  5,  5,  6,  0,  5,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  67,  5,  0,  1,  8,  8,  5,  5,  6,  0,  5,  3,  0,  6,  1,  1,  12,  12,  8,  8,  6,  0,  5,  0,  0,  6,  1,  0,  12,  12,  8,  8,  6,  0,  5,  0,  67,  5,  2,  1,  12,  12,  8,  8,  100,  0,  6,  0,  67,  4,  0,  1,  16,  16,  10,  10,  100,  0,  5,  3,  67,  4,  0,  1,  8,  8,  5,  5,  100,  0,  5,  3,  0,  8,  0,  0,  4,  4,  0,  0,  0,  0,  7,  0,  67,  4,  4,  1,  16,  16,  12,  12,  36,  0,  6,  2,  67,  6,  2,  1,  12,  12,  10,  8,  10,  0,  5,  1,  0,  4,  7,  1,  28,  24,  0,  0,  232,  3,  6,  2,  10,  4,  0,  1,  20,  52,  9,  36,  0,  0,  6,  0,  10,  4,  0,  1,  20,  24,  12,  15,  232,  3,  6,  3,  67,  6,  0,  1,  8,  8,  4,  4,  1,  0,  6,  3,  0,  4,  0,  1,  8,  8,  7,  7,  232,  3,  6,  2,  0,  0,  0,  0,  8,  8,  0,  0,  0,  0,  7,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  16,  4,  4,  1,  16,  16,  12,  12,  100,  0,  6,  2,  16,  3,  2,  1,  8,  8,  7,  7,  10,  0,  5,  3,  16,  3,  2,  1,  8,  8,  7,  7,  6,  0,  5,  3,  16,  4,  3,  1,  16,  8,  8,  6,  24,  0,  6,  1,  67,  5,  1,  1,  8,  8,  5,  5,  2,  0,  5,  0,  16,  5,  2,  1,  8,  8,  6,  6,  2,  0,  6,  0,  2,  8,  4,  0,  8,  8,  6,  6,  0,  0,  14,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  0,  4,  0,  0,  48,  40,  0,  0,  0,  0,  6,  0,  16,  3,  3,  1,  8,  8,  6,  6,  6,  0,  6,  3,  16,  3,  7,  1,  32,  28,  16,  16,  0,  0,  6,  3,  0,  9,  0,  0,  8,  8,  0,  0,  0,  0,  15,  0,  16,  4,  0,  1,  8,  8,  6,  6,  232,  3,  6,  2,  16,  4,  0,  1,  8,  8,  6,  6,  232,  3,  6,  2,  16,  4,  0,  1,  8,  8,  6,  6,  232,  3,  6,  2,  16,  5,  0,  0,  0,  0,  6,  16,  0,  0,  6,  2,  16,  3,  3,  1,  8,  8,  7,  7,  232,  3,  6,  3,  0,  9,  0,  0,  0,  0,  0,  0,  0,  0,  8,  0,  16,  4,  0,  0,  8,  8,  0,  0,  0,  0,  6,  3,  16,  3,  0,  0,  8,  8,  6,  6,  4,  0,  6,  0,  0,  6,  1,  0,  12,  12,  8,  8,  3,  0,  5,  0,  16,  3,  0,  1,  8,  8,  7,  7,  232,  3,  5,  3,  16,  3,  0,  1,  8,  8,  8,  8,  1,  0,  5,  3,  16,  4,  0,  0,  8,  8,  0,  0,  0,  0,  15,  0,  0,  8,  0,  1,  8,  8,  3,  3,  1,  0,  5,  3,  0,  6,  0,  0,  12,  12,  8,  8,  232,  3,  5,  0,  16,  3,  2,  1,  8,  12,  6,  10,  3,  0,  6,  0,  67,  5,  3,  1,  16,  12,  10,  8,  10,  0,  6,  1,  16,  3,  2,  1,  16,  8,  15,  6,  14,  0,  6,  1,  16,  3,  4,  1,  8,  8,  7,  7,  40,  0,  5,  3,  16,  3,  1,  1,  8,  12,  7,  7,  100,  0,  6,  3,  67,  5,  4,  1,  12,  12,  9,  9,  96,  0,  6,  3,  0,  4,  0,  1,  4,  4,  4,  4,  0,  0,  6,  1,  67,  6,  1,  1,  8,  8,  5,  5,  5,  0,  5,  0,  0,  4,  0,  1,  4,  4,  4,  4,  0,  0,  6,  1,  16,  3,  0,  1,  8,  8,  7,  7,  232,  3,  5,  3,  67,  4,  0,  1,  16,  16,  10,  10,  100,  0,  5,  3,  0,  7,  0,  1,  24,  24,  16,  16,  232,  3,  6,  2,  0,  8,  0,  1,  8,  8,  4,  4,  232,  3,  6,  2,  0,  4,  0,  1,  4,  4,  3,  3,  232,  3,  6,  3,  0,  6,  0,  1,  8,  8,  3,  3,  232,  3,  6,  3,  0,  5,  0,  1,  4,  4,  3,  3,  232,  3,  6,  3,  16,  5,  1,  1,  8,  8,  6,  6,  2,  0,  6,  0,  0,  8,  0,  1,  8,  8,  4,  4,  232,  3,  6,  2,  0,  8,  0,  1,  8,  8,  5,  5,  1,  0,  5,  3,  0,  6,  1,  1,  8,  8,  5,  5,  232,  3,  6,  0,  0,  3,  0,  0,  24,  16,  0,  0,  0,  0,  6,  0,  0,  2,  0,  0,  8,  4,  0,  0,  0,  0,  6,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  67,  4,  3,  1,  16,  16,  5,  4,  24,  0,  6,  2,  10,  4,  0,  1,  0,  0,  5,  7,  0,  0,  6,  0,  67,  5,  0,  1,  4,  12,  2,  5,  1,  0,  6,  3,  0,  2,  0,  0,  8,  8,  0,  0,  0,  0,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  0,  4,  2,  1,  8,  12,  7,  7,  232,  3,  6,  0,  0,  3,  0,  1,  8,  12,  5,  5,  232,  3,  6,  0,  0,  2,  0,  1,  8,  12,  5,  5,  232,  3,  6,  0,  16,  3,  0,  1,  8,  8,  8,  8,  14,  0,  6,  3,  34,  8,  0,  1,  8,  8,  1,  1,  1,  0,  7,  6,  16,  3,  4,  1,  8,  8,  7,  7,  40,  0,  5,  3,  16,  4,  7,  1,  16,  12,  7,  7,  232,  3,  6,  5,  16,  4,  0,  1,  8,  8,  7,  7,  232,  3,  6,  2,  0,  0,  0,  0,  8,  8,  0,  0,  1,  0,  7,  0,  34,  8,  0,  1,  8,  8,  3,  3,  8,  0,  7,  4,  34,  8,  0,  1,  4,  4,  2,  2,  232,  3,  7,  0,  34,  8,  0,  1,  4,  4,  2,  2,  232,  3,  7,  4,  0,  3,  5,  0,  8,  8,  6,  6,  0,  0,  14,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  0,  5,  7,  1,  24,  24,  16,  16,  232,  3,  6,  2,  0,  4,  4,  1,  8,  8,  4,  4,  232,  3,  6,  1,  0,  6,  0,  1,  8,  8,  5,  5,  232,  3,  6,  2,  2,  7,  0,  1,  4,  20,  0,  4,  0,  0,  5,  0,  0,  6,  0,  1,  12,  16,  8,  8,  232,  3,  6,  7,  0,  6,  0,  1,  8,  8,  0,  0,  232,  3,  6,  2,  34,  7,  0,  1,  8,  8,  4,  4,  232,  3,  7,  0,  0,  8,  0,  0,  8,  8,  0,  0,  0,  0,  7,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  5,  0,  0,  3,  0,  0,  48,  36,  0,  0,  0,  0,  6,  0,  0,  6,  0,  0,  8,  8,  0,  0,  0,  0,  4,  0,  16,  3,  5,  1,  8,  8,  6,  6,  232,  3,  14,  3}; 
int (*npcFuncTbl[122])(int) =
{
  &ActNpc000,
  &ActNpc001_Explode,
  &ActNpc002_CloudL,
  &ActNpc003_CloudS,
  &ActNpc004_Puff,
  &ActNpc005_Hanger,
  &ActNpc006_CloudGen,
  &ActNpc007_Powerup,
  &ActNpc008_Climber,
  &ActNpc009_Kagome,
  &ActNpc010_Unused_,
  &ActNpc011_Wing,
  &ActNpc012_WingCorpse,
  &ActNpc013_Bullet,
  &ActNpc014_BulletSlow,
  &ActNpc015_Boss1,
  &ActNpc016_Boss1Eye,
  &ActNpc017_Boss1BigEye,
  &ActNpc018_BulletLong,
  &ActNpc019_BGM,
  &ActNpc020_Asteroid_L,
  &ActNpc021_Asteroid_S,
  &ActNpc022_ScrollSpdSet,
  &ActNpc023_Asteroid_SGravity,
  &ActNpc024_Hanger_Wave,
  &ActNpc025_Hanger_Shoot,
  &ActNpc026_RockHugger,
  &ActNpc027_RHAsteroidL,
  &ActNpc028_RHAsteroidS,
  &ActNpc029_Bullet2_,
  &ActNpc030_Elka,
  &ActNpc031_Sodi,
  &ActNpc032_Boss2,
  &ActNpc033_Boss2RocketSpawner,
  &ActNpc034_B2ExplosionSpawner_,
  &ActNpc035_B2Rocket,
  &ActNpc036_Boss2Eye,
  &ActNpc037_Stars_,
  &ActNpc038_StarGen,
  &ActNpc039_Elka2,
  &ActNpc040_GuxtFort,
  &ActNpc041_CatEye,
  &ActNpc042_Slider,
  &ActNpc043_Cycloid,
  &ActNpc044_Chester,
  &ActNpc045_Bonus,
  &ActNpc046_BonusGen,
  &ActNpc047_CloudXL,
  &ActNpc048_Gimmick,
  &ActNpc049_Boss3,
  &ActNpc050_62_PowerupHelper,
  &ActNpc051_B3Eye1_,
  &ActNpc052_B3Eye2_,
  &ActNpc053_B3Eye3_,
  &ActNpc054_B3BulletBlocker_,
  &ActNpc055_B3Target__,
  &ActNpc056_Checkpoint,
  &ActNpc057_Boss3TurretSpawner,
  &ActNpc058_B3Turret,
  &ActNpc059_PowerupSpinnerShield,
  &ActNpc060_PowerupBox,
  &ActNpc061_PowerupStatic,
  &ActNpc050_62_PowerupHelper,
  &ActNpc063_BulletWhite,
  &ActNpc064_PowerupSpinner,
  &ActNpc065_ClimberShoot,
  &ActNpc066_Tri,
  &ActNpc067_GuxtTank,
  &ActNpc068_MedusaEye,
  &ActNpc069_GuxtMine,
  &ActNpc070_BlendyGen,
  &ActNpc071_Blendy,
  &ActNpc072_Cycloid2,
  &ActNpc073_Cycloid2Gen,
  &ActNpc074_PowerupHidden,
  &ActNpc075_PowerupAsteroid,
  &ActNpc076_Boss4,
  &ActNpc077,
  &ActNpc078,
  &ActNpc079,
  &ActNpc080,
  &ActNpc081_SpaceAmeba,
  &ActNpc082,
  &ActNpc083_B4Bullet,
  &ActNpc084_Square,
  &ActNpc085_CloudDarkL,
  &ActNpc086_CloudDarkS,
  &ActNpc087_CloudDarkGen,
  &ActNpc088_MissilePot,
  &ActNpc089,
  &ActNpc090_Missile,
  &ActNpc091,
  &ActNpc092_BGRock,
  &ActNpc093_ClearRockCloudGen,
  &ActNpc094_SandStamper,
  &ActNpc095,
  &ActNpc096_Stamp,
  &ActNpc097_Brick,
  &ActNpc098_BulletSquare,
  &ActNpc099_BulletSquareGen,
  &ActNpc100_Boss5,
  &ActNpc101,
  &ActNpc102_B5Bullet,
  &ActNpc103,
  &ActNpc104_B5Laser,
  &ActNpc105_B5LaserTrail,
  &ActNpc106_AzaBonusSpawner_,
  &ActNpc107,
  &ActNpc108_Boss6,
  &ActNpc109,
  &ActNpc110,
  &ActNpc111_B6Laser,
  &ActNpc112,
  &ActNpc113,
  &ActNpc114_B6Ball,
  &ActNpc115_B6Caret,
  &ActNpc116_CreditText,
  &ActNpc117_CreditReplace,
  &ActNpc118_CreditLoadImg,
  &ActNpc119_CPhoto,
  &ActNpc120_CreditGimmick,
  &ActNpc121_BonusHidden
}; 

int *GetNpcTable()
{
  return EntityTbl;
}



void *ResetEntities()
{
  EntityCreateCount = 0;
  return memset(EntityTbl, 0, 30720u);
}




void *LoadPximgEntities()
{
  LoadPximg((int)"enemy_generic", 5);
  LoadPximg((int)"power", 15);
  LoadPximg((int)"caret", 7);
  LoadPximg((int)"popup", 8);
  LoadPximg((int)"bonus", 14);
  return ResetEntities();
}


int ActNpc()
{
  int result; 
  signed int i; 
  NPCHAR *v2; 

  v2 = (NPCHAR *)EntityTbl;
  for ( i = 0; i < 256; ++i )
  {
    if ( v2->cond & 2 )
    {
      v2->cond = 0;
    }
    else if ( v2->cond & 1 )
    {
      if ( v2->shock )
        --v2->shock;
      npcFuncTbl[v2->type]((int)v2);
    }
    ++v2;
    result = i + 1;
  }
  return result;
}




int HitEntityMap()
{
  int result; 
  signed int i; 
  NPCHAR *v2; 

  v2 = (NPCHAR *)EntityTbl;
  for ( i = 0; i < 256; ++i )
  {
    if ( v2->cond & 1 )
      HitMapGeneric(v2, (int (*)(int, int, int, int))MapCollideEntityProc, 0);
    ++v2;
    result = i + 1;
  }
  return result;
}



NPCHAR *MapCollideEntityProc(NPCHAR *a1, int a2, int a3, int a4)
{
  NPCHAR *result; 

  result = a1;
  if ( a1->flag & 0x20 )
  {
    a1->cond = 0;
    result = (NPCHAR *)CreateCaret(2, a1->x, a1->y, 0);
  }
  if ( a1->flag & 0x40 )
  {
    a1->x = a2;
    a1->y = a3;
    result = a1;
    a1->cond |= a4;
  }
  return result;
}


int PutNpChar2(int a1)
{
  int result; 
  signed int i; 
  int v3; 
  int v4; 

  v4 = GetStageXOffset() / 1024;
  result = GetStageScroll() / 1024;
  v3 = result;
  for ( i = 50; i < 256; ++i )
  {
    PutObject(a1, (NPCHAR *)&EntityTbl[30 * i], v4, v3);
    result = i + 1;
  }
  return result;
}



int PutNpChar(int a1)
{
  int result; 
  signed int i; 
  int v3; 
  int v4; 

  v4 = GetStageXOffset() / 1024;
  result = GetStageScroll() / 1024;
  v3 = result;
  for ( i = 0; i < 50; ++i )
  {
    PutObject(a1, (NPCHAR *)&EntityTbl[30 * i], v4, v3);
    result = i + 1;
  }
  return result;
}



int *CreateEntity(int type, int x, int y, int type2)
{
  int *result; 
  int i; 
  NpcAttr *eAttr; 
  NPCHAR *ePtr; 

  eAttr = (NpcAttr *)&EntityAttrTbl[12 * type];
  for ( i = (EntityAttrTbl[12 * type + 1] << 8) / 10; i < 256 && EntityTbl[30 * i] & 1; ++i )
    ;
  if ( i == 256 )
  {
    result = 0;
  }
  else
  {
    ePtr = (NPCHAR *)&EntityTbl[30 * i];
    memset(&EntityTbl[30 * i], 0, 0x78u);
    ePtr->cond = 1;
    ePtr->flag = eAttr->flag;
    ePtr->xoff = eAttr->xoff << 10;
    ePtr->yoff = eAttr->yoff << 10;
    ePtr->w = eAttr->w << 10;
    ePtr->h = eAttr->h << 10;
    ePtr->life = eAttr->life;
    ePtr->score = eAttr->score;
    ePtr->damage = eAttr->damage;
    ePtr->surf = eAttr->surf;
    ePtr->destroyHitVoice = eAttr->byteB;
    ePtr->type = type;
    ePtr->type2 = type2;
    if ( ePtr->flag & 0x10 )
      AddStageXOScroll(&x, &y);
    ePtr->x = x;
    ePtr->y = y;
    ePtr->num = EntityCreateCount++;
    result = &EntityTbl[30 * i];
  }
  return result;
}




NPCHAR *DamageNpChar(NPCHAR *o, int dmg)
{
  NPCHAR *result; 
  int y; 
  HBITMAP x; 

  result = o;
  if ( !(o->cond & 2) )
  {
    x = (HBITMAP)o->x;
    y = o->y;
    if ( o->flag & 0x10 )
      SubStageXOScroll(&x, &y);
    o->life -= dmg;
    if ( o->shock < 8 )
      o->shock += 8;
    if ( o->life > 0 )
    {
      result = o;
      switch ( o->destroyHitVoice )
      {
        case 0:
          result = (NPCHAR *)PlaySound(17);
          break;
        case 1:
          result = (NPCHAR *)PlaySound(18);
          break;
        case 2:
          result = (NPCHAR *)PlaySound(19);
          break;
        case 3:
          result = (NPCHAR *)PlaySound(20);
          break;
        case 4:
          result = (NPCHAR *)PlaySound(21);
          break;
        case 5:
          result = (NPCHAR *)PlaySound(22);
          break;
        case 7:
          result = (NPCHAR *)PlaySound(23);
          break;
        default:
          return result;
      }
    }
    else
    {
      switch ( o->destroyHitVoice )
      {
        case 0:
          PlaySound(11);
          break;
        case 1:
          PlaySound(12);
          break;
        case 2:
          PlaySound(13);
          break;
        case 3:
          PlaySound(14);
          break;
        case 4:
          PlaySound(15);
          break;
        case 5:
          PlaySound(13);
          break;
        case 6:
          PlaySound(16);
          break;
        default:
          break;
      }
      AddScore(o->score);
      if ( o->destroyHitVoice == 6 )
        CreateEntity(115, (int)x, y, 0);
      else
        CreateEntity(1, (int)x, y, 0);
      if ( o->score )
        CreateCaret(0, (int)x, y, o->score);
      result = o;
      o->cond |= 2u;
    }
  }
  return result;
}


int UnusedGetNpcTblNext()
{
  signed int i; 
  int v2; 

  v2 = 0;
  for ( i = 0; i < 256; ++i )
  {
    if ( EntityTbl[30 * i] & 1 )
      ++v2;
  }
  return v2;
}



int CountNpChar(int a1)
{
  signed int i; 
  int v3; 

  v3 = 0;
  for ( i = 0; i < 256; ++i )
  {
    if ( EntityTbl[30 * i] & 1 )
    {
      if ( EntityTblType[30 * i] == a1 )
        ++v3;
    }
  }
  return v3;
}




int ClearReplaceNpChar(int a1, int a2)
{
  int result; 
  signed int i; 
  int v4; 
  int v5; 

  for ( i = 0; i < 256; ++i )
  {
    if ( EntityTbl[30 * i] & 1 )
    {
      if ( EntityTblType[30 * i] == a1 )
      {
        EntityTbl[30 * i] = 0;
        if ( a2 )
        {
          v4 = EntityTblX[30 * i];
          v5 = EntityTblY[30 * i];
          if ( EntityTblFlag[30 * i] & 0x10 )
            SubStageXOScroll(&v4, &v5);
          CreateEntity(1, v4, v5, 0);
        }
      }
    }
    result = i + 1;
  }
  return result;
}




